(function(o,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(o=typeof globalThis<"u"?globalThis:o||self,n(o.ambisonics={}))})(this,function(exports){"use strict";function getAmbisonicChannelCount(o){return(o+1)*(o+1)}function getAmbisonicChannelCount2D(o){return 2*o+1}function degreesToRadians(o){return o*Math.PI/180}function radiansToDegrees(o){return o*180/Math.PI}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var numeric1_2_6={};(function(exports$1){var numeric=exports$1;typeof commonjsGlobal<"u"&&(commonjsGlobal.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(n,e){var r,i,a,t;for(typeof e>"u"&&(e=15),a=.5,r=new Date;;){for(a*=2,t=a;t>3;t-=4)n(),n(),n(),n();for(;t>0;)n(),t--;if(i=new Date,i-r>e)break}for(t=a;t>3;t-=4)n(),n(),n(),n();for(;t>0;)n(),t--;return i=new Date,1e3*(3*a-1)/(i-r)},numeric._myIndexOf=function(n){var e=this.length,r;for(r=0;r<e;++r)if(this[r]===n)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(n){function e(a){if(a===0)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+e(-a);if(isFinite(a)){var t=Math.floor(Math.log(a)/Math.log(10)),s=a/Math.pow(10,t),f=s.toPrecision(numeric.precision);return parseFloat(f)===10&&(t++,s=1,f=s.toPrecision(numeric.precision)),parseFloat(f).toString()+"e"+t.toString()}return"Infinity"}var r=[];function i(a){var t;if(typeof a>"u")return r.push(Array(numeric.precision+8).join(" ")),!1;if(typeof a=="string")return r.push('"'+a+'"'),!1;if(typeof a=="boolean")return r.push(a.toString()),!1;if(typeof a=="number"){var s=e(a),f=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),l=[s,f,h,parseFloat(f).toString(),parseFloat(h).toString()];for(t=1;t<l.length;t++)l[t].length<s.length&&(s=l[t]);return r.push(Array(numeric.precision+8-s.length).join(" ")+s),!1}if(a===null)return r.push("null"),!1;if(typeof a=="function"){r.push(a.toString());var v=!1;for(t in a)a.hasOwnProperty(t)&&(v?r.push(`,
`):r.push(`
{`),v=!0,r.push(t),r.push(`: 
`),i(a[t]));return v&&r.push(`}
`),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return r.push("...Large Array..."),!0;var v=!1;for(r.push("["),t=0;t<a.length;t++)t>0&&(r.push(","),v&&r.push(`
 `)),v=i(a[t]);return r.push("]"),!0}r.push("{");var v=!1;for(t in a)a.hasOwnProperty(t)&&(v&&r.push(`,
`),v=!0,r.push(t),r.push(`: 
`),i(a[t]));return r.push("}"),!0}return i(n),r.join("")},numeric.parseDate=function(n){function e(r){if(typeof r=="string")return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var i=[],a;for(a=0;a<r.length;a++)i[a]=e(r[a]);return i}return e(n)},numeric.parseFloat=function(n){function e(r){if(typeof r=="string")return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var i=[],a;for(a=0;a<r.length;a++)i[a]=e(r[a]);return i}return e(n)},numeric.parseCSV=function(n){var e=n.split(`
`),r,i,a=[],t=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,f=function(M){return M.substr(0,M.length-1)},h=0;for(i=0;i<e.length;i++){var l=(e[i]+",").match(t),v;if(l.length>0){for(a[h]=[],r=0;r<l.length;r++)v=f(l[r]),s.test(v)?a[h][r]=parseFloat(v):a[h][r]=v;h++}}return a},numeric.toCSV=function(n){var e=numeric.dim(n),r,i,a,t,s;for(a=e[0],e[1],s=[],r=0;r<a;r++){for(t=[],i=0;i<a;i++)t[i]=n[r][i].toString();s[r]=t.join(", ")}return s.join(`
`)+`
`},numeric.getURL=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(),e},numeric.imageURL=function(n){function e(E){var O=E.length,p,g,F,R,j,u,x,N,L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G="";for(p=0;p<O;p+=3)g=E[p],F=E[p+1],R=E[p+2],j=g>>2,u=((g&3)<<4)+(F>>4),x=((F&15)<<2)+(R>>6),N=R&63,p+1>=O?x=N=64:p+2>=O&&(N=64),G+=L.charAt(j)+L.charAt(u)+L.charAt(x)+L.charAt(N);return G}function r(E,O,p){typeof O>"u"&&(O=0),typeof p>"u"&&(p=E.length);var g=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],F=-1,R=0;E.length;var j;for(j=O;j<p;j++)R=(F^E[j])&255,F=F>>>8^g[R];return F^-1}var i=n[0].length,a=n[0][0].length,t,s,f,h,l,v,M,m,d,y,b=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,a>>24&255,a>>16&255,a>>8&255,a&255,i>>24&255,i>>16&255,i>>8&255,i&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(y=r(b,12,29),b[29]=y>>24&255,b[30]=y>>16&255,b[31]=y>>8&255,b[32]=y&255,t=1,s=0,M=0;M<i;M++){for(M<i-1?b.push(0):b.push(1),l=3*a+1+(M===0)&255,v=3*a+1+(M===0)>>8&255,b.push(l),b.push(v),b.push(~l&255),b.push(~v&255),M===0&&b.push(0),m=0;m<a;m++)for(f=0;f<3;f++)l=n[f][M][m],l>255?l=255:l<0?l=0:l=Math.round(l),t=(t+l)%65521,s=(s+t)%65521,b.push(l);b.push(0)}return d=(s<<16)+t,b.push(d>>24&255),b.push(d>>16&255),b.push(d>>8&255),b.push(d&255),h=b.length-41,b[33]=h>>24&255,b[34]=h>>16&255,b[35]=h>>8&255,b[36]=h&255,y=r(b,37),b.push(y>>24&255),b.push(y>>16&255),b.push(y>>8&255),b.push(y&255),b.push(0),b.push(0),b.push(0),b.push(0),b.push(73),b.push(69),b.push(78),b.push(68),b.push(174),b.push(66),b.push(96),b.push(130),"data:image/png;base64,"+e(b)},numeric._dim=function(n){for(var e=[];typeof n=="object";)e.push(n.length),n=n[0];return e},numeric.dim=function(n){var e,r;return typeof n=="object"?(e=n[0],typeof e=="object"?(r=e[0],typeof r=="object"?numeric._dim(n):[n.length,e.length]):[n.length]):[]},numeric.mapreduce=function(n,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+`;
if(typeof x === "number") { var xi = x; `+n+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+n+`;
    xi = x[i-1];
    `+n+`;
}
if(i === 0) {
    xi = x[i];
    `+n+`
}
return accum;`)},numeric.mapreduce2=function(n,e){return Function("x",`var n = x.length;
var i,xi;
`+e+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+n+`;
}
return accum;`)},numeric.same=function o(n,e){var r,i;if(!(n instanceof Array)||!(e instanceof Array)||(i=n.length,i!==e.length))return!1;for(r=0;r<i;r++)if(n[r]!==e[r])if(typeof n[r]=="object"){if(!o(n[r],e[r]))return!1}else return!1;return!0},numeric.rep=function(n,e,r){typeof r>"u"&&(r=0);var i=n[r],a=Array(i),t;if(r===n.length-1){for(t=i-2;t>=0;t-=2)a[t+1]=e,a[t]=e;return t===-1&&(a[0]=e),a}for(t=i-1;t>=0;t--)a[t]=numeric.rep(n,e,r+1);return a},numeric.dotMMsmall=function(n,e){var r,i,a,t,s,f,h,l,v,M,m;for(t=n.length,s=e.length,f=e[0].length,h=Array(t),r=t-1;r>=0;r--){for(l=Array(f),v=n[r],a=f-1;a>=0;a--){for(M=v[s-1]*e[s-1][a],i=s-2;i>=1;i-=2)m=i-1,M+=v[i]*e[i][a]+v[m]*e[m][a];i===0&&(M+=v[0]*e[0][a]),l[a]=M}h[r]=l}return h},numeric._getCol=function(n,e,r){var i=n.length,a;for(a=i-1;a>0;--a)r[a]=n[a][e],--a,r[a]=n[a][e];a===0&&(r[0]=n[0][e])},numeric.dotMMbig=function(n,e){var r=numeric._getCol,i=e.length,a=Array(i),t=n.length,s=e[0].length,f=new Array(t),h,l=numeric.dotVV,v,M;for(--i,--t,v=t;v!==-1;--v)f[v]=Array(s);for(--s,v=s;v!==-1;--v)for(r(e,v,a),M=t;M!==-1;--M)h=n[M],f[M][v]=l(h,a);return f},numeric.dotMV=function(n,e){var r=n.length;e.length;var i,a=Array(r),t=numeric.dotVV;for(i=r-1;i>=0;i--)a[i]=t(n[i],e);return a},numeric.dotVM=function(n,e){var r,i,a,t,s,f,h;for(a=n.length,t=e[0].length,s=Array(t),i=t-1;i>=0;i--){for(f=n[a-1]*e[a-1][i],r=a-2;r>=1;r-=2)h=r-1,f+=n[r]*e[r][i]+n[h]*e[h][i];r===0&&(f+=n[0]*e[0][i]),s[i]=f}return s},numeric.dotVV=function(n,e){var r,i=n.length,a,t=n[i-1]*e[i-1];for(r=i-2;r>=1;r-=2)a=r-1,t+=n[r]*e[r]+n[a]*e[a];return r===0&&(t+=n[0]*e[0]),t},numeric.dot=function(n,e){var r=numeric.dim;switch(r(n).length*1e3+r(e).length){case 2002:return e.length<10?numeric.dotMMsmall(n,e):numeric.dotMMbig(n,e);case 2001:return numeric.dotMV(n,e);case 1002:return numeric.dotVM(n,e);case 1001:return numeric.dotVV(n,e);case 1e3:return numeric.mulVS(n,e);case 1:return numeric.mulSV(n,e);case 0:return n*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(n){var e,r,i,a=n.length,t=Array(a),s;for(e=a-1;e>=0;e--){for(s=Array(a),r=e+2,i=a-1;i>=r;i-=2)s[i]=0,s[i-1]=0;for(i>e&&(s[i]=0),s[e]=n[e],i=e-1;i>=1;i-=2)s[i]=0,s[i-1]=0;i===0&&(s[0]=0),t[e]=s}return t},numeric.getDiag=function(o){var n=Math.min(o.length,o[0].length),e,r=Array(n);for(e=n-1;e>=1;--e)r[e]=o[e][e],--e,r[e]=o[e][e];return e===0&&(r[0]=o[0][0]),r},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(n,e,r){typeof r>"u"&&(r="");var i=[],a,t=/\[i\]$/,s,f="",h=!1;for(a=0;a<n.length;a++)t.test(n[a])?(s=n[a].substring(0,n[a].length-3),f=s):s=n[a],s==="ret"&&(h=!0),i.push(s);return i[n.length]="_s",i[n.length+1]="_k",i[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+f+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(h?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+n.join(",")+`,_s,_k+1);
    return ret;
}
`+r+`
for(i=_n-1;i!==-1;--i) {
    `+e+`
}
return ret;`,Function.apply(null,i)},numeric.pointwise2=function(n,e,r){typeof r>"u"&&(r="");var i=[],a,t=/\[i\]$/,s,f="",h=!1;for(a=0;a<n.length;a++)t.test(n[a])?(s=n[a].substring(0,n[a].length-3),f=s):s=n[a],s==="ret"&&(h=!0),i.push(s);return i[n.length]="var _n = "+f+`.length;
var i`+(h?"":", ret = Array(_n)")+`;
`+r+`
for(i=_n-1;i!==-1;--i) {
`+e+`
}
return ret;`,Function.apply(null,i)},numeric._biforeach=function o(n,e,r,i,a){if(i===r.length-1){a(n,e);return}var t,s=r[i];for(t=s-1;t>=0;t--)o(typeof n=="object"?n[t]:n,typeof e=="object"?e[t]:e,r,i+1,a)},numeric._biforeach2=function o(n,e,r,i,a){if(i===r.length-1)return a(n,e);var t,s=r[i],f=Array(s);for(t=s-1;t>=0;--t)f[t]=o(typeof n=="object"?n[t]:n,typeof e=="object"?e[t]:e,r,i+1,a);return f},numeric._foreach=function o(n,e,r,i){if(r===e.length-1){i(n);return}var a,t=e[r];for(a=t-1;a>=0;a--)o(n[a],e,r+1,i)},numeric._foreach2=function o(n,e,r,i){if(r===e.length-1)return i(n);var a,t=e[r],s=Array(t);for(a=t-1;a>=0;a--)s[a]=o(n[a],e,r+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var o,n;for(o=0;o<numeric.mathfuns2.length;++o)n=numeric.mathfuns2[o],numeric.ops2[n]=n;for(o in numeric.ops2)if(numeric.ops2.hasOwnProperty(o)){n=numeric.ops2[o];var e,r,i="";numeric.myIndexOf.call(numeric.mathfuns2,o)!==-1?(i="var "+n+" = Math."+n+`;
`,e=function(a,t,s){return a+" = "+n+"("+t+","+s+")"},r=function(a,t){return a+" = "+n+"("+a+","+t+")"}):(e=function(a,t,s){return a+" = "+t+" "+n+" "+s},numeric.opseq.hasOwnProperty(o+"eq")?r=function(a,t){return a+" "+n+"= "+t}:r=function(a,t){return a+" = "+a+" "+n+" "+t}),numeric[o+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),i),numeric[o+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),i),numeric[o+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),i),numeric[o]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+o+"VV, VS = numeric."+o+"VS, SV = numeric."+o+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+r("x","y")+`
}
return x;
`),numeric[n]=numeric[o],numeric[o+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[o+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[o+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+o+"eqV, S = numeric."+o+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(o=0;o<numeric.mathfuns2.length;++o)n=numeric.mathfuns2[o],delete numeric.ops2[n];for(o=0;o<numeric.mathfuns.length;++o)n=numeric.mathfuns[o],numeric.ops1[n]=n;for(o in numeric.ops1)numeric.ops1.hasOwnProperty(o)&&(i="",n=numeric.ops1[o],numeric.myIndexOf.call(numeric.mathfuns,o)!==-1&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+`;
`),numeric[o+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[o+"eq"]=Function("x",'if(typeof x !== "object") return '+n+`x
var i;
var V = numeric.`+o+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[o+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[o]=Function("x",'if(typeof x !== "object") return '+n+`(x)
var i;
var V = numeric.`+o+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(o=0;o<numeric.mathfuns.length;++o)n=numeric.mathfuns[o],delete numeric.ops1[n];for(o in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(o)&&(n=numeric.mapreducers[o],numeric[o+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[o]=Function("x","s","k",n[1]+`if(typeof x !== "object") {    xi = x;
`+n[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+o+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+n[0]+`;
}
return accum;
`))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(n,e){return typeof n=="object"?typeof e=="object"?numeric.truncVV(n,e):numeric.truncVS(n,e):typeof e=="object"?numeric.truncSV(n,e):Math.round(n/e)*e},numeric.inv=function(y){var e=numeric.dim(y),r=Math.abs,i=e[0],a=e[1],t=numeric.clone(y),s,f,h=numeric.identity(i),l,v,M,m,d,y;for(m=0;m<a;++m){var b=-1,E=-1;for(M=m;M!==i;++M)d=r(t[M][m]),d>E&&(b=M,E=d);for(f=t[b],t[b]=t[m],t[m]=f,v=h[b],h[b]=h[m],h[m]=v,y=f[m],d=m;d!==a;++d)f[d]/=y;for(d=a-1;d!==-1;--d)v[d]/=y;for(M=i-1;M!==-1;--M)if(M!==m){for(s=t[M],l=h[M],y=s[m],d=m+1;d!==a;++d)s[d]-=f[d]*y;for(d=a-1;d>0;--d)l[d]-=v[d]*y,--d,l[d]-=v[d]*y;d===0&&(l[0]-=v[0]*y)}}return h},numeric.det=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var r=e[0],i=1,a,t,s,f=numeric.clone(n),h,l,v,M,m;for(t=0;t<r-1;t++){for(s=t,a=t+1;a<r;a++)Math.abs(f[a][t])>Math.abs(f[s][t])&&(s=a);for(s!==t&&(M=f[s],f[s]=f[t],f[t]=M,i*=-1),h=f[t],a=t+1;a<r;a++){for(l=f[a],v=l[t]/h[t],s=t+1;s<r-1;s+=2)m=s+1,l[s]-=h[s]*v,l[m]-=h[m]*v;s!==r&&(l[s]-=h[s]*v)}if(h[t]===0)return 0;i*=h[t]}return i*f[t][t]},numeric.transpose=function(n){var e,r,i=n.length,a=n[0].length,t=Array(a),s,f,h;for(r=0;r<a;r++)t[r]=Array(i);for(e=i-1;e>=1;e-=2){for(f=n[e],s=n[e-1],r=a-1;r>=1;--r)h=t[r],h[e]=f[r],h[e-1]=s[r],--r,h=t[r],h[e]=f[r],h[e-1]=s[r];r===0&&(h=t[0],h[e]=f[0],h[e-1]=s[0])}if(e===0){for(s=n[0],r=a-1;r>=1;--r)t[r][0]=s[r],--r,t[r][0]=s[r];r===0&&(t[0][0]=s[0])}return t},numeric.negtranspose=function(n){var e,r,i=n.length,a=n[0].length,t=Array(a),s,f,h;for(r=0;r<a;r++)t[r]=Array(i);for(e=i-1;e>=1;e-=2){for(f=n[e],s=n[e-1],r=a-1;r>=1;--r)h=t[r],h[e]=-f[r],h[e-1]=-s[r],--r,h=t[r],h[e]=-f[r],h[e-1]=-s[r];r===0&&(h=t[0],h[e]=-f[0],h[e-1]=-s[0])}if(e===0){for(s=n[0],r=a-1;r>=1;--r)t[r][0]=-s[r],--r,t[r][0]=-s[r];r===0&&(t[0][0]=-s[0])}return t},numeric._random=function o(n,e){var r,i=n[e],a=Array(i),t;if(e===n.length-1){for(t=Math.random,r=i-1;r>=1;r-=2)a[r]=t(),a[r-1]=t();return r===0&&(a[0]=t()),a}for(r=i-1;r>=0;r--)a[r]=o(n,e+1);return a},numeric.random=function(n){return numeric._random(n,0)},numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.linspace=function(n,e,r){if(typeof r>"u"&&(r=Math.max(Math.round(e-n)+1,1)),r<2)return r===1?[n]:[];var i,a=Array(r);for(r--,i=r;i>=0;i--)a[i]=(i*e+(r-i)*n)/r;return a},numeric.getBlock=function(n,e,r){var i=numeric.dim(n);function a(t,s){var f,h=e[s],l=r[s]-h,v=Array(l);if(s===i.length-1){for(f=l;f>=0;f--)v[f]=t[f+h];return v}for(f=l;f>=0;f--)v[f]=a(t[f+h],s+1);return v}return a(n,0)},numeric.setBlock=function(n,e,r,i){var a=numeric.dim(n);function t(s,f,h){var l,v=e[h],M=r[h]-v;if(h===a.length-1)for(l=M;l>=0;l--)s[l+v]=f[l];for(l=M;l>=0;l--)t(s[l+v],f[l],h+1)}return t(n,i,0),n},numeric.getRange=function(n,e,r){var i=e.length,a=r.length,t,s,f=Array(i),h,l;for(t=i-1;t!==-1;--t)for(f[t]=Array(a),h=f[t],l=n[e[t]],s=a-1;s!==-1;--s)h[s]=l[r[s]];return f},numeric.blockMatrix=function(n){var e=numeric.dim(n);if(e.length<4)return numeric.blockMatrix([n]);var r=e[0],i=e[1],a,t,s,f,h;for(a=0,t=0,s=0;s<r;++s)a+=n[s][0].length;for(f=0;f<i;++f)t+=n[0][f][0].length;var l=Array(a);for(s=0;s<a;++s)l[s]=Array(t);var v=0,M,m,d,y,b;for(s=0;s<r;++s){for(M=t,f=i-1;f!==-1;--f)for(h=n[s][f],M-=h[0].length,d=h.length-1;d!==-1;--d)for(b=h[d],m=l[v+d],y=b.length-1;y!==-1;--y)m[M+y]=b[y];v+=n[s][0].length}return l},numeric.tensor=function(n,e){if(typeof n=="number"||typeof e=="number")return numeric.mul(n,e);var r=numeric.dim(n),i=numeric.dim(e);if(r.length!==1||i.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var a=r[0],t=i[0],s=Array(a),f,h,l,v;for(h=a-1;h>=0;h--){for(f=Array(t),v=n[h],l=t-1;l>=3;--l)f[l]=v*e[l],--l,f[l]=v*e[l],--l,f[l]=v*e[l],--l,f[l]=v*e[l];for(;l>=0;)f[l]=v*e[l],--l;s[h]=f}return s},numeric.T=function(n,e){this.x=n,this.y=e},numeric.t=function(n,e){return new numeric.T(n,e)},numeric.Tbinop=function(n,e,r,i,a){if(numeric.indexOf,typeof a!="string"){var t;a="";for(t in numeric)numeric.hasOwnProperty(t)&&(n.indexOf(t)>=0||e.indexOf(t)>=0||r.indexOf(t)>=0||i.indexOf(t)>=0)&&t.length>1&&(a+="var "+t+" = numeric."+t+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+a+`
if(x.y) {  if(y.y) {    return new numeric.T(`+i+`);
  }
  return new numeric.T(`+r+`);
}
if(y.y) {
  return new numeric.T(`+e+`);
}
return new numeric.T(`+n+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var n=numeric.mul,e=numeric.div;if(this.y){var r=numeric.add(n(this.x,this.x),n(this.y,this.y));return new numeric.T(e(this.x,r),e(numeric.neg(this.y),r))}return new T(e(1,this.x))},numeric.T.prototype.div=function(n){if(n instanceof numeric.T||(n=new numeric.T(n)),n.y)return this.mul(n.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,n.x),e(this.y,n.x)):new numeric.T(e(this.x,n.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var n=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(n(e),n(r)):new numeric.T(n(e))},numeric.T.prototype.transjugate=function(){var n=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(n(e),numeric.negtranspose(r)):new numeric.T(n(e))},numeric.Tunop=function(n,e,r){return typeof r!="string"&&(r=""),Function(`var x = this;
`+r+`
if(x.y) {  `+e+`;
}
`+n+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var n=this;if(typeof n.y>"u")return new numeric.T(numeric.inv(n.x));var e=n.x.length,y,b,E,r=numeric.identity(e),i=numeric.rep([e,e],0),a=numeric.clone(n.x),t=numeric.clone(n.y),s,f,h,l,v,M,m,d,y,b,E,O,p,g,F,R,j,u;for(y=0;y<e;y++){for(g=a[y][y],F=t[y][y],O=g*g+F*F,E=y,b=y+1;b<e;b++)g=a[b][y],F=t[b][y],p=g*g+F*F,p>O&&(E=b,O=p);for(E!==y&&(u=a[y],a[y]=a[E],a[E]=u,u=t[y],t[y]=t[E],t[E]=u,u=r[y],r[y]=r[E],r[E]=u,u=i[y],i[y]=i[E],i[E]=u),s=a[y],f=t[y],v=r[y],M=i[y],g=s[y],F=f[y],b=y+1;b<e;b++)R=s[b],j=f[b],s[b]=(R*g+j*F)/O,f[b]=(j*g-R*F)/O;for(b=0;b<e;b++)R=v[b],j=M[b],v[b]=(R*g+j*F)/O,M[b]=(j*g-R*F)/O;for(b=y+1;b<e;b++){for(h=a[b],l=t[b],m=r[b],d=i[b],g=h[y],F=l[y],E=y+1;E<e;E++)R=s[E],j=f[E],h[E]-=R*g-j*F,l[E]-=j*g+R*F;for(E=0;E<e;E++)R=v[E],j=M[E],m[E]-=R*g-j*F,d[E]-=j*g+R*F}}for(y=e-1;y>0;y--)for(v=r[y],M=i[y],b=y-1;b>=0;b--)for(m=r[b],d=i[b],g=a[b][y],F=t[b][y],E=e-1;E>=0;E--)R=v[E],j=M[E],m[E]-=g*R-F*j,d[E]-=g*j+F*R;return new numeric.T(r,i)},numeric.T.prototype.get=function(n){var e=this.x,r=this.y,i=0,a,t=n.length;if(r){for(;i<t;)a=n[i],e=e[a],r=r[a],i++;return new numeric.T(e,r)}for(;i<t;)a=n[i],e=e[a],i++;return new numeric.T(e)},numeric.T.prototype.set=function(n,e){var r=this.x,i=this.y,a=0,t,s=n.length,f=e.x,h=e.y;if(s===0)return h?this.y=h:i&&(this.y=void 0),this.x=r,this;if(h){for(i||(i=numeric.rep(numeric.dim(r),0),this.y=i);a<s-1;)t=n[a],r=r[t],i=i[t],a++;return t=n[a],r[t]=f,i[t]=h,this}if(i){for(;a<s-1;)t=n[a],r=r[t],i=i[t],a++;return t=n[a],r[t]=f,f instanceof Array?i[t]=numeric.rep(numeric.dim(f),0):i[t]=0,this}for(;a<s-1;)t=n[a],r=r[t],a++;return t=n[a],r[t]=f,this},numeric.T.prototype.getRows=function(n,e){var r=e-n+1,i,a=Array(r),t,s=this.x,f=this.y;for(i=n;i<=e;i++)a[i-n]=s[i];if(f){for(t=Array(r),i=n;i<=e;i++)t[i-n]=f[i];return new numeric.T(a,t)}return new numeric.T(a)},numeric.T.prototype.setRows=function(n,e,r){var i,a=this.x,t=this.y,s=r.x,f=r.y;for(i=n;i<=e;i++)a[i]=s[i-n];if(f)for(t||(t=numeric.rep(numeric.dim(a),0),this.y=t),i=n;i<=e;i++)t[i]=f[i-n];else if(t)for(i=n;i<=e;i++)t[i]=numeric.rep([s[i-n].length],0);return this},numeric.T.prototype.getRow=function(n){var e=this.x,r=this.y;return r?new numeric.T(e[n],r[n]):new numeric.T(e[n])},numeric.T.prototype.setRow=function(n,e){var r=this.x,i=this.y,a=e.x,t=e.y;return r[n]=a,t?(i||(i=numeric.rep(numeric.dim(r),0),this.y=i),i[n]=t):i&&(i=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(n,e){var r=this.x,i=this.y,a=numeric.getBlock;return i?new numeric.T(a(r,n,e),a(i,n,e)):new numeric.T(a(r,n,e))},numeric.T.prototype.setBlock=function(n,e,r){r instanceof numeric.T||(r=new numeric.T(r));var i=this.x,a=this.y,t=numeric.setBlock,s=r.x,f=r.y;if(f)return a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),t(i,n,e,s),t(a,n,e,f),this;t(i,n,e,s),a&&t(a,n,e,numeric.rep(numeric.dim(s),0))},numeric.T.rep=function(n,e){var r=numeric.T;e instanceof r||(e=new r(e));var i=e.x,a=e.y,t=numeric.rep;return a?new r(t(n,i),t(n,a)):new r(t(n,i))},numeric.T.diag=function(n){n instanceof numeric.T||(n=new numeric.T(n));var e=n.x,r=n.y,i=numeric.diag;return r?new numeric.T(i(e),i(r)):new numeric.T(i(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,e=this.x,r=this.y;return r?new n.T(n.getDiag(e),n.getDiag(r)):new n.T(n.getDiag(e))},numeric.house=function(n){var e=numeric.clone(n),r=n[0]>=0?1:-1,i=r*numeric.norm2(n);e[0]+=i;var a=numeric.norm2(e);if(a===0)throw new Error("eig: internal error");return numeric.div(e,a)},numeric.toUpperHessenberg=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r=e[0],i,a,t,s,f,h=numeric.clone(n),l,v,M,m,d=numeric.identity(r),y;for(a=0;a<r-2;a++){for(s=Array(r-a-1),i=a+1;i<r;i++)s[i-a-1]=h[i][a];if(numeric.norm2(s)>0){for(f=numeric.house(s),l=numeric.getBlock(h,[a+1,a],[r-1,r-1]),v=numeric.tensor(f,numeric.dot(f,l)),i=a+1;i<r;i++)for(M=h[i],m=v[i-a-1],t=a;t<r;t++)M[t]-=2*m[t-a];for(l=numeric.getBlock(h,[0,a+1],[r-1,r-1]),v=numeric.tensor(numeric.dot(l,f),f),i=0;i<r;i++)for(M=h[i],m=v[i],t=a+1;t<r;t++)M[t]-=2*m[t-a-1];for(l=Array(r-a-1),i=a+1;i<r;i++)l[i-a-1]=d[i];for(v=numeric.tensor(f,numeric.dot(f,l)),i=a+1;i<r;i++)for(y=d[i],m=v[i-a-1],t=0;t<r;t++)y[t]-=2*m[t]}}return{H:h,Q:d}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(o,n){typeof n>"u"&&(n=1e4),o=numeric.clone(o),numeric.clone(o);var e=numeric.dim(o),r=e[0],i,a,t,s,f,h,l,v,M,m=numeric.identity(r),d,y,b,E,O,p,g,F,R;if(r<3)return{Q:m,B:[[0,r-1]]};var j=numeric.epsilon;for(R=0;R<n;R++){for(g=0;g<r-1;g++)if(Math.abs(o[g+1][g])<j*(Math.abs(o[g][g])+Math.abs(o[g+1][g+1]))){var u=numeric.QRFrancis(numeric.getBlock(o,[0,0],[g,g]),n),x=numeric.QRFrancis(numeric.getBlock(o,[g+1,g+1],[r-1,r-1]),n);for(b=Array(g+1),p=0;p<=g;p++)b[p]=m[p];for(E=numeric.dot(u.Q,b),p=0;p<=g;p++)m[p]=E[p];for(b=Array(r-g-1),p=g+1;p<r;p++)b[p-g-1]=m[p];for(E=numeric.dot(x.Q,b),p=g+1;p<r;p++)m[p]=E[p-g-1];return{Q:m,B:u.B.concat(numeric.add(x.B,g+1))}}if(t=o[r-2][r-2],s=o[r-2][r-1],f=o[r-1][r-2],h=o[r-1][r-1],v=t+h,l=t*h-s*f,M=numeric.getBlock(o,[0,0],[2,2]),v*v>=4*l){var N,L;N=.5*(v+Math.sqrt(v*v-4*l)),L=.5*(v-Math.sqrt(v*v-4*l)),M=numeric.add(numeric.sub(numeric.dot(M,M),numeric.mul(M,N+L)),numeric.diag(numeric.rep([3],N*L)))}else M=numeric.add(numeric.sub(numeric.dot(M,M),numeric.mul(M,v)),numeric.diag(numeric.rep([3],l)));for(i=[M[0][0],M[1][0],M[2][0]],a=numeric.house(i),b=[o[0],o[1],o[2]],E=numeric.tensor(a,numeric.dot(a,b)),p=0;p<3;p++)for(y=o[p],O=E[p],F=0;F<r;F++)y[F]-=2*O[F];for(b=numeric.getBlock(o,[0,0],[r-1,2]),E=numeric.tensor(numeric.dot(b,a),a),p=0;p<r;p++)for(y=o[p],O=E[p],F=0;F<3;F++)y[F]-=2*O[F];for(b=[m[0],m[1],m[2]],E=numeric.tensor(a,numeric.dot(a,b)),p=0;p<3;p++)for(d=m[p],O=E[p],F=0;F<r;F++)d[F]-=2*O[F];var G;for(g=0;g<r-2;g++){for(F=g;F<=g+1;F++)if(Math.abs(o[F+1][F])<j*(Math.abs(o[F][F])+Math.abs(o[F+1][F+1]))){var u=numeric.QRFrancis(numeric.getBlock(o,[0,0],[F,F]),n),x=numeric.QRFrancis(numeric.getBlock(o,[F+1,F+1],[r-1,r-1]),n);for(b=Array(F+1),p=0;p<=F;p++)b[p]=m[p];for(E=numeric.dot(u.Q,b),p=0;p<=F;p++)m[p]=E[p];for(b=Array(r-F-1),p=F+1;p<r;p++)b[p-F-1]=m[p];for(E=numeric.dot(x.Q,b),p=F+1;p<r;p++)m[p]=E[p-F-1];return{Q:m,B:u.B.concat(numeric.add(x.B,F+1))}}for(G=Math.min(r-1,g+3),i=Array(G-g),p=g+1;p<=G;p++)i[p-g-1]=o[p][g];for(a=numeric.house(i),b=numeric.getBlock(o,[g+1,g],[G,r-1]),E=numeric.tensor(a,numeric.dot(a,b)),p=g+1;p<=G;p++)for(y=o[p],O=E[p-g-1],F=g;F<r;F++)y[F]-=2*O[F-g];for(b=numeric.getBlock(o,[0,g+1],[r-1,G]),E=numeric.tensor(numeric.dot(b,a),a),p=0;p<r;p++)for(y=o[p],O=E[p],F=g+1;F<=G;F++)y[F]-=2*O[F-g-1];for(b=Array(G-g),p=g+1;p<=G;p++)b[p-g-1]=m[p];for(E=numeric.tensor(a,numeric.dot(a,b)),p=g+1;p<=G;p++)for(d=m[p],O=E[p-g-1],F=0;F<r;F++)d[F]-=2*O[F]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(n,e){var r=numeric.toUpperHessenberg(n),i=numeric.QRFrancis(r.H,e),a=numeric.T,$=n.length,t,s,f=i.B,h=numeric.dot(i.Q,numeric.dot(r.H,numeric.transpose(i.Q))),l=new a(numeric.dot(i.Q,r.Q)),v,M=f.length,m,d,y,b,E,O,p,g,F,R,j,u,x,N,L=Math.sqrt;for(s=0;s<M;s++)if(t=f[s][0],t!==f[s][1]){if(m=t+1,d=h[t][t],y=h[t][m],b=h[m][t],E=h[m][m],y===0&&b===0)continue;O=-d-E,p=d*E-y*b,g=O*O-4*p,g>=0?(O<0?F=-.5*(O-L(g)):F=-.5*(O+L(g)),x=(d-F)*(d-F)+y*y,N=b*b+(E-F)*(E-F),x>N?(x=L(x),j=(d-F)/x,u=y/x):(N=L(N),j=b/N,u=(E-F)/N),v=new a([[u,-j],[j,u]]),l.setRows(t,m,v.dot(l.getRows(t,m)))):(F=-.5*O,R=.5*L(-g),x=(d-F)*(d-F)+y*y,N=b*b+(E-F)*(E-F),x>N?(x=L(x+R*R),j=(d-F)/x,u=y/x,F=0,R/=x):(N=L(N+R*R),j=b/N,u=(E-F)/N,F=R/N,R=0),v=new a([[u,-j],[j,u]],[[F,R],[R,-F]]),l.setRows(t,m,v.dot(l.getRows(t,m))))}var G=l.dot(n).dot(l.transjugate()),$=n.length,ar=numeric.T.identity($);for(m=0;m<$;m++)if(m>0)for(s=m-1;s>=0;s--){var pr=G.get([s,s]),Mr=G.get([m,m]);if(numeric.neq(pr.x,Mr.x)||numeric.neq(pr.y,Mr.y))F=G.getRow(s).getBlock([s],[m-1]),R=ar.getRow(m).getBlock([s],[m-1]),ar.set([m,s],G.get([s,m]).neg().sub(F.dot(R)).div(pr.sub(Mr)));else{ar.setRow(m,ar.getRow(s));continue}}for(m=0;m<$;m++)F=ar.getRow(m),ar.setRow(m,F.div(F.norm2()));return ar=ar.transpose(),ar=l.transjugate().dot(ar),{lambda:G.getDiag(),E:ar}},numeric.ccsSparse=function(n){var e=n.length,s,r,i,a,t=[];for(i=e-1;i!==-1;--i){r=n[i];for(a in r){for(a=parseInt(a);a>=t.length;)t[t.length]=0;r[a]!==0&&t[a]++}}var s=t.length,f=Array(s+1);for(f[0]=0,i=0;i<s;++i)f[i+1]=f[i]+t[i];var h=Array(f[s]),l=Array(f[s]);for(i=e-1;i!==-1;--i){r=n[i];for(a in r)r[a]!==0&&(t[a]--,h[f[a]+t[a]]=i,l[f[a]+t[a]]=r[a])}return[f,h,l]},numeric.ccsFull=function(n){var e=n[0],r=n[1],i=n[2],a=numeric.ccsDim(n),t=a[0],s=a[1],f,h,l,v,M=numeric.rep([t,s],0);for(f=0;f<s;f++)for(l=e[f],v=e[f+1],h=l;h<v;++h)M[r[h]][f]=i[h];return M},numeric.ccsTSolve=function(n,e,r,i,a){var t=n[0],s=n[1],f=n[2],h=t.length-1,l=Math.max,v=0;typeof i>"u"&&(r=numeric.rep([h],0)),typeof i>"u"&&(i=numeric.linspace(0,r.length-1)),typeof a>"u"&&(a=[]);function M(g){var F;if(r[g]===0){for(r[g]=1,F=t[g];F<t[g+1];++F)M(s[F]);a[v]=g,++v}}var m,d,y,b,E,O,p;for(m=i.length-1;m!==-1;--m)M(i[m]);for(a.length=v,m=a.length-1;m!==-1;--m)r[a[m]]=0;for(m=i.length-1;m!==-1;--m)d=i[m],r[d]=e[d];for(m=a.length-1;m!==-1;--m){for(d=a[m],y=t[d],b=l(t[d+1],y),E=y;E!==b;++E)if(s[E]===d){r[d]/=f[E];break}for(p=r[d],E=y;E!==b;++E)O=s[E],O!==d&&(r[O]-=p*f[E])}return r},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(n,e,r,i,a,t){var s=0,f,h=a.length,l=this.k,v=this.k1,M=this.j,m,d;if(i[n]===0)for(i[n]=1,M[0]=n,l[0]=m=e[n],v[0]=d=e[n+1];;)if(m>=d){if(a[h]=M[s],s===0)return;++h,--s,m=l[s],d=v[s]}else f=t[r[m]],i[f]===0?(i[f]=1,l[s]=m,++s,M[s]=f,m=e[f],v[s]=d=e[f+1]):++m},numeric.ccsLPSolve=function(n,e,r,i,a,t,s){var f=n[0],h=n[1],l=n[2];f.length-1;var v=e[0],M=e[1],m=e[2],d,y,b,E,O,p,g,F,R;for(y=v[a],b=v[a+1],i.length=0,d=y;d<b;++d)s.dfs(t[M[d]],f,h,r,i,t);for(d=i.length-1;d!==-1;--d)r[i[d]]=0;for(d=y;d!==b;++d)E=t[M[d]],r[E]=m[d];for(d=i.length-1;d!==-1;--d){for(E=i[d],O=f[E],p=f[E+1],g=O;g<p;++g)if(t[h[g]]===E){r[E]/=l[g];break}for(R=r[E],g=O;g<p;++g)F=t[h[g]],F!==E&&(r[F]-=R*l[g])}return r},numeric.ccsLUP1=function(n,e){var r=n[0].length-1,i=[numeric.rep([r+1],0),[],[]],a=[numeric.rep([r+1],0),[],[]],t=i[0],s=i[1],f=i[2],h=a[0],l=a[1],v=a[2],M=numeric.rep([r],0),m=numeric.rep([r],0),d,y,b,E,O,p,g,F=numeric.ccsLPSolve,R=Math.abs,j=numeric.linspace(0,r-1),u=numeric.linspace(0,r-1),x=new numeric.ccsDFS(r);for(typeof e>"u"&&(e=1),d=0;d<r;++d){for(F(i,n,M,m,d,u,x),E=-1,O=-1,y=m.length-1;y!==-1;--y)b=m[y],!(b<=d)&&(p=R(M[b]),p>E&&(O=b,E=p));for(R(M[d])<e*E&&(y=j[d],E=j[O],j[d]=E,u[E]=d,j[O]=y,u[y]=O,E=M[d],M[d]=M[O],M[O]=E),E=t[d],O=h[d],g=M[d],s[E]=j[d],f[E]=1,++E,y=m.length-1;y!==-1;--y)b=m[y],p=M[b],m[y]=0,M[b]=0,b<=d?(l[O]=b,v[O]=p,++O):(s[E]=j[b],f[E]=p/g,++E);t[d+1]=E,h[d+1]=O}for(y=s.length-1;y!==-1;--y)s[y]=u[s[y]];return{L:i,U:a,P:j,Pinv:u}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(n,e,r,i,a,t,s){var f=0,h,l=a.length,v=this.k,M=this.k1,m=this.j,d,y;if(i[n]===0)for(i[n]=1,m[0]=n,v[0]=d=e[t[n]],M[0]=y=e[t[n]+1];;){if(isNaN(d))throw new Error("Ow!");if(d>=y){if(a[l]=t[m[f]],f===0)return;++l,--f,d=v[f],y=M[f]}else h=r[d],i[h]===0?(i[h]=1,v[f]=d,++f,m[f]=h,h=t[h],d=e[h],M[f]=y=e[h+1]):++d}},numeric.ccsLPSolve0=function(n,e,r,i,a,t,s,f){var h=n[0],l=n[1],v=n[2];h.length-1;var M=e[0],m=e[1],d=e[2],y,b,E,O,p,g,F,R,j;for(b=M[a],E=M[a+1],i.length=0,y=b;y<E;++y)f.dfs(m[y],h,l,r,i,t,s);for(y=i.length-1;y!==-1;--y)O=i[y],r[s[O]]=0;for(y=b;y!==E;++y)O=m[y],r[O]=d[y];for(y=i.length-1;y!==-1;--y){for(O=i[y],R=s[O],p=h[O],g=h[O+1],F=p;F<g;++F)if(l[F]===R){r[R]/=v[F];break}for(j=r[R],F=p;F<g;++F)r[l[F]]-=j*v[F];r[R]=j}},numeric.ccsLUP0=function(n,e){var r=n[0].length-1,i=[numeric.rep([r+1],0),[],[]],a=[numeric.rep([r+1],0),[],[]],t=i[0],s=i[1],f=i[2],h=a[0],l=a[1],v=a[2],M=numeric.rep([r],0),m=numeric.rep([r],0),d,y,b,E,O,p,g,F=numeric.ccsLPSolve0,R=Math.abs,j=numeric.linspace(0,r-1),u=numeric.linspace(0,r-1),x=new numeric.ccsDFS0(r);for(typeof e>"u"&&(e=1),d=0;d<r;++d){for(F(i,n,M,m,d,u,j,x),E=-1,O=-1,y=m.length-1;y!==-1;--y)b=m[y],!(b<=d)&&(p=R(M[j[b]]),p>E&&(O=b,E=p));for(R(M[j[d]])<e*E&&(y=j[d],E=j[O],j[d]=E,u[E]=d,j[O]=y,u[y]=O),E=t[d],O=h[d],g=M[j[d]],s[E]=j[d],f[E]=1,++E,y=m.length-1;y!==-1;--y)b=m[y],p=M[j[b]],m[y]=0,M[j[b]]=0,b<=d?(l[O]=b,v[O]=p,++O):(s[E]=j[b],f[E]=p/g,++E);t[d+1]=E,h[d+1]=O}for(y=s.length-1;y!==-1;--y)s[y]=u[s[y]];return{L:i,U:a,P:j,Pinv:u}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(n){return[numeric.sup(n[1])+1,n[0].length-1]},numeric.ccsGetBlock=function(n,e,r){var i=numeric.ccsDim(n),a=i[0],t=i[1];typeof e>"u"?e=numeric.linspace(0,a-1):typeof e=="number"&&(e=[e]),typeof r>"u"?r=numeric.linspace(0,t-1):typeof r=="number"&&(r=[r]);var s,f=e.length,h,l=r.length,v,M,m,d=numeric.rep([t],0),y=[],b=[],E=[d,y,b],O=n[0],p=n[1],g=n[2],F=numeric.rep([a],0),R=0,j=numeric.rep([a],0);for(h=0;h<l;++h){M=r[h];var u=O[M],x=O[M+1];for(s=u;s<x;++s)v=p[s],j[v]=1,F[v]=g[s];for(s=0;s<f;++s)m=e[s],j[m]&&(y[R]=s,b[R]=F[e[s]],++R);for(s=u;s<x;++s)v=p[s],j[v]=0;d[h+1]=R}return E},numeric.ccsDot=function(n,e){var r=n[0],i=n[1],a=n[2],t=e[0],s=e[1],f=e[2],h=numeric.ccsDim(n),l=numeric.ccsDim(e),v=h[0];h[1];var M=l[1],m=numeric.rep([v],0),d=numeric.rep([v],0),y=Array(v),b=numeric.rep([M],0),E=[],O=[],p=[b,E,O],g,F,R,j,u,x,N,L,G,$,ar;for(R=0;R!==M;++R){for(j=t[R],u=t[R+1],G=0,F=j;F<u;++F)for($=s[F],ar=f[F],x=r[$],N=r[$+1],g=x;g<N;++g)L=i[g],d[L]===0&&(y[G]=L,d[L]=1,G=G+1),m[L]=m[L]+a[g]*ar;for(j=b[R],u=j+G,b[R+1]=u,F=G-1;F!==-1;--F)ar=j+F,g=y[F],E[ar]=g,O[ar]=m[g],d[g]=0,m[g]=0;b[R+1]=b[R]+G}return p},numeric.ccsLUPSolve=function(n,e){var r=n.L,i=n.U;n.P;var a=e[0],t=!1;typeof a!="object"&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],a=e[0],t=!0);var s=e[1],f=e[2],h=r[0].length-1,l=a.length-1,v=numeric.rep([h],0),M=Array(h),m=numeric.rep([h],0),d=Array(h),y=numeric.rep([l+1],0),b=[],E=[],O=numeric.ccsTSolve,p,g,F,R,j,u,x=0;for(p=0;p<l;++p){for(j=0,F=a[p],R=a[p+1],g=F;g<R;++g)u=n.Pinv[s[g]],d[j]=u,m[u]=f[g],++j;for(d.length=j,O(r,m,v,d,M),g=d.length-1;g!==-1;--g)m[d[g]]=0;if(O(i,v,m,M,d),t)return m;for(g=M.length-1;g!==-1;--g)v[M[g]]=0;for(g=d.length-1;g!==-1;--g)u=d[g],b[x]=u,E[x]=m[u],m[u]=0,++x;y[p+1]=x}return[y,b,E]},numeric.ccsbinop=function(n,e){return typeof e>"u"&&(e=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+e+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+n+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)}(),numeric.ccsScatter=function o(n){var e=n[0],r=n[1],i=n[2],a=numeric.sup(r)+1,t=e.length,s=numeric.rep([a],0),f=Array(t),h=Array(t),l=numeric.rep([a],0),v;for(v=0;v<t;++v)l[r[v]]++;for(v=0;v<a;++v)s[v+1]=s[v]+l[v];var M=s.slice(0),m,d;for(v=0;v<t;++v)d=r[v],m=M[d],f[m]=e[v],h[m]=i[v],M[d]=M[d]+1;return[s,f,h]},numeric.ccsGather=function o(n){var e=n[0],r=n[1],i=n[2],a=e.length-1,t=r.length,s=Array(t),f=Array(t),h=Array(t),l,v,M,m,d;for(d=0,l=0;l<a;++l)for(M=e[l],m=e[l+1],v=M;v!==m;++v)f[d]=l,s[d]=r[v],h[d]=i[v],++d;return[s,f,h]},numeric.sdim=function o(n,e,r){if(typeof e>"u"&&(e=[]),typeof n!="object")return e;typeof r>"u"&&(r=0),r in e||(e[r]=0),n.length>e[r]&&(e[r]=n.length);var i;for(i in n)n.hasOwnProperty(i)&&o(n[i],e,r+1);return e},numeric.sclone=function o(n,e,r){typeof e>"u"&&(e=0),typeof r>"u"&&(r=numeric.sdim(n).length);var i,a=Array(n.length);if(e===r-1){for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a}for(i in n)n.hasOwnProperty(i)&&(a[i]=o(n[i],e+1,r));return a},numeric.sdiag=function o(n){var e=n.length,r,i=Array(e),a;for(r=e-1;r>=1;r-=2)a=r-1,i[r]=[],i[r][r]=n[r],i[a]=[],i[a][a]=n[a];return r===0&&(i[0]=[],i[0][0]=n[r]),i},numeric.sidentity=function o(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function o(n){var e=[];n.length;var r,i,a;for(r in n)if(n.hasOwnProperty(r)){a=n[r];for(i in a)a.hasOwnProperty(i)&&(typeof e[i]!="object"&&(e[i]=[]),e[i][r]=a[i])}return e},numeric.sLUP=function o(n,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function o(n,e){var r=n.length;e.length;var i=numeric.stranspose(e),a=i.length,t,s,f,h,l,v,M=Array(r),m;for(f=r-1;f>=0;f--){for(m=[],t=n[f],l=a-1;l>=0;l--){v=0,s=i[l];for(h in t)t.hasOwnProperty(h)&&h in s&&(v+=t[h]*s[h]);v&&(m[l]=v)}M[f]=m}return M},numeric.sdotMV=function o(n,e){var r=n.length,i,a,t,s=Array(r),f;for(a=r-1;a>=0;a--){i=n[a],f=0;for(t in i)i.hasOwnProperty(t)&&e[t]&&(f+=i[t]*e[t]);f&&(s[a]=f)}return s},numeric.sdotVM=function o(n,e){var r,i,a,t,s=[];for(r in n)if(n.hasOwnProperty(r)){a=e[r],t=n[r];for(i in a)a.hasOwnProperty(i)&&(s[i]||(s[i]=0),s[i]+=t*a[i])}return s},numeric.sdotVV=function o(n,e){var r,i=0;for(r in n)n[r]&&e[r]&&(i+=n[r]*e[r]);return i},numeric.sdot=function o(n,e){var r=numeric.sdim(n).length,i=numeric.sdim(e).length,a=r*1e3+i;switch(a){case 0:return n*e;case 1001:return numeric.sdotVV(n,e);case 2001:return numeric.sdotMV(n,e);case 1002:return numeric.sdotVM(n,e);case 2002:return numeric.sdotMM(n,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+i)}},numeric.sscatter=function o(n){var e=n[0].length,r,i,a,t=n.length,s=[],f;for(i=e-1;i>=0;--i)if(n[t-1][i]){for(f=s,a=0;a<t-2;a++)r=n[a][i],f[r]||(f[r]=[]),f=f[r];f[n[a][i]]=n[a+1][i]}return s},numeric.sgather=function o(n,e,r){typeof e>"u"&&(e=[]),typeof r>"u"&&(r=[]);var i,a,t;i=r.length;for(a in n)if(n.hasOwnProperty(a))if(r[i]=parseInt(a),t=n[a],typeof t=="number"){if(t){if(e.length===0)for(a=i+1;a>=0;--a)e[a]=[];for(a=i;a>=0;--a)e[a].push(r[a]);e[i+1].push(t)}}else o(t,e,r);return r.length>i&&r.pop(),e},numeric.cLU=function o(n){var e=n[0],r=n[1],i=n[2],x=e.length,a=0,t,s,f,h,l,v;for(t=0;t<x;t++)e[t]>a&&(a=e[t]);a++;var M=Array(a),m=Array(a),d=numeric.rep([a],1/0),y=numeric.rep([a],-1/0),p,g,b;for(f=0;f<x;f++)t=e[f],s=r[f],s<d[t]&&(d[t]=s),s>y[t]&&(y[t]=s);for(t=0;t<a-1;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=a-1;t>=1;t--)d[t]<d[t-1]&&(d[t-1]=d[t]);var E=0,O=0;for(t=0;t<a;t++)m[t]=numeric.rep([y[t]-d[t]+1],0),M[t]=numeric.rep([t-d[t]],0),E+=t-d[t]+1,O+=y[t]-t+1;for(f=0;f<x;f++)t=e[f],m[t][r[f]-d[t]]=i[f];for(t=0;t<a-1;t++)for(h=t-d[t],p=m[t],s=t+1;d[s]<=t&&s<a;s++)if(l=t-d[s],v=y[t]-t,g=m[s],b=g[l]/p[h],b){for(f=1;f<=v;f++)g[f+l]-=b*p[f+h];M[s][t-d[s]]=b}var p=[],g=[],F=[],R=[],j=[],u=[],x,N,L;for(x=0,N=0,t=0;t<a;t++){for(h=d[t],l=y[t],L=m[t],s=t;s<=l;s++)L[s-h]&&(p[x]=t,g[x]=s,F[x]=L[s-h],x++);for(L=M[t],s=h;s<t;s++)L[s-h]&&(R[N]=t,j[N]=s,u[N]=L[s-h],N++);R[N]=t,j[N]=t,u[N]=1,N++}return{U:[p,g,F],L:[R,j,u]}},numeric.cLUsolve=function o(n,e){var r=n.L,i=n.U,a=numeric.clone(e),t=r[0],s=r[1],f=r[2],h=i[0],l=i[1],v=i[2],M=h.length;t.length;var m=a.length,d,y;for(y=0,d=0;d<m;d++){for(;s[y]<d;)a[d]-=f[y]*a[s[y]],y++;y++}for(y=M-1,d=m-1;d>=0;d--){for(;l[y]>d;)a[d]-=v[y]*a[l[y]],y--;a[d]/=v[y],y--}return a},numeric.cgrid=function o(n,e){typeof n=="number"&&(n=[n,n]);var r=numeric.rep(n,-1),i,a,t;if(typeof e!="function")switch(e){case"L":e=function(s,f){return s>=n[0]/2||f<n[1]/2};break;default:e=function(s,f){return!0};break}for(t=0,i=1;i<n[0]-1;i++)for(a=1;a<n[1]-1;a++)e(i,a)&&(r[i][a]=t,t++);return r},numeric.cdelsq=function o(n){var e=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(n),i=r[0],a=r[1],t,s,f,h,l,v=[],M=[],m=[];for(t=1;t<i-1;t++)for(s=1;s<a-1;s++)if(!(n[t][s]<0)){for(f=0;f<4;f++)h=t+e[f][0],l=s+e[f][1],!(n[h][l]<0)&&(v.push(n[t][s]),M.push(n[h][l]),m.push(-1));v.push(n[t][s]),M.push(n[t][s]),m.push(4)}return[v,M,m]},numeric.cdotMV=function o(n,e){var r,i=n[0],a=n[1],t=n[2],s,f=i.length,h;for(h=0,s=0;s<f;s++)i[s]>h&&(h=i[s]);for(h++,r=numeric.rep([h],0),s=0;s<f;s++)r[i[s]]+=t[s]*e[a[s]];return r},numeric.Spline=function o(n,e,r,i,a){this.x=n,this.yl=e,this.yr=r,this.kl=i,this.kr=a},numeric.Spline.prototype._at=function o(f,e){var r=this.x,i=this.yl,a=this.yr,t=this.kl,s=this.kr,f,h,l,v,M=numeric.add,m=numeric.sub,d=numeric.mul;h=m(d(t[e],r[e+1]-r[e]),m(a[e+1],i[e])),l=M(d(s[e+1],r[e]-r[e+1]),m(a[e+1],i[e])),v=(f-r[e])/(r[e+1]-r[e]);var y=v*(1-v);return M(M(M(d(1-v,i[e]),d(v,a[e+1])),d(h,y*(1-v))),d(l,y*v))},numeric.Spline.prototype.at=function o(n){if(typeof n=="number"){var e=this.x,s=e.length,r,i,a,t=Math.floor;for(r=0,i=s-1;i-r>1;)a=t((r+i)/2),e[a]<=n?r=a:i=a;return this._at(n,r)}var s=n.length,f,h=Array(s);for(f=s-1;f!==-1;--f)h[f]=this.at(n[f]);return h},numeric.Spline.prototype.diff=function o(){var n=this.x,e=this.yl,r=this.yr,i=this.kl,a=this.kr,t=e.length,s,f,h,l=i,v=a,M=Array(t),m=Array(t),d=numeric.add,y=numeric.mul,b=numeric.div,E=numeric.sub;for(s=t-1;s!==-1;--s)f=n[s+1]-n[s],h=E(r[s+1],e[s]),M[s]=b(d(y(h,6),y(i[s],-4*f),y(a[s+1],-2*f)),f*f),m[s+1]=b(d(y(h,-6),y(i[s],2*f),y(a[s+1],4*f)),f*f);return new numeric.Spline(n,l,v,M,m)},numeric.Spline.prototype.roots=function o(){function n(D){return D*D}var b=[],e=this.x,r=this.yl,i=this.yr,a=this.kl,t=this.kr;typeof r[0]=="number"&&(r=[r],i=[i],a=[a],t=[t]);var s=r.length,f=e.length-1,h,l,v,M,m,d,y,b=Array(s),E,O,p,g,F,R,j,u,x,N,L,G,$,ar,pr,Mr,wr=Math.sqrt;for(h=0;h!==s;++h){for(M=r[h],m=i[h],d=a[h],y=t[h],E=[],l=0;l!==f;l++){for(l>0&&m[l]*M[l]<0&&E.push(e[l]),x=e[l+1]-e[l],e[l],g=M[l],F=m[l+1],O=d[l]/x,p=y[l+1]/x,u=n(O-p+3*(g-F))+12*p*g,R=p+3*g+2*O-3*F,j=3*(p+O+2*(g-F)),u<=0?(L=R/j,L>e[l]&&L<e[l+1]?N=[e[l],L,e[l+1]]:N=[e[l],e[l+1]]):(L=(R-wr(u))/j,G=(R+wr(u))/j,N=[e[l]],L>e[l]&&L<e[l+1]&&N.push(L),G>e[l]&&G<e[l+1]&&N.push(G),N.push(e[l+1])),ar=N[0],L=this._at(ar,l),v=0;v<N.length-1;v++){if(pr=N[v+1],G=this._at(pr,l),L===0){E.push(ar),ar=pr,L=G;continue}if(G===0||L*G>0){ar=pr,L=G;continue}for(var Y=0;Mr=(L*pr-G*ar)/(L-G),!(Mr<=ar||Mr>=pr);)if($=this._at(Mr,l),$*G>0)pr=Mr,G=$,Y===-1&&(L*=.5),Y=-1;else if($*L>0)ar=Mr,L=$,Y===1&&(G*=.5),Y=1;else break;E.push(Mr),ar=N[v+1],L=this._at(ar,l)}G===0&&E.push(pr)}b[h]=E}return typeof this.yl[0]=="number"?b[0]:b},numeric.spline=function o(n,e,r,i){var a=n.length,t=[],s=[],f=[],h,l=numeric.sub,v=numeric.mul,M=numeric.add;for(h=a-2;h>=0;h--)s[h]=n[h+1]-n[h],f[h]=l(e[h+1],e[h]);(typeof r=="string"||typeof i=="string")&&(r=i="periodic");var m=[[],[],[]];switch(typeof r){case"undefined":t[0]=v(3/(s[0]*s[0]),f[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/s[0],1/s[0]);break;case"string":t[0]=M(v(3/(s[a-2]*s[a-2]),f[a-2]),v(3/(s[0]*s[0]),f[0])),m[0].push(0,0,0),m[1].push(a-2,0,1),m[2].push(1/s[a-2],2/s[a-2]+2/s[0],1/s[0]);break;default:t[0]=r,m[0].push(0),m[1].push(0),m[2].push(1);break}for(h=1;h<a-1;h++)t[h]=M(v(3/(s[h-1]*s[h-1]),f[h-1]),v(3/(s[h]*s[h]),f[h])),m[0].push(h,h,h),m[1].push(h-1,h,h+1),m[2].push(1/s[h-1],2/s[h-1]+2/s[h],1/s[h]);switch(typeof i){case"undefined":t[a-1]=v(3/(s[a-2]*s[a-2]),f[a-2]),m[0].push(a-1,a-1),m[1].push(a-2,a-1),m[2].push(1/s[a-2],2/s[a-2]);break;case"string":m[1][m[1].length-1]=0;break;default:t[a-1]=i,m[0].push(a-1),m[1].push(a-1),m[2].push(1);break}typeof t[0]!="number"?t=numeric.transpose(t):t=[t];var d=Array(t.length);if(typeof r=="string")for(h=d.length-1;h!==-1;--h)d[h]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),t[h]),d[h][a-1]=d[h][0];else for(h=d.length-1;h!==-1;--h)d[h]=numeric.cLUsolve(numeric.cLU(m),t[h]);return typeof e[0]=="number"?d=d[0]:d=numeric.transpose(d),new numeric.Spline(n,e,e,d,d)},numeric.fftpow2=function o(n,e){var r=n.length;if(r!==1){var i=Math.cos,a=Math.sin,t,s,f=Array(r/2),h=Array(r/2),l=Array(r/2),v=Array(r/2);for(s=r/2,t=r-1;t!==-1;--t)--s,l[s]=n[t],v[s]=e[t],--t,f[s]=n[t],h[s]=e[t];o(f,h),o(l,v),s=r/2;var M,m=-6.283185307179586/r,d,y;for(t=r-1;t!==-1;--t)--s,s===-1&&(s=r/2-1),M=m*t,d=i(M),y=a(M),n[t]=f[s]+d*l[s]-y*v[s],e[t]=h[s]+d*v[s]+y*l[s]}},numeric._ifftpow2=function o(n,e){var r=n.length;if(r!==1){var i=Math.cos,a=Math.sin,t,s,f=Array(r/2),h=Array(r/2),l=Array(r/2),v=Array(r/2);for(s=r/2,t=r-1;t!==-1;--t)--s,l[s]=n[t],v[s]=e[t],--t,f[s]=n[t],h[s]=e[t];o(f,h),o(l,v),s=r/2;var M,m=6.283185307179586/r,d,y;for(t=r-1;t!==-1;--t)--s,s===-1&&(s=r/2-1),M=m*t,d=i(M),y=a(M),n[t]=f[s]+d*l[s]-y*v[s],e[t]=h[s]+d*v[s]+y*l[s]}},numeric.ifftpow2=function o(n,e){numeric._ifftpow2(n,e),numeric.diveq(n,n.length),numeric.diveq(e,e.length)},numeric.convpow2=function o(n,e,r,i){numeric.fftpow2(n,e),numeric.fftpow2(r,i);var a,t=n.length,s,f,h,l;for(a=t-1;a!==-1;--a)s=n[a],h=e[a],f=r[a],l=i[a],n[a]=s*f-h*l,e[a]=s*l+h*f;numeric.ifftpow2(n,e)},numeric.T.prototype.fft=function o(){var n=this.x,e=this.y,r=n.length,i=Math.log,a=i(2),t=Math.ceil(i(2*r-1)/a),s=Math.pow(2,t),f=numeric.rep([s],0),h=numeric.rep([s],0),l=Math.cos,v=Math.sin,M,m=-3.141592653589793/r,d,y=numeric.rep([s],0),b=numeric.rep([s],0);for(M=0;M<r;M++)y[M]=n[M];if(typeof e<"u")for(M=0;M<r;M++)b[M]=e[M];for(f[0]=1,M=1;M<=s/2;M++)d=m*M*M,f[M]=l(d),h[M]=v(d),f[s-M]=l(d),h[s-M]=v(d);var E=new numeric.T(y,b),O=new numeric.T(f,h);return E=E.mul(O),numeric.convpow2(E.x,E.y,numeric.clone(O.x),numeric.neg(O.y)),E=E.mul(O),E.x.length=r,E.y.length=r,E},numeric.T.prototype.ifft=function o(){var n=this.x,e=this.y,r=n.length,i=Math.log,a=i(2),t=Math.ceil(i(2*r-1)/a),s=Math.pow(2,t),f=numeric.rep([s],0),h=numeric.rep([s],0),l=Math.cos,v=Math.sin,M,m=3.141592653589793/r,d,y=numeric.rep([s],0),b=numeric.rep([s],0);for(M=0;M<r;M++)y[M]=n[M];if(typeof e<"u")for(M=0;M<r;M++)b[M]=e[M];for(f[0]=1,M=1;M<=s/2;M++)d=m*M*M,f[M]=l(d),h[M]=v(d),f[s-M]=l(d),h[s-M]=v(d);var E=new numeric.T(y,b),O=new numeric.T(f,h);return E=E.mul(O),numeric.convpow2(E.x,E.y,numeric.clone(O.x),numeric.neg(O.y)),E=E.mul(O),E.x.length=r,E.y.length=r,E.div(r)},numeric.gradient=function o(n,e){var r=e.length,i=n(e);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var v=Math.max,a,t=numeric.clone(e),s,f,h=Array(r);numeric.div,numeric.sub;var l,v=Math.max,M=.001,m=Math.abs,d=Math.min,y,b,E,O=0,p,g,F;for(a=0;a<r;a++)for(var R=v(1e-6*i,1e-8);;){if(++O,O>20)throw new Error("Numerical gradient fails");if(t[a]=e[a]+R,s=n(t),t[a]=e[a]-R,f=n(t),t[a]=e[a],isNaN(s)||isNaN(f)){R/=16;continue}if(h[a]=(s-f)/(2*R),y=e[a]-R,b=e[a],E=e[a]+R,p=(s-i)/R,g=(i-f)/R,F=v(m(h[a]),m(i),m(s),m(f),m(y),m(b),m(E),1e-8),l=d(v(m(p-h[a]),m(g-h[a]),m(p-g))/F,R/F),l>M)R/=16;else break}return h},numeric.uncmin=function o(n,e,r,i,a,t,s){var f=numeric.gradient;typeof s>"u"&&(s={}),typeof r>"u"&&(r=1e-8),typeof i>"u"&&(i=function(tr){return f(n,tr)}),typeof a>"u"&&(a=1e3),e=numeric.clone(e);var h=e.length,l=n(e),v,M;if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,d=numeric.norm2;r=m(r,numeric.epsilon);var y,b,E,O=s.Hinv||numeric.identity(h),p=numeric.dot;numeric.inv;var g=numeric.sub,F=numeric.add,R=numeric.tensor,j=numeric.div,u=numeric.mul,x=numeric.all,N=numeric.isFinite,L=numeric.neg,G=0,$,ar,pr,Mr,wr,Y,D,I="";for(b=i(e);G<a;){if(typeof t=="function"&&t(G,e,l,b,O)){I="Callback returned true";break}if(!x(N(b))){I="Gradient has Infinity or NaN";break}if(y=L(p(O,b)),!x(N(y))){I="Search direction has Infinity or NaN";break}if(D=d(y),D<r){I="Newton step smaller than tol";break}for(Y=1,M=p(b,y),ar=e;G<a&&!(Y*D<r);){if($=u(y,Y),ar=F(e,$),v=n(ar),v-l>=.1*Y*M||isNaN(v)){Y*=.5,++G;continue}break}if(Y*D<r){I="Line search step size smaller than tol";break}if(G===a){I="maxit reached during line search";break}E=i(ar),pr=g(E,b),wr=p(pr,$),Mr=p(O,pr),O=g(F(O,u((wr+p(pr,Mr))/(wr*wr),R($,$))),j(F(R(Mr,$),R($,Mr)),wr)),e=ar,l=v,b=E,++G}return{solution:e,f:l,gradient:b,invHessian:O,iterations:G,message:I}},numeric.Dopri=function o(n,e,r,i,a,t,s){this.x=n,this.y=e,this.f=r,this.ymid=i,this.iterations=a,this.events=s,this.message=t},numeric.Dopri.prototype._at=function o(y,e){function r(u){return u*u}var i=this,a=i.x,t=i.y,s=i.f,f=i.ymid;a.length;var h,l,v,M,m,d,y,b,E=.5,O=numeric.add,p=numeric.mul,g=numeric.sub,F,R,j;return h=a[e],l=a[e+1],M=t[e],m=t[e+1],b=l-h,v=h+E*b,d=f[e],F=g(s[e],p(M,1/(h-v)+2/(h-l))),R=g(s[e+1],p(m,1/(l-v)+2/(l-h))),j=[r(y-l)*(y-v)/r(h-l)/(h-v),r(y-h)*r(y-l)/r(h-v)/r(l-v),r(y-h)*(y-v)/r(l-h)/(l-v),(y-h)*r(y-l)*(y-v)/r(h-l)/(h-v),(y-l)*r(y-h)*(y-v)/r(h-l)/(l-v)],O(O(O(O(p(M,j[0]),p(d,j[1])),p(m,j[2])),p(F,j[3])),p(R,j[4]))},numeric.Dopri.prototype.at=function o(n){var e,r,i,a=Math.floor;if(typeof n!="number"){var t=n.length,s=Array(t);for(e=t-1;e!==-1;--e)s[e]=this.at(n[e]);return s}var f=this.x;for(e=0,r=f.length-1;r-e>1;)i=a(.5*(e+r)),f[i]<=n?e=i:r=i;return this._at(n,e)},numeric.dopri=function o(n,e,r,i,a,t,s){typeof a>"u"&&(a=1e-6),typeof t>"u"&&(t=1e3);var f=[n],h=[r],l=[i(n,r)],v,M,m,d,y,b,E=[],O=1/5,p=[3/40,9/40],g=[44/45,-56/15,32/9],F=[19372/6561,-25360/2187,64448/6561,-212/729],R=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],j=[35/384,0,500/1113,125/192,-2187/6784,11/84],u=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],x=[1/5,3/10,4/5,8/9,1,1],N=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],L=0,G,$,ar=(e-n)/10,pr=0,Mr=numeric.add,wr=numeric.mul,Y,D,I=Math.min,tr=Math.abs,ir=numeric.norminf,or=Math.pow,gr=numeric.any,_=numeric.lt,w=numeric.and;numeric.sub;var q,K,H,Z=new numeric.Dopri(f,h,l,E,-1,"");for(typeof s=="function"&&(q=s(n,r));n<e&&pr<t;){if(++pr,n+ar>e&&(ar=e-n),v=i(n+x[0]*ar,Mr(r,wr(O*ar,l[L]))),M=i(n+x[1]*ar,Mr(Mr(r,wr(p[0]*ar,l[L])),wr(p[1]*ar,v))),m=i(n+x[2]*ar,Mr(Mr(Mr(r,wr(g[0]*ar,l[L])),wr(g[1]*ar,v)),wr(g[2]*ar,M))),d=i(n+x[3]*ar,Mr(Mr(Mr(Mr(r,wr(F[0]*ar,l[L])),wr(F[1]*ar,v)),wr(F[2]*ar,M)),wr(F[3]*ar,m))),y=i(n+x[4]*ar,Mr(Mr(Mr(Mr(Mr(r,wr(R[0]*ar,l[L])),wr(R[1]*ar,v)),wr(R[2]*ar,M)),wr(R[3]*ar,m)),wr(R[4]*ar,d))),Y=Mr(Mr(Mr(Mr(Mr(r,wr(l[L],ar*j[0])),wr(M,ar*j[2])),wr(m,ar*j[3])),wr(d,ar*j[4])),wr(y,ar*j[5])),b=i(n+ar,Y),G=Mr(Mr(Mr(Mr(Mr(wr(l[L],ar*N[0]),wr(M,ar*N[2])),wr(m,ar*N[3])),wr(d,ar*N[4])),wr(y,ar*N[5])),wr(b,ar*N[6])),typeof G=="number"?D=tr(G):D=ir(G),D>a){if(ar=.2*ar*or(a/D,.25),n+ar===n){Z.msg="Step size became too small";break}continue}if(E[L]=Mr(Mr(Mr(Mr(Mr(Mr(r,wr(l[L],ar*u[0])),wr(M,ar*u[2])),wr(m,ar*u[3])),wr(d,ar*u[4])),wr(y,ar*u[5])),wr(b,ar*u[6])),++L,f[L]=n+ar,h[L]=Y,l[L]=b,typeof s=="function"){var rr,hr=n,mr=n+.5*ar,z;if(K=s(mr,E[L-1]),H=w(_(q,0),_(0,K)),gr(H)||(hr=mr,mr=n+ar,q=K,K=s(mr,Y),H=w(_(q,0),_(0,K))),gr(H)){for(var J,nr,cr=0,ur=1,c=1;;){if(typeof q=="number")z=(c*K*hr-ur*q*mr)/(c*K-ur*q);else for(z=mr,$=q.length-1;$!==-1;--$)q[$]<0&&K[$]>0&&(z=I(z,(c*K[$]*hr-ur*q[$]*mr)/(c*K[$]-ur*q[$])));if(z<=hr||z>=mr)break;rr=Z._at(z,L-1),nr=s(z,rr),J=w(_(q,0),_(0,nr)),gr(J)?(mr=z,K=nr,H=J,c=1,cr===-1?ur*=.5:ur=1,cr=-1):(hr=z,q=nr,ur=1,cr===1?c*=.5:c=1,cr=1)}return Y=Z._at(.5*(n+z),L-1),Z.f[L]=i(z,rr),Z.x[L]=z,Z.y[L]=rr,Z.ymid[L-1]=Y,Z.events=H,Z.iterations=pr,Z}}n+=ar,r=Y,q=K,ar=I(.8*ar*or(a/D,.25),4*ar)}return Z.iterations=pr,Z},numeric.LU=function(o,n){n=n||!1;var e=Math.abs,r,i,a,t,s,f,h,l,v,M=o.length,m=M-1,d=new Array(M);for(n||(o=numeric.clone(o)),a=0;a<M;++a){for(h=a,f=o[a],v=e(f[a]),i=a+1;i<M;++i)t=e(o[i][a]),v<t&&(v=t,h=i);for(d[a]=h,h!=a&&(o[a]=o[h],o[h]=f,f=o[a]),s=f[a],r=a+1;r<M;++r)o[r][a]/=s;for(r=a+1;r<M;++r){for(l=o[r],i=a+1;i<m;++i)l[i]-=l[a]*f[i],++i,l[i]-=l[a]*f[i];i===m&&(l[i]-=l[a]*f[i])}}return{LU:o,P:d}},numeric.LUsolve=function o(n,e){var r,i,a=n.LU,t=a.length,s=numeric.clone(e),f=n.P,h,l,v;for(r=t-1;r!==-1;--r)s[r]=e[r];for(r=0;r<t;++r)for(h=f[r],f[r]!==r&&(v=s[r],s[r]=s[h],s[h]=v),l=a[r],i=0;i<r;++i)s[r]-=s[i]*l[i];for(r=t-1;r>=0;--r){for(l=a[r],i=r+1;i<t;++i)s[r]-=s[i]*l[i];s[r]/=l[r]}return s},numeric.solve=function o(n,e,r){return numeric.LUsolve(numeric.LU(n,r),e)},numeric.echelonize=function o(n){var e=numeric.dim(n),r=e[0],i=e[1],a=numeric.identity(r),t=Array(r),s,f,h,l,v,M,m,d,y=Math.abs,b=numeric.diveq;for(n=numeric.clone(n),s=0;s<r;++s){for(h=0,v=n[s],M=a[s],f=1;f<i;++f)y(v[h])<y(v[f])&&(h=f);for(t[s]=h,b(M,v[h]),b(v,v[h]),f=0;f<r;++f)if(f!==s){for(m=n[f],d=m[h],l=i-1;l!==-1;--l)m[l]-=v[l]*d;for(m=a[f],l=r-1;l!==-1;--l)m[l]-=M[l]*d}}return{I:a,A:n,P:t}},numeric.__solveLP=function o(n,e,r,i,a,t,s){var f=numeric.sum;numeric.log;var h=numeric.mul,l=numeric.sub,v=numeric.dot,M=numeric.div,m=numeric.add,d=n.length,y=r.length,b,E=!1,O=0,p=1;numeric.transpose(e),numeric.svd;var g=numeric.transpose;numeric.leq;var F=Math.sqrt,R=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var j=Math.min,u=numeric.all,x=numeric.gt,N=Array(d),L=Array(y);numeric.rep([y],1);var G,$=numeric.solve,ar=l(r,v(e,t)),pr,Mr=v(n,n),wr;for(pr=O;pr<a;++pr){var Y,D;for(Y=y-1;Y!==-1;--Y)L[Y]=M(e[Y],ar[Y]);var I=g(L);for(Y=d-1;Y!==-1;--Y)N[Y]=f(I[Y]);p=.25*R(Mr/v(n,N));var tr=100*F(Mr/v(N,N));for((!isFinite(p)||p>tr)&&(p=tr),wr=m(n,h(p,N)),G=v(I,L),Y=d-1;Y!==-1;--Y)G[Y][Y]+=1;D=$(G,M(wr,p),!0);var ir=M(ar,v(e,D)),or=1;for(Y=y-1;Y!==-1;--Y)ir[Y]<0&&(or=j(or,-.999*ir[Y]));if(b=l(t,h(D,or)),ar=l(r,v(e,b)),!u(x(ar,0)))return{solution:t,message:"",iterations:pr};if(t=b,p<i)return{solution:b,message:"",iterations:pr};if(s){var gr=v(n,wr),_=v(e,wr);for(E=!0,Y=y-1;Y!==-1;--Y)if(gr*_[Y]<0){E=!1;break}}else t[d-1]>=0?E=!1:E=!0;if(E)return{solution:b,message:"Unbounded",iterations:pr}}return{solution:t,message:"maximum iteration count exceeded",iterations:pr}},numeric._solveLP=function o(n,e,r,i,a){var t=n.length,s=r.length,d;numeric.sum,numeric.log,numeric.mul;var f=numeric.sub,h=numeric.dot;numeric.div,numeric.add;var l=numeric.rep([t],0).concat([1]),v=numeric.rep([s,1],-1),M=numeric.blockMatrix([[e,v]]),m=r,d=numeric.rep([t],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),y=numeric.__solveLP(l,M,m,i,a,d,!1),b=numeric.clone(y.solution);b.length=t;var E=numeric.inf(f(r,h(e,b)));if(E<0)return{solution:NaN,message:"Infeasible",iterations:y.iterations};var O=numeric.__solveLP(n,e,r,i,a-y.iterations,b,!0);return O.iterations+=y.iterations,O},numeric.solveLP=function o(n,e,r,i,a,t,s){if(typeof s>"u"&&(s=1e3),typeof t>"u"&&(t=numeric.epsilon),typeof i>"u")return numeric._solveLP(n,e,r,t,s);var f=i.length,h=i[0].length,l=e.length,v=numeric.echelonize(i),M=numeric.rep([h],0),m=v.P,d=[],y;for(y=m.length-1;y!==-1;--y)M[m[y]]=1;for(y=h-1;y!==-1;--y)M[y]===0&&d.push(y);var b=numeric.getRange,E=numeric.linspace(0,f-1),O=numeric.linspace(0,l-1),p=b(i,E,d),g=b(e,O,m),F=b(e,O,d),R=numeric.dot,j=numeric.sub,u=R(g,v.I),x=j(F,R(u,p)),N=j(r,R(u,a)),L=Array(m.length),G=Array(d.length);for(y=m.length-1;y!==-1;--y)L[y]=n[m[y]];for(y=d.length-1;y!==-1;--y)G[y]=n[d[y]];var $=j(G,R(L,R(v.I,p))),ar=numeric._solveLP($,x,N,t,s),pr=ar.solution;if(pr!==pr)return ar;var Mr=R(v.I,j(a,R(p,pr))),wr=Array(n.length);for(y=m.length-1;y!==-1;--y)wr[m[y]]=Mr[y];for(y=d.length-1;y!==-1;--y)wr[d[y]]=pr[y];return{solution:wr,message:ar.message,iterations:ar.iterations}},numeric.MPStoLP=function o(n){n instanceof String&&n.split(`
`);var e=0,r=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=n.length,a,t,s,f=0,h={},l=[],v=0,M={},m=0,d,y=[],b=[],E=[];function O(j){throw new Error("MPStoLP: "+j+`
Line `+a+": "+n[a]+`
Current state: `+r[e]+`
`)}for(a=0;a<i;++a){s=n[a];var p=s.match(/\S*/g),g=[];for(t=0;t<p.length;++t)p[t]!==""&&g.push(p[t]);if(g.length!==0){for(t=0;t<r.length&&s.substr(0,r[t].length)!==r[t];++t);if(t<r.length){if(e=t,t===1&&(d=g[1]),t===6)return{name:d,c:y,A:numeric.transpose(b),b:E,rows:h,vars:M};continue}switch(e){case 0:case 1:O("Unexpected line");case 2:switch(g[0]){case"N":f===0?f=g[1]:O("Two or more N rows");break;case"L":h[g[1]]=v,l[v]=1,E[v]=0,++v;break;case"G":h[g[1]]=v,l[v]=-1,E[v]=0,++v;break;case"E":h[g[1]]=v,l[v]=0,E[v]=0,++v;break;default:O("Parse error "+numeric.prettyPrint(g))}break;case 3:M.hasOwnProperty(g[0])||(M[g[0]]=m,y[m]=0,b[m]=numeric.rep([v],0),++m);var F=M[g[0]];for(t=1;t<g.length;t+=2){if(g[t]===f){y[F]=parseFloat(g[t+1]);continue}var R=h[g[t]];b[F][R]=(l[R]<0?-1:1)*parseFloat(g[t+1])}break;case 4:for(t=1;t<g.length;t+=2)E[h[g[t]]]=(l[h[g[t]]]<0?-1:1)*parseFloat(g[t+1]);break;case 5:break;case 6:O("Internal error")}}}O("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(o,n,e,r,i,a,t){n.seedrandom=function(M,m){var d=[],y;return M=h(f(m?[M,o]:arguments.length?M:[new Date().getTime(),o,window],3),d),y=new s(d),h(y.S,o),n.random=function(){for(var E=y.g(r),O=t,p=0;E<i;)E=(E+p)*e,O*=e,p=y.g(1);for(;E>=a;)E/=2,O/=2,p>>>=1;return(E+p)/O},M};function s(v){var M,m,d=this,y=v.length,b=0,E=d.i=d.j=d.m=0;for(d.S=[],d.c=[],y||(v=[y++]);b<e;)d.S[b]=b++;for(b=0;b<e;b++)M=d.S[b],E=l(E+M+v[b%y]),m=d.S[E],d.S[b]=m,d.S[E]=M;d.g=function(p){var g=d.S,F=l(d.i+1),R=g[F],j=l(d.j+R),u=g[j];g[F]=u,g[j]=R;for(var x=g[l(R+u)];--p;)F=l(F+1),R=g[F],j=l(j+R),u=g[j],g[F]=u,g[j]=R,x=x*e+g[l(R+u)];return d.i=F,d.j=j,x},d.g(e)}function f(v,M,m,d,y){if(m=[],y=typeof v,M&&y=="object"){for(d in v)if(d.indexOf("S")<5)try{m.push(f(v[d],M-1))}catch{}}return m.length?m:v+(y!="string"?"\0":"")}function h(v,M,m,d){for(v+="",m=0,d=0;d<v.length;d++)M[l(d)]=l((m^=M[l(d)]*19)+v.charCodeAt(d));v="";for(d in M)v+=String.fromCharCode(M[d]);return v}function l(v){return v&e-1}t=n.pow(e,r),i=n.pow(2,i),a=i*2,h(n.random(),o)}([],numeric.seedrandom,256,6,52),function(o){function n(f){if(typeof f!="object")return f;var h=[],l,v=f.length;for(l=0;l<v;l++)h[l+1]=n(f[l]);return h}function e(f){if(typeof f!="object")return f;var h=[],l,v=f.length;for(l=1;l<v;l++)h[l-1]=e(f[l]);return h}function r(f,h,l){var v,M,m,d,y;for(m=1;m<=l;m=m+1){for(f[m][m]=1/f[m][m],y=-f[m][m],v=1;v<m;v=v+1)f[v][m]=y*f[v][m];if(d=m+1,l<d)break;for(M=d;M<=l;M=M+1)for(y=f[m][M],f[m][M]=0,v=1;v<=m;v=v+1)f[v][M]=f[v][M]+y*f[v][m]}}function i(f,h,l,v){var M,m,d,y;for(m=1;m<=l;m=m+1){for(y=0,M=1;M<m;M=M+1)y=y+f[M][m]*v[M];v[m]=(v[m]-y)/f[m][m]}for(d=1;d<=l;d=d+1)for(m=l+1-d,v[m]=v[m]/f[m][m],y=-v[m],M=1;M<m;M=M+1)v[M]=v[M]+y*f[M][m]}function a(f,h,l,v){var M,m,d,y,b,E;for(m=1;m<=l;m=m+1){if(v[1]=m,E=0,d=m-1,d<1){if(E=f[m][m]-E,E<=0)break;f[m][m]=Math.sqrt(E)}else{for(y=1;y<=d;y=y+1){for(b=f[y][m],M=1;M<y;M=M+1)b=b-f[M][m]*f[M][y];b=b/f[y][y],f[y][m]=b,E=E+b*b}if(E=f[m][m]-E,E<=0)break;f[m][m]=Math.sqrt(E)}v[1]=0}}function t(f,h,l,v,M,m,d,y,b,E,O,p,g,F,R,j){var u,x,N,L,G,$,ar,pr,Mr,wr,Y,D,I,tr,ir,or,gr,_,w,q,K,H,Z,rr,hr,mr,z;I=Math.min(v,E),N=2*v+I*(I+5)/2+2*E+1,rr=1e-60;do rr=rr+rr,hr=1+.1*rr,mr=1+.2*rr;while(hr<=1||mr<=1);for(u=1;u<=v;u=u+1)R[u]=h[u];for(u=v+1;u<=N;u=u+1)R[u]=0;for(u=1;u<=E;u=u+1)p[u]=0;if(G=[],j[1]===0){if(a(f,l,v,G),G[1]!==0){j[1]=2;return}i(f,l,v,h),r(f,l,v)}else{for(x=1;x<=v;x=x+1)for(M[x]=0,u=1;u<=x;u=u+1)M[x]=M[x]+f[u][x]*h[u];for(x=1;x<=v;x=x+1)for(h[x]=0,u=x;u<=v;u=u+1)h[x]=h[x]+f[x][u]*M[u]}for(m[1]=0,x=1;x<=v;x=x+1)for(M[x]=h[x],m[1]=m[1]+R[x]*M[x],R[x]=0,u=x+1;u<=v;u=u+1)f[u][x]=0;for(m[1]=-m[1]/2,j[1]=0,ar=v,pr=ar+v,Y=pr+I,Mr=Y+I+1,wr=Mr+I*(I+1)/2,tr=wr+E,u=1;u<=E;u=u+1){for(or=0,x=1;x<=v;x=x+1)or=or+d[x][u]*d[x][u];R[tr+u]=Math.sqrt(or)}g=0,F[1]=0,F[2]=0;function J(){for(F[1]=F[1]+1,N=wr,u=1;u<=E;u=u+1){for(N=N+1,or=-y[u],x=1;x<=v;x=x+1)or=or+d[x][u]*M[x];if(Math.abs(or)<rr&&(or=0),u>O)R[N]=or;else if(R[N]=-Math.abs(or),or>0){for(x=1;x<=v;x=x+1)d[x][u]=-d[x][u];y[u]=-y[u]}}for(u=1;u<=g;u=u+1)R[wr+p[u]]=0;for(D=0,ir=0,u=1;u<=E;u=u+1)R[wr+u]<ir*R[tr+u]&&(D=u,ir=R[wr+u]/R[tr+u]);return D===0?999:0}function nr(){for(u=1;u<=v;u=u+1){for(or=0,x=1;x<=v;x=x+1)or=or+f[x][u]*d[x][D];R[u]=or}for(L=ar,u=1;u<=v;u=u+1)R[L+u]=0;for(x=g+1;x<=v;x=x+1)for(u=1;u<=v;u=u+1)R[L+u]=R[L+u]+f[u][x]*R[x];for(H=!0,u=g;u>=1;u=u-1){for(or=R[u],N=Mr+u*(u+3)/2,L=N-u,x=u+1;x<=g;x=x+1)or=or-R[N]*R[pr+x],N=N+x;if(or=or/R[L],R[pr+u]=or,p[u]<O||or<0)break;H=!1,$=u}if(!H)for(gr=R[Y+$]/R[pr+$],u=1;u<=g&&!(p[u]<O||R[pr+u]<0);u=u+1)ir=R[Y+u]/R[pr+u],ir<gr&&(gr=ir,$=u);for(or=0,u=ar+1;u<=ar+v;u=u+1)or=or+R[u]*R[u];if(Math.abs(or)<=rr){if(H)return j[1]=1,999;for(u=1;u<=g;u=u+1)R[Y+u]=R[Y+u]-gr*R[pr+u];return R[Y+g+1]=R[Y+g+1]+gr,700}else{for(or=0,u=1;u<=v;u=u+1)or=or+R[ar+u]*d[u][D];for(_=-R[wr+D]/or,Z=!0,H||gr<_&&(_=gr,Z=!1),u=1;u<=v;u=u+1)M[u]=M[u]+_*R[ar+u],Math.abs(M[u])<rr&&(M[u]=0);for(m[1]=m[1]+_*or*(_/2+R[Y+g+1]),u=1;u<=g;u=u+1)R[Y+u]=R[Y+u]-_*R[pr+u];if(R[Y+g+1]=R[Y+g+1]+_,Z){for(g=g+1,p[g]=D,N=Mr+(g-1)*g/2+1,u=1;u<=g-1;u=u+1)R[N]=R[u],N=N+1;if(g===v)R[N]=R[v];else{for(u=v;u>=g+1&&!(R[u]===0||(w=Math.max(Math.abs(R[u-1]),Math.abs(R[u])),q=Math.min(Math.abs(R[u-1]),Math.abs(R[u])),R[u-1]>=0?ir=Math.abs(w*Math.sqrt(1+q*q/(w*w))):ir=-Math.abs(w*Math.sqrt(1+q*q/(w*w))),w=R[u-1]/ir,q=R[u]/ir,w===1));u=u-1)if(w===0)for(R[u-1]=q*ir,x=1;x<=v;x=x+1)ir=f[x][u-1],f[x][u-1]=f[x][u],f[x][u]=ir;else for(R[u-1]=ir,K=q/(1+w),x=1;x<=v;x=x+1)ir=w*f[x][u-1]+q*f[x][u],f[x][u]=K*(f[x][u-1]+ir)-f[x][u],f[x][u-1]=ir;R[N]=R[g]}}else{for(or=-y[D],x=1;x<=v;x=x+1)or=or+M[x]*d[x][D];if(D>O)R[wr+D]=or;else if(R[wr+D]=-Math.abs(or),or>0){for(x=1;x<=v;x=x+1)d[x][D]=-d[x][D];y[D]=-y[D]}return 700}}return 0}function cr(){if(N=Mr+$*($+1)/2+1,L=N+$,R[L]===0||(w=Math.max(Math.abs(R[L-1]),Math.abs(R[L])),q=Math.min(Math.abs(R[L-1]),Math.abs(R[L])),R[L-1]>=0?ir=Math.abs(w*Math.sqrt(1+q*q/(w*w))):ir=-Math.abs(w*Math.sqrt(1+q*q/(w*w))),w=R[L-1]/ir,q=R[L]/ir,w===1))return 798;if(w===0){for(u=$+1;u<=g;u=u+1)ir=R[L-1],R[L-1]=R[L],R[L]=ir,L=L+u;for(u=1;u<=v;u=u+1)ir=f[u][$],f[u][$]=f[u][$+1],f[u][$+1]=ir}else{for(K=q/(1+w),u=$+1;u<=g;u=u+1)ir=w*R[L-1]+q*R[L],R[L]=K*(R[L-1]+ir)-R[L],R[L-1]=ir,L=L+u;for(u=1;u<=v;u=u+1)ir=w*f[u][$]+q*f[u][$+1],f[u][$+1]=K*(f[u][$]+ir)-f[u][$+1],f[u][$]=ir}return 0}function ur(){for(L=N-$,u=1;u<=$;u=u+1)R[L]=R[N],N=N+1,L=L+1;return R[Y+$]=R[Y+$+1],p[$]=p[$+1],$=$+1,$<g?797:0}function c(){return R[Y+g]=R[Y+g+1],R[Y+g+1]=0,p[g]=0,g=g-1,F[2]=F[2]+1,0}for(z=0;;){if(z=J(),z===999)return;for(;z=nr(),z!==0;){if(z===999)return;if(z===700)if($===g)c();else{for(;cr(),z=ur(),z===797;);c()}}}}function s(f,h,l,v,M,m){f=n(f),h=n(h),l=n(l);var d,y,b,E,O,p=[],g=[],F=[],R=[],j=[],u;if(M=M||0,m=m?n(m):[void 0,0],v=v?n(v):[],y=f.length-1,b=l[1].length-1,!v)for(d=1;d<=b;d=d+1)v[d]=0;for(d=1;d<=b;d=d+1)g[d]=0;for(E=0,O=Math.min(y,b),d=1;d<=y;d=d+1)F[d]=0;for(p[1]=0,d=1;d<=2*y+O*(O+5)/2+2*b+1;d=d+1)R[d]=0;for(d=1;d<=2;d=d+1)j[d]=0;return t(f,h,y,y,F,p,l,v,y,b,M,g,E,j,R,m),u="",m[1]===1&&(u="constraints are inconsistent, no solution!"),m[1]===2&&(u="matrix D in quadratic function is not positive definite!"),{solution:e(F),value:e(p),unconstrained_solution:e(h),iterations:e(j),iact:e(g),message:u}}o.solveQP=s}(numeric),numeric.svd=function o(n){var e,r=numeric.epsilon,i=1e-64/r,a=50,t=0,s=0,f=0,h=0,l=0,v=numeric.clone(n),M=v.length,m=v[0].length;if(M<m)throw"Need more rows than columns";var d=new Array(m),y=new Array(m);for(s=0;s<m;s++)d[s]=y[s]=0;var b=numeric.rep([m,m],0);function E(G,$){return G=Math.abs(G),$=Math.abs($),G>$?G*Math.sqrt(1+$*$/G/G):$==0?G:$*Math.sqrt(1+G*G/$/$)}var O=0,p=0,g=0,F=0,R=0,j=0,u=0;for(s=0;s<m;s++){for(d[s]=p,u=0,l=s+1,f=s;f<M;f++)u+=v[f][s]*v[f][s];if(u<=i)p=0;else for(O=v[s][s],p=Math.sqrt(u),O>=0&&(p=-p),g=O*p-u,v[s][s]=O-p,f=l;f<m;f++){for(u=0,h=s;h<M;h++)u+=v[h][s]*v[h][f];for(O=u/g,h=s;h<M;h++)v[h][f]+=O*v[h][s]}for(y[s]=p,u=0,f=l;f<m;f++)u=u+v[s][f]*v[s][f];if(u<=i)p=0;else{for(O=v[s][s+1],p=Math.sqrt(u),O>=0&&(p=-p),g=O*p-u,v[s][s+1]=O-p,f=l;f<m;f++)d[f]=v[s][f]/g;for(f=l;f<M;f++){for(u=0,h=l;h<m;h++)u+=v[f][h]*v[s][h];for(h=l;h<m;h++)v[f][h]+=u*d[h]}}R=Math.abs(y[s])+Math.abs(d[s]),R>F&&(F=R)}for(s=m-1;s!=-1;s+=-1){if(p!=0){for(g=p*v[s][s+1],f=l;f<m;f++)b[f][s]=v[s][f]/g;for(f=l;f<m;f++){for(u=0,h=l;h<m;h++)u+=v[s][h]*b[h][f];for(h=l;h<m;h++)b[h][f]+=u*b[h][s]}}for(f=l;f<m;f++)b[s][f]=0,b[f][s]=0;b[s][s]=1,p=d[s],l=s}for(s=m-1;s!=-1;s+=-1){for(l=s+1,p=y[s],f=l;f<m;f++)v[s][f]=0;if(p!=0){for(g=v[s][s]*p,f=l;f<m;f++){for(u=0,h=l;h<M;h++)u+=v[h][s]*v[h][f];for(O=u/g,h=s;h<M;h++)v[h][f]+=O*v[h][s]}for(f=s;f<M;f++)v[f][s]=v[f][s]/p}else for(f=s;f<M;f++)v[f][s]=0;v[s][s]+=1}for(r=r*F,h=m-1;h!=-1;h+=-1)for(var x=0;x<a;x++){var N=!1;for(l=h;l!=-1;l+=-1){if(Math.abs(d[l])<=r){N=!0;break}if(Math.abs(y[l-1])<=r)break}if(!N){t=0,u=1;var L=l-1;for(s=l;s<h+1&&(O=u*d[s],d[s]=t*d[s],!(Math.abs(O)<=r));s++)for(p=y[s],g=E(O,p),y[s]=g,t=p/g,u=-O/g,f=0;f<M;f++)R=v[f][L],j=v[f][s],v[f][L]=R*t+j*u,v[f][s]=-R*u+j*t}if(j=y[h],l==h){if(j<0)for(y[h]=-j,f=0;f<m;f++)b[f][h]=-b[f][h];break}if(x>=a-1)throw"Error: no convergence.";for(F=y[l],R=y[h-1],p=d[h-1],g=d[h],O=((R-j)*(R+j)+(p-g)*(p+g))/(2*g*R),p=E(O,1),O<0?O=((F-j)*(F+j)+g*(R/(O-p)-g))/F:O=((F-j)*(F+j)+g*(R/(O+p)-g))/F,t=1,u=1,s=l+1;s<h+1;s++){for(p=d[s],R=y[s],g=u*p,p=t*p,j=E(O,g),d[s-1]=j,t=O/j,u=g/j,O=F*t+p*u,p=-F*u+p*t,g=R*u,R=R*t,f=0;f<m;f++)F=b[f][s-1],j=b[f][s],b[f][s-1]=F*t+j*u,b[f][s]=-F*u+j*t;for(j=E(O,g),y[s-1]=j,t=O/j,u=g/j,O=t*p+u*R,F=-u*p+t*R,f=0;f<M;f++)R=v[f][s-1],j=v[f][s],v[f][s-1]=R*t+j*u,v[f][s]=-R*u+j*t}d[l]=0,d[h]=O,y[h]=F}for(s=0;s<y.length;s++)y[s]<r&&(y[s]=0);for(s=0;s<m;s++)for(f=s-1;f>=0;f--)if(y[f]<y[s]){for(t=y[f],y[f]=y[s],y[s]=t,h=0;h<v.length;h++)e=v[h][s],v[h][s]=v[h][f],v[h][f]=e;for(h=0;h<b.length;h++)e=b[h][s],b[h][s]=b[h][f],b[h][f]=e;s=f}return{U:v,S:y,V:b}}})(numeric1_2_6);var numeric$1=numeric1_2_6,forwardSHT=function(o,n,e,r){var i=n.length,a=(o+1)*(o+1),t,s=[,];a>i&&console.log("The SHT degree is too high for the number of data points"),e==0&&(n=convertCart2Sph(n));for(var f=0;f<n.length;f++)s[f]=n[f][2];Y_N=computeRealSH(o,n),r==0?t=numeric$1.mul(1/i,Y_N):t=pinv_direct(numeric$1.transpose(Y_N));var h=numeric$1.dotMV(t,s);return h},convertCart2Sph=function(o,n){for(var e,r,i,a=new Array(o.length),t=0;t<o.length;t++)e=Math.atan2(o[t][1],o[t][0]),r=Math.atan2(o[t][2],Math.sqrt(o[t][0]*o[t][0]+o[t][1]*o[t][1])),n==1?a[t]=[e,r]:(i=Math.sqrt(o[t][0]*o[t][0]+o[t][1]*o[t][1]+o[t][2]*o[t][2]),a[t]=[e,r,i]);return a},convertSph2Cart=function(o){for(var n,e,r,i=new Array(o.length),a=0;a<o.length;a++)n=Math.cos(o[a][0])*Math.cos(o[a][1]),e=Math.sin(o[a][0])*Math.cos(o[a][1]),r=Math.sin(o[a][1]),o[0].length==2?i[a]=[n,e,r]:o[0].length==3&&(i[a]=[o[a][2]*n,o[a][2]*e,o[a][2]*r]);return i},computeRealSH=function(o,n){for(var e=new Array(n.length),r=new Array(n.length),i=0;i<n.length;i++)e[i]=n[i][0],r[i]=n[i][1];var a=new Array(2*o+1);e.length;for(var t=(o+1)*(o+1),s=0,f=0,h,l=numeric$1.sin(r),v=0,M=new Array(t),m,d,y,b,i=0;i<2*o+1;i++)a[i]=factorial(i);for(var E=0;E<o+1;E++){if(E==0){var O=new Array(e.length);O.fill(1),M[E]=O,v=1}else{h=recurseLegendrePoly(E,l,s,f),m=Math.sqrt(2*E+1);for(var p=0;p<E+1;p++)p==0?M[v+E]=numeric$1.mul(m,h[p]):(d=m*Math.sqrt(2*a[E-p]/a[E+p]),y=numeric$1.cos(numeric$1.mul(p,e)),b=numeric$1.sin(numeric$1.mul(p,e)),M[v+E-p]=numeric$1.mul(d,numeric$1.mul(h[p],b)),M[v+E+p]=numeric$1.mul(d,numeric$1.mul(h[p],y)));v=v+2*E+1}f=s,s=h}return M},factorial=function(o){return o===0?1:o*factorial(o-1)},recurseLegendrePoly=function(o,n,e,r){var i=new Array(o+1);switch(o){case 1:var l=numeric$1.mul(n,n),a=n,t=numeric$1.sqrt(numeric$1.sub(1,l));i[0]=a,i[1]=t;break;case 2:var l=numeric$1.mul(n,n),s=numeric$1.mul(3,l);s=numeric$1.sub(s,1),s=numeric$1.div(s,2);var f=numeric$1.sub(1,l);f=numeric$1.sqrt(f),f=numeric$1.mul(3,f),f=numeric$1.mul(f,n);var h=numeric$1.sub(1,l);h=numeric$1.mul(3,h),i[0]=s,i[1]=f,i[2]=h;break;default:var l=numeric$1.mul(n,n),v=numeric$1.sub(1,l),M=2*o-1,m=1;if(M%2==0)for(var d=1;d<M/2+1;d++)m=m*2*d;else for(var d=1;d<(M+1)/2+1;d++)m=m*(2*d-1);i[o]=numeric$1.mul(m,numeric$1.pow(v,o/2)),i[o-1]=numeric$1.mul(2*o-1,numeric$1.mul(n,e[o-1]));for(var y=0;y<o-1;y++){var b=numeric$1.mul(2*o-1,numeric$1.mul(n,e[y])),E=numeric$1.mul(o+y-1,r[y]);i[y]=numeric$1.div(numeric$1.sub(b,E),o-y)}}return i},pinv_direct=function(o){var n=numeric$1.transpose(o);return numeric$1.dot(numeric$1.inv(numeric$1.dot(n,o)),n)},getSHrotMtx=function(o,n){var e=(n+1)*(n+1),r=numeric$1.rep([e,e],0);r[0][0]=1;var i=numeric$1.rep([3,3],0);i[0][0]=o[1][1],i[0][1]=o[1][2],i[0][2]=o[1][0],i[1][0]=o[2][1],i[1][1]=o[2][2],i[1][2]=o[2][0],i[2][0]=o[0][1],i[2][1]=o[0][2],i[2][2]=o[0][0],r=numeric$1.setBlock(r,[1,1],[3,3],i);for(var a=i,t=3,s=2;s<n+1;s++){for(var f=numeric$1.rep([2*s+1,2*s+1],0),h=-s;h<s+1;h++)for(var l=-s;l<s+1;l++){var v,M,m,d,y;h==0?v=1:v=0,Math.abs(l)==s?M=2*s*(2*s-1):M=s*s-l*l,m=Math.sqrt((s*s-h*h)/M),d=Math.sqrt((1+v)*(s+Math.abs(h)-1)*(s+Math.abs(h))/M)*(1-2*v)*.5,y=Math.sqrt((s-Math.abs(h)-1)*(s-Math.abs(h))/M)*(1-v)*-.5,m!=0&&(m=m*U(s,h,l,i,a)),d!=0&&(d=d*V(s,h,l,i,a)),y!=0&&(y=y*W(s,h,l,i,a)),f[h+s][l+s]=m+d+y}r=numeric$1.setBlock(r,[t+1,t+1],[t+2*s+1,t+2*s+1],f),a=f,t=t+2*s+1}return r};function U(o,n,e,r,i){return P(0,o,n,e,r,i)}function V(o,n,e,r,i){var a,t,s,f;return n==0?(a=P(1,o,1,e,r,i),t=P(-1,o,-1,e,r,i),s=a+t):n>0?(n==1?f=1:f=0,a=P(1,o,n-1,e,r,i),t=P(-1,o,-n+1,e,r,i),s=a*Math.sqrt(1+f)-t*(1-f)):(n==-1?f=1:f=0,a=P(1,o,n+1,e,r,i),t=P(-1,o,-n-1,e,r,i),s=a*(1-f)+t*Math.sqrt(1+f)),s}function W(o,n,e,r,i){var a,t,s;return n==0?console.error("should not be called"):n>0?(a=P(1,o,n+1,e,r,i),t=P(-1,o,-n-1,e,r,i),s=a+t):(a=P(1,o,n-1,e,r,i),t=P(-1,o,-n+1,e,r,i),s=a-t),s}function P(o,n,e,r,i,a){var t,s,f,h;return t=i[o+1][2],s=i[o+1][0],f=i[o+1][1],r==-n?h=t*a[e+n-1][0]+s*a[e+n-1][2*n-2]:r==n?h=t*a[e+n-1][2*n-2]-s*a[e+n-1][0]:h=f*a[e+n-1][r+n-1],h}var yawPitchRoll2Rzyx=function(o,n,e){var r,i,a;e==0?r=[[1,0,0],[0,1,0],[0,0,1]]:r=[[1,0,0],[0,Math.cos(e),Math.sin(e)],[0,-Math.sin(e),Math.cos(e)]],n==0?i=[[1,0,0],[0,1,0],[0,0,1]]:i=[[Math.cos(n),0,-Math.sin(n)],[0,1,0],[Math.sin(n),0,Math.cos(n)]],o==0?a=[[1,0,0],[0,1,0],[0,0,1]]:a=[[Math.cos(o),Math.sin(o),0],[-Math.sin(o),Math.cos(o),0],[0,0,1]];var t=numeric$1.dotMMsmall(i,a);return t=numeric$1.dotMMsmall(r,t),t},forwardSHT_1=forwardSHT,convertCart2Sph_1=convertCart2Sph,convertSph2Cart_1=convertSph2Cart,computeRealSH_1=computeRealSH,factorial_1=factorial,recurseLegendrePoly_1=recurseLegendrePoly,getSHrotMtx_1=getSHrotMtx,yawPitchRoll2Rzyx_1=yawPitchRoll2Rzyx,ch1d=convexHull1d$1;function convexHull1d$1(o){for(var n=0,e=0,r=1;r<o.length;++r)o[r][0]<o[n][0]&&(n=r),o[r][0]>o[e][0]&&(e=r);return n<e?[[n],[e]]:n>e?[[e],[n]]:[[n]]}var orientation={exports:{}},twoProduct_1=twoProduct$1,SPLITTER=+(Math.pow(2,27)+1);function twoProduct$1(o,n,e){var r=o*n,i=SPLITTER*o,a=i-o,t=i-a,s=o-t,f=SPLITTER*n,h=f-n,l=f-h,v=n-l,M=r-t*l,m=M-s*l,d=m-t*v,y=s*v-d;return e?(e[0]=y,e[1]=r,e):[y,r]}var robustSum=linearExpansionSum;function scalarScalar$1(o,n){var e=o+n,r=e-o,i=e-r,a=n-r,t=o-i,s=t+a;return s?[s,e]:[e]}function linearExpansionSum(o,n){var e=o.length|0,r=n.length|0;if(e===1&&r===1)return scalarScalar$1(o[0],n[0]);var i=e+r,a=new Array(i),t=0,s=0,f=0,h=Math.abs,l=o[s],v=h(l),M=n[f],m=h(M),d,y;v<m?(y=l,s+=1,s<e&&(l=o[s],v=h(l))):(y=M,f+=1,f<r&&(M=n[f],m=h(M))),s<e&&v<m||f>=r?(d=l,s+=1,s<e&&(l=o[s],v=h(l))):(d=M,f+=1,f<r&&(M=n[f],m=h(M)));for(var b=d+y,E=b-d,O=y-E,p=O,g=b,F,R,j,u,x;s<e&&f<r;)v<m?(d=l,s+=1,s<e&&(l=o[s],v=h(l))):(d=M,f+=1,f<r&&(M=n[f],m=h(M))),y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F;for(;s<e;)d=l,y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F,s+=1,s<e&&(l=o[s]);for(;f<r;)d=M,y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F,f+=1,f<r&&(M=n[f]);return p&&(a[t++]=p),g&&(a[t++]=g),t||(a[t++]=0),a.length=t,a}var twoSum$1=fastTwoSum;function fastTwoSum(o,n,e){var r=o+n,i=r-o,a=r-i,t=n-i,s=o-a;return e?(e[0]=s+t,e[1]=r,e):[s+t,r]}var twoProduct=twoProduct_1,twoSum=twoSum$1,robustScale=scaleLinearExpansion;function scaleLinearExpansion(o,n){var e=o.length;if(e===1){var r=twoProduct(o[0],n);return r[0]?r:[r[1]]}var i=new Array(2*e),a=[.1,.1],t=[.1,.1],s=0;twoProduct(o[0],n,a),a[0]&&(i[s++]=a[0]);for(var f=1;f<e;++f){twoProduct(o[f],n,t);var h=a[1];twoSum(h,t[0],a),a[0]&&(i[s++]=a[0]);var l=t[1],v=a[1],M=l+v,m=M-l,d=v-m;a[1]=M,d&&(i[s++]=d)}return a[1]&&(i[s++]=a[1]),s===0&&(i[s++]=0),i.length=s,i}var robustDiff=robustSubtract;function scalarScalar(o,n){var e=o+n,r=e-o,i=e-r,a=n-r,t=o-i,s=t+a;return s?[s,e]:[e]}function robustSubtract(o,n){var e=o.length|0,r=n.length|0;if(e===1&&r===1)return scalarScalar(o[0],-n[0]);var i=e+r,a=new Array(i),t=0,s=0,f=0,h=Math.abs,l=o[s],v=h(l),M=-n[f],m=h(M),d,y;v<m?(y=l,s+=1,s<e&&(l=o[s],v=h(l))):(y=M,f+=1,f<r&&(M=-n[f],m=h(M))),s<e&&v<m||f>=r?(d=l,s+=1,s<e&&(l=o[s],v=h(l))):(d=M,f+=1,f<r&&(M=-n[f],m=h(M)));for(var b=d+y,E=b-d,O=y-E,p=O,g=b,F,R,j,u,x;s<e&&f<r;)v<m?(d=l,s+=1,s<e&&(l=o[s],v=h(l))):(d=M,f+=1,f<r&&(M=-n[f],m=h(M))),y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F;for(;s<e;)d=l,y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F,s+=1,s<e&&(l=o[s]);for(;f<r;)d=M,y=p,b=d+y,E=b-d,O=y-E,O&&(a[t++]=O),F=g+b,R=F-g,j=F-R,u=b-R,x=g-j,p=x+u,g=F,f+=1,f<r&&(M=-n[f]);return p&&(a[t++]=p),g&&(a[t++]=g),t||(a[t++]=0),a.length=t,a}(function(o){var n=twoProduct_1,e=robustSum,r=robustScale,i=robustDiff,a=5,t=11102230246251565e-32,s=(3+16*t)*t,f=(7+56*t)*t;function h(p,g,F,R){return function(u,x,N){var L=p(p(g(x[1],N[0]),g(-N[1],x[0])),p(g(u[1],x[0]),g(-x[1],u[0]))),G=p(g(u[1],N[0]),g(-N[1],u[0])),$=R(L,G);return $[$.length-1]}}function l(p,g,F,R){return function(u,x,N,L){var G=p(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),x[2]),p(F(p(g(x[1],L[0]),g(-L[1],x[0])),-N[2]),F(p(g(x[1],N[0]),g(-N[1],x[0])),L[2]))),p(F(p(g(x[1],L[0]),g(-L[1],x[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),L[2])))),$=p(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-N[2]),F(p(g(u[1],N[0]),g(-N[1],u[0])),L[2]))),p(F(p(g(x[1],N[0]),g(-N[1],x[0])),u[2]),p(F(p(g(u[1],N[0]),g(-N[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),N[2])))),ar=R(G,$);return ar[ar.length-1]}}function v(p,g,F,R){return function(u,x,N,L,G){var $=p(p(p(F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),N[2]),p(F(p(g(N[1],G[0]),g(-G[1],N[0])),-L[2]),F(p(g(N[1],L[0]),g(-L[1],N[0])),G[2]))),x[3]),p(F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),x[2]),p(F(p(g(x[1],G[0]),g(-G[1],x[0])),-L[2]),F(p(g(x[1],L[0]),g(-L[1],x[0])),G[2]))),-N[3]),F(p(F(p(g(N[1],G[0]),g(-G[1],N[0])),x[2]),p(F(p(g(x[1],G[0]),g(-G[1],x[0])),-N[2]),F(p(g(x[1],N[0]),g(-N[1],x[0])),G[2]))),L[3]))),p(F(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),x[2]),p(F(p(g(x[1],L[0]),g(-L[1],x[0])),-N[2]),F(p(g(x[1],N[0]),g(-N[1],x[0])),L[2]))),-G[3]),p(F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),x[2]),p(F(p(g(x[1],G[0]),g(-G[1],x[0])),-L[2]),F(p(g(x[1],L[0]),g(-L[1],x[0])),G[2]))),u[3]),F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-L[2]),F(p(g(u[1],L[0]),g(-L[1],u[0])),G[2]))),-x[3])))),p(p(F(p(F(p(g(x[1],G[0]),g(-G[1],x[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),G[2]))),L[3]),p(F(p(F(p(g(x[1],L[0]),g(-L[1],x[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),L[2]))),-G[3]),F(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),x[2]),p(F(p(g(x[1],L[0]),g(-L[1],x[0])),-N[2]),F(p(g(x[1],N[0]),g(-N[1],x[0])),L[2]))),u[3]))),p(F(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-N[2]),F(p(g(u[1],N[0]),g(-N[1],u[0])),L[2]))),-x[3]),p(F(p(F(p(g(x[1],L[0]),g(-L[1],x[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),L[2]))),N[3]),F(p(F(p(g(x[1],N[0]),g(-N[1],x[0])),u[2]),p(F(p(g(u[1],N[0]),g(-N[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),N[2]))),-L[3]))))),ar=p(p(p(F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),N[2]),p(F(p(g(N[1],G[0]),g(-G[1],N[0])),-L[2]),F(p(g(N[1],L[0]),g(-L[1],N[0])),G[2]))),u[3]),F(p(F(p(g(L[1],G[0]),g(-G[1],L[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-L[2]),F(p(g(u[1],L[0]),g(-L[1],u[0])),G[2]))),-N[3])),p(F(p(F(p(g(N[1],G[0]),g(-G[1],N[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-N[2]),F(p(g(u[1],N[0]),g(-N[1],u[0])),G[2]))),L[3]),F(p(F(p(g(N[1],L[0]),g(-L[1],N[0])),u[2]),p(F(p(g(u[1],L[0]),g(-L[1],u[0])),-N[2]),F(p(g(u[1],N[0]),g(-N[1],u[0])),L[2]))),-G[3]))),p(p(F(p(F(p(g(N[1],G[0]),g(-G[1],N[0])),x[2]),p(F(p(g(x[1],G[0]),g(-G[1],x[0])),-N[2]),F(p(g(x[1],N[0]),g(-N[1],x[0])),G[2]))),u[3]),F(p(F(p(g(N[1],G[0]),g(-G[1],N[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-N[2]),F(p(g(u[1],N[0]),g(-N[1],u[0])),G[2]))),-x[3])),p(F(p(F(p(g(x[1],G[0]),g(-G[1],x[0])),u[2]),p(F(p(g(u[1],G[0]),g(-G[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),G[2]))),N[3]),F(p(F(p(g(x[1],N[0]),g(-N[1],x[0])),u[2]),p(F(p(g(u[1],N[0]),g(-N[1],u[0])),-x[2]),F(p(g(u[1],x[0]),g(-x[1],u[0])),N[2]))),-G[3])))),pr=R($,ar);return pr[pr.length-1]}}function M(p){var g=p===3?h:p===4?l:v;return g(e,n,r,i)}var m=M(3),d=M(4),y=[function(){return 0},function(){return 0},function(g,F){return F[0]-g[0]},function(g,F,R){var j=(g[1]-R[1])*(F[0]-R[0]),u=(g[0]-R[0])*(F[1]-R[1]),x=j-u,N;if(j>0){if(u<=0)return x;N=j+u}else if(j<0){if(u>=0)return x;N=-(j+u)}else return x;var L=s*N;return x>=L||x<=-L?x:m(g,F,R)},function(g,F,R,j){var u=g[0]-j[0],x=F[0]-j[0],N=R[0]-j[0],L=g[1]-j[1],G=F[1]-j[1],$=R[1]-j[1],ar=g[2]-j[2],pr=F[2]-j[2],Mr=R[2]-j[2],wr=x*$,Y=N*G,D=N*L,I=u*$,tr=u*G,ir=x*L,or=ar*(wr-Y)+pr*(D-I)+Mr*(tr-ir),gr=(Math.abs(wr)+Math.abs(Y))*Math.abs(ar)+(Math.abs(D)+Math.abs(I))*Math.abs(pr)+(Math.abs(tr)+Math.abs(ir))*Math.abs(Mr),_=f*gr;return or>_||-or>_?or:d(g,F,R,j)}];function b(p){var g=y[p.length];return g||(g=y[p.length]=M(p.length)),g.apply(void 0,p)}function E(p,g,F,R,j,u,x){return function(L,G,$,ar,pr){switch(arguments.length){case 0:case 1:return 0;case 2:return R(L,G);case 3:return j(L,G,$);case 4:return u(L,G,$,ar);case 5:return x(L,G,$,ar,pr)}for(var Mr=new Array(arguments.length),wr=0;wr<arguments.length;++wr)Mr[wr]=arguments[wr];return p(Mr)}}function O(){for(;y.length<=a;)y.push(M(y.length));o.exports=E.apply(void 0,[b].concat(y));for(var p=0;p<=a;++p)o.exports[p]=y[p]}O()})(orientation);var orientationExports=orientation.exports,monotoneConvexHull2d=monotoneConvexHull2D,orient$2=orientationExports[3];function monotoneConvexHull2D(o){var n=o.length;if(n<3){for(var h=new Array(n),e=0;e<n;++e)h[e]=e;return n===2&&o[0][0]===o[1][0]&&o[0][1]===o[1][1]?[0]:h}for(var r=new Array(n),e=0;e<n;++e)r[e]=e;r.sort(function(m,d){var y=o[m][0]-o[d][0];return y||o[m][1]-o[d][1]});for(var i=[r[0],r[1]],a=[r[0],r[1]],e=2;e<n;++e){for(var t=r[e],s=o[t],f=i.length;f>1&&orient$2(o[i[f-2]],o[i[f-1]],s)<=0;)f-=1,i.pop();for(i.push(t),f=a.length;f>1&&orient$2(o[a[f-2]],o[a[f-1]],s)>=0;)f-=1,a.pop();a.push(t)}for(var h=new Array(a.length+i.length-2),l=0,e=0,v=i.length;e<v;++e)h[l++]=i[e];for(var M=a.length-2;M>0;--M)h[l++]=a[M];return h}var ch2d=convexHull2D,monotoneHull=monotoneConvexHull2d;function convexHull2D(o){var n=monotoneHull(o),e=n.length;if(e<=2)return[];for(var r=new Array(e),i=n[e-1],a=0;a<e;++a){var t=n[a];r[a]=[i,t],i=t}return r}var topology={},twiddle={},INT_BITS=32;twiddle.INT_BITS=INT_BITS,twiddle.INT_MAX=2147483647,twiddle.INT_MIN=-1<<INT_BITS-1,twiddle.sign=function(o){return(o>0)-(o<0)},twiddle.abs=function(o){var n=o>>INT_BITS-1;return(o^n)-n},twiddle.min=function(o,n){return n^(o^n)&-(o<n)},twiddle.max=function(o,n){return o^(o^n)&-(o<n)},twiddle.isPow2=function(o){return!(o&o-1)&&!!o},twiddle.log2=function(o){var n,e;return n=(o>65535)<<4,o>>>=n,e=(o>255)<<3,o>>>=e,n|=e,e=(o>15)<<2,o>>>=e,n|=e,e=(o>3)<<1,o>>>=e,n|=e,n|o>>1},twiddle.log10=function(o){return o>=1e9?9:o>=1e8?8:o>=1e7?7:o>=1e6?6:o>=1e5?5:o>=1e4?4:o>=1e3?3:o>=100?2:o>=10?1:0},twiddle.popCount=function(o){return o=o-(o>>>1&1431655765),o=(o&858993459)+(o>>>2&858993459),(o+(o>>>4)&252645135)*16843009>>>24};function countTrailingZeros(o){var n=32;return o&=-o,o&&n--,o&65535&&(n-=16),o&16711935&&(n-=8),o&252645135&&(n-=4),o&858993459&&(n-=2),o&1431655765&&(n-=1),n}twiddle.countTrailingZeros=countTrailingZeros,twiddle.nextPow2=function(o){return o+=o===0,--o,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,o|=o>>>16,o+1},twiddle.prevPow2=function(o){return o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,o|=o>>>16,o-(o>>>1)},twiddle.parity=function(o){return o^=o>>>16,o^=o>>>8,o^=o>>>4,o&=15,27030>>>o&1};var REVERSE_TABLE=new Array(256);(function(o){for(var n=0;n<256;++n){var e=n,r=n,i=7;for(e>>>=1;e;e>>>=1)r<<=1,r|=e&1,--i;o[n]=r<<i&255}})(REVERSE_TABLE),twiddle.reverse=function(o){return REVERSE_TABLE[o&255]<<24|REVERSE_TABLE[o>>>8&255]<<16|REVERSE_TABLE[o>>>16&255]<<8|REVERSE_TABLE[o>>>24&255]},twiddle.interleave2=function(o,n){return o&=65535,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,n&=65535,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,o|n<<1},twiddle.deinterleave2=function(o,n){return o=o>>>n&1431655765,o=(o|o>>>1)&858993459,o=(o|o>>>2)&252645135,o=(o|o>>>4)&16711935,o=(o|o>>>16)&65535,o<<16>>16},twiddle.interleave3=function(o,n,e){return o&=1023,o=(o|o<<16)&4278190335,o=(o|o<<8)&251719695,o=(o|o<<4)&3272356035,o=(o|o<<2)&1227133513,n&=1023,n=(n|n<<16)&4278190335,n=(n|n<<8)&251719695,n=(n|n<<4)&3272356035,n=(n|n<<2)&1227133513,o|=n<<1,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,o|e<<2},twiddle.deinterleave3=function(o,n){return o=o>>>n&1227133513,o=(o|o>>>2)&3272356035,o=(o|o>>>4)&251719695,o=(o|o>>>8)&4278190335,o=(o|o>>>16)&1023,o<<22>>22},twiddle.nextCombination=function(o){var n=o|o-1;return n+1|(~n&-~n)-1>>>countTrailingZeros(o)+1};var unionFind=UnionFind$1;function UnionFind$1(o){this.roots=new Array(o),this.ranks=new Array(o);for(var n=0;n<o;++n)this.roots[n]=n,this.ranks[n]=0}var proto$1=UnionFind$1.prototype;Object.defineProperty(proto$1,"length",{get:function(){return this.roots.length}}),proto$1.makeSet=function(){var o=this.roots.length;return this.roots.push(o),this.ranks.push(0),o},proto$1.find=function(o){for(var n=o,e=this.roots;e[o]!==o;)o=e[o];for(;e[n]!==o;){var r=e[n];e[n]=o,n=r}return o},proto$1.link=function(o,n){var e=this.find(o),r=this.find(n);if(e!==r){var i=this.ranks,a=this.roots,t=i[e],s=i[r];t<s?a[e]=r:s<t?a[r]=e:(a[r]=e,++i[e])}};var bits=twiddle,UnionFind=unionFind;function dimension(o){for(var n=0,e=Math.max,r=0,i=o.length;r<i;++r)n=e(n,o[r].length);return n-1}topology.dimension=dimension;function countVertices(o){for(var n=-1,e=Math.max,r=0,i=o.length;r<i;++r)for(var a=o[r],t=0,s=a.length;t<s;++t)n=e(n,a[t]);return n+1}topology.countVertices=countVertices;function cloneCells(o){for(var n=new Array(o.length),e=0,r=o.length;e<r;++e)n[e]=o[e].slice(0);return n}topology.cloneCells=cloneCells;function compareCells(o,n){var e=o.length,r=o.length-n.length,i=Math.min;if(r)return r;switch(e){case 0:return 0;case 1:return o[0]-n[0];case 2:var h=o[0]+o[1]-n[0]-n[1];return h||i(o[0],o[1])-i(n[0],n[1]);case 3:var a=o[0]+o[1],t=n[0]+n[1];if(h=a+o[2]-(t+n[2]),h)return h;var s=i(o[0],o[1]),f=i(n[0],n[1]),h=i(s,o[2])-i(f,n[2]);return h||i(s+o[2],a)-i(f+n[2],t);default:var l=o.slice(0);l.sort();var v=n.slice(0);v.sort();for(var M=0;M<e;++M)if(r=l[M]-v[M],r)return r;return 0}}topology.compareCells=compareCells;function compareZipped(o,n){return compareCells(o[0],n[0])}function normalize(o,n){if(n){for(var e=o.length,r=new Array(e),i=0;i<e;++i)r[i]=[o[i],n[i]];r.sort(compareZipped);for(var i=0;i<e;++i)o[i]=r[i][0],n[i]=r[i][1];return o}else return o.sort(compareCells),o}topology.normalize=normalize;function unique(o){if(o.length===0)return[];for(var n=1,e=o.length,r=1;r<e;++r){var i=o[r];if(compareCells(i,o[r-1])){if(r===n){n++;continue}o[n++]=i}}return o.length=n,o}topology.unique=unique;function findCell(o,n){for(var e=0,r=o.length-1,i=-1;e<=r;){var a=e+r>>1,t=compareCells(o[a],n);t<=0?(t===0&&(i=a),e=a+1):t>0&&(r=a-1)}return i}topology.findCell=findCell;function incidence(o,n){for(var e=new Array(o.length),r=0,i=e.length;r<i;++r)e[r]=[];for(var a=[],r=0,t=n.length;r<t;++r)for(var s=n[r],f=s.length,h=1,l=1<<f;h<l;++h){a.length=bits.popCount(h);for(var v=0,M=0;M<f;++M)h&1<<M&&(a[v++]=s[M]);var m=findCell(o,a);if(!(m<0))for(;e[m++].push(r),!(m>=o.length||compareCells(o[m],a)!==0););}return e}topology.incidence=incidence;function dual(o,n){if(!n)return incidence(unique(skeleton(o,0)),o);for(var e=new Array(n),r=0;r<n;++r)e[r]=[];for(var r=0,i=o.length;r<i;++r)for(var a=o[r],t=0,s=a.length;t<s;++t)e[a[t]].push(r);return e}topology.dual=dual;function explode(o){for(var n=[],e=0,r=o.length;e<r;++e)for(var i=o[e],a=i.length|0,t=1,s=1<<a;t<s;++t){for(var f=[],h=0;h<a;++h)t>>>h&1&&f.push(i[h]);n.push(f)}return normalize(n)}topology.explode=explode;function skeleton(o,n){if(n<0)return[];for(var e=[],r=(1<<n+1)-1,i=0;i<o.length;++i)for(var a=o[i],t=r;t<1<<a.length;t=bits.nextCombination(t)){for(var s=new Array(n+1),f=0,h=0;h<a.length;++h)t&1<<h&&(s[f++]=a[h]);e.push(s)}return normalize(e)}topology.skeleton=skeleton;function boundary(o){for(var n=[],e=0,r=o.length;e<r;++e)for(var i=o[e],a=0,t=i.length;a<t;++a){for(var s=new Array(i.length-1),f=0,h=0;f<t;++f)f!==a&&(s[h++]=i[f]);n.push(s)}return normalize(n)}topology.boundary=boundary;function connectedComponents_dense(o,n){for(var e=new UnionFind(n),r=0;r<o.length;++r)for(var i=o[r],a=0;a<i.length;++a)for(var t=a+1;t<i.length;++t)e.link(i[a],i[t]);for(var s=[],f=e.ranks,r=0;r<f.length;++r)f[r]=-1;for(var r=0;r<o.length;++r){var h=e.find(o[r][0]);f[h]<0?(f[h]=s.length,s.push([o[r].slice(0)])):s[f[h]].push(o[r].slice(0))}return s}function connectedComponents_sparse(o){for(var n=unique(normalize(skeleton(o,0))),e=new UnionFind(n.length),r=0;r<o.length;++r)for(var i=o[r],a=0;a<i.length;++a)for(var t=findCell(n,[i[a]]),s=a+1;s<i.length;++s)e.link(t,findCell(n,[i[s]]));for(var f=[],h=e.ranks,r=0;r<h.length;++r)h[r]=-1;for(var r=0;r<o.length;++r){var l=e.find(findCell(n,[o[r][0]]));h[l]<0?(h[l]=f.length,f.push([o[r].slice(0)])):f[h[l]].push(o[r].slice(0))}return f}function connectedComponents(o,n){return n?connectedComponents_dense(o,n):connectedComponents_sparse(o)}topology.connectedComponents=connectedComponents;var ich$1=incrementalConvexHull,orient$1=orientationExports,compareCell=topology.compareCells;function Simplex(o,n,e){this.vertices=o,this.adjacent=n,this.boundary=e,this.lastVisited=-1}Simplex.prototype.flip=function(){var o=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=o;var n=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=n};function GlueFacet(o,n,e){this.vertices=o,this.cell=n,this.index=e}function compareGlue(o,n){return compareCell(o.vertices,n.vertices)}function bakeOrient(o){for(var n=["function orient(){var tuple=this.tuple;return test("],e=0;e<=o;++e)e>0&&n.push(","),n.push("tuple[",e,"]");n.push(")}return orient");var r=new Function("test",n.join("")),i=orient$1[o+1];return i||(i=orient$1),r(i)}var BAKED=[];function Triangulation(o,n,e){this.dimension=o,this.vertices=n,this.simplices=e,this.interior=e.filter(function(a){return!a.boundary}),this.tuple=new Array(o+1);for(var r=0;r<=o;++r)this.tuple[r]=this.vertices[r];var i=BAKED[o];i||(i=BAKED[o]=bakeOrient(o)),this.orient=i}var proto=Triangulation.prototype;proto.handleBoundaryDegeneracy=function(o,n){var e=this.dimension,r=this.vertices.length-1,i=this.tuple,a=this.vertices,t=[o];for(o.lastVisited=-r;t.length>0;){o=t.pop(),o.vertices;for(var s=o.adjacent,f=0;f<=e;++f){var h=s[f];if(!(!h.boundary||h.lastVisited<=-r)){for(var l=h.vertices,v=0;v<=e;++v){var M=l[v];M<0?i[v]=n:i[v]=a[M]}var m=this.orient();if(m>0)return h;h.lastVisited=-r,m===0&&t.push(h)}}}return null},proto.walk=function(o,n){var e=this.vertices.length-1,r=this.dimension,i=this.vertices,a=this.tuple,t=n?this.interior.length*Math.random()|0:this.interior.length-1,s=this.interior[t];r:for(;!s.boundary;){for(var f=s.vertices,h=s.adjacent,l=0;l<=r;++l)a[l]=i[f[l]];s.lastVisited=e;for(var l=0;l<=r;++l){var v=h[l];if(!(v.lastVisited>=e)){var M=a[l];a[l]=o;var m=this.orient();if(a[l]=M,m<0){s=v;continue r}else v.boundary?v.lastVisited=-e:v.lastVisited=e}}return}return s},proto.addPeaks=function(o,n){var e=this.vertices.length-1,r=this.dimension,i=this.vertices,a=this.tuple,t=this.interior,s=this.simplices,f=[n];n.lastVisited=e,n.vertices[n.vertices.indexOf(-1)]=e,n.boundary=!1,t.push(n);for(var h=[];f.length>0;){var n=f.pop(),l=n.vertices,v=n.adjacent,M=l.indexOf(e);if(!(M<0)){for(var m=0;m<=r;++m)if(m!==M){var d=v[m];if(!(!d.boundary||d.lastVisited>=e)){var y=d.vertices;if(d.lastVisited!==-e){for(var b=0,E=0;E<=r;++E)y[E]<0?(b=E,a[E]=o):a[E]=i[y[E]];var O=this.orient();if(O>0){y[b]=e,d.boundary=!1,t.push(d),f.push(d),d.lastVisited=e;continue}else d.lastVisited=-e}var p=d.adjacent,g=l.slice(),F=v.slice(),R=new Simplex(g,F,!0);s.push(R);var j=p.indexOf(n);if(!(j<0)){p[j]=R,F[M]=d,g[m]=-1,F[m]=n,v[m]=R,R.flip();for(var E=0;E<=r;++E){var u=g[E];if(!(u<0||u===e)){for(var x=new Array(r-1),N=0,L=0;L<=r;++L){var G=g[L];G<0||L===E||(x[N++]=G)}h.push(new GlueFacet(x,R,E))}}}}}}}h.sort(compareGlue);for(var m=0;m+1<h.length;m+=2){var $=h[m],ar=h[m+1],pr=$.index,Mr=ar.index;pr<0||Mr<0||($.cell.adjacent[$.index]=ar.cell,ar.cell.adjacent[ar.index]=$.cell)}},proto.insert=function(o,n){var e=this.vertices;e.push(o);var r=this.walk(o,n);if(r){for(var i=this.dimension,a=this.tuple,t=0;t<=i;++t){var s=r.vertices[t];s<0?a[t]=o:a[t]=e[s]}var f=this.orient(a);f<0||f===0&&(r=this.handleBoundaryDegeneracy(r,o),!r)||this.addPeaks(o,r)}},proto.boundary=function(){for(var o=this.dimension,n=[],e=this.simplices,r=e.length,i=0;i<r;++i){var a=e[i];if(a.boundary){for(var t=new Array(o),s=a.vertices,f=0,h=0,l=0;l<=o;++l)s[l]>=0?t[f++]=s[l]:h=l&1;if(h===(o&1)){var v=t[0];t[0]=t[1],t[1]=v}n.push(t)}}return n};function incrementalConvexHull(o,n){var e=o.length;if(e===0)throw new Error("Must have at least d+1 points");var r=o[0].length;if(e<=r)throw new Error("Must input at least d+1 points");var i=o.slice(0,r+1),a=orient$1.apply(void 0,i);if(a===0)throw new Error("Input not in general position");for(var t=new Array(r+1),s=0;s<=r;++s)t[s]=s;a<0&&(t[0]=1,t[1]=0);for(var f=new Simplex(t,new Array(r+1),!1),h=f.adjacent,l=new Array(r+2),s=0;s<=r;++s){for(var v=t.slice(),M=0;M<=r;++M)M===s&&(v[M]=-1);var m=v[0];v[0]=v[1],v[1]=m;var d=new Simplex(v,new Array(r+1),!0);h[s]=d,l[s]=d}l[r+1]=f;for(var s=0;s<=r;++s)for(var v=h[s].vertices,y=h[s].adjacent,M=0;M<=r;++M){var b=v[M];if(b<0){y[M]=f;continue}for(var E=0;E<=r;++E)h[E].vertices.indexOf(b)<0&&(y[M]=h[E])}for(var O=new Triangulation(r,i,l),p=!!n,s=r+1;s<e;++s)O.insert(o[s],p);return O.boundary()}var aff$1=affineHull,orient=orientationExports;function linearlyIndependent(o,n){for(var e=new Array(n+1),r=0;r<o.length;++r)e[r]=o[r];for(var r=0;r<=o.length;++r){for(var i=o.length;i<=n;++i){for(var a=new Array(n),t=0;t<n;++t)a[t]=Math.pow(i+1-r,t);e[i]=a}var s=orient.apply(void 0,e);if(s)return!0}return!1}function affineHull(o){var n=o.length;if(n===0)return[];if(n===1)return[0];for(var e=o[0].length,r=[o[0]],i=[0],a=1;a<n;++a){if(r.push(o[a]),!linearlyIndependent(r,e)){r.pop();continue}if(i.push(a),i.length===e+1)return i}return i}var chnd=convexHullnD,ich=ich$1,aff=aff$1;function permute(o,n){for(var e=o.length,r=new Array(e),i=0;i<n.length;++i)r[i]=o[n[i]];for(var a=n.length,i=0;i<e;++i)n.indexOf(i)<0&&(r[a++]=o[i]);return r}function invPermute(o,n){for(var e=o.length,r=n.length,i=0;i<e;++i)for(var a=o[i],t=0;t<a.length;++t){var s=a[t];if(s<r)a[t]=n[s];else{s=s-r;for(var f=0;f<r;++f)s>=n[f]&&(s+=1);a[t]=s}}return o}function convexHullnD(o,n){try{return ich(o,!0)}catch{var e=aff(o);if(e.length<=n)return[];var r=permute(o,e),i=ich(r,!0);return invPermute(i,e)}}var convexHull1d=ch1d,convexHull2d=ch2d,convexHullnd=chnd,ch=convexHull;function convexHull(o){var n=o.length;if(n===0)return[];if(n===1)return[[0]];var e=o[0].length;return e===0?[]:e===1?convexHull1d(o):e===2?convexHull2d(o):convexHullnd(o,e)}const convexhull=getDefaultExportFromCjs(ch),numeric={mul:function(o,n){return Array.isArray(o)&&typeof n=="number"?o.map(e=>e*n):typeof o=="number"&&Array.isArray(n)?n.map(e=>o*e):Array.isArray(o)&&Array.isArray(n)?o.map((e,r)=>e*n[r]):o*n},div:function(o,n){return Array.isArray(o)?o.map(e=>e/n):o/n},sin:function(o){return o.map(n=>Math.sin(n))},cos:function(o){return o.map(n=>Math.cos(n))},pow:function(o,n){return o.map(e=>Math.pow(e,n))},sum:function(o){return o.reduce((n,e)=>n+e,0)},dotVV:function(o,n){let e=0;for(let r=0;r<o.length;r++)e+=o[r]*n[r];return e},sub:function(o,n){return Array.isArray(o)&&Array.isArray(n)?o.map((e,r)=>e-n[r]):o-n},round:function(o){return Array.isArray(o)?o.map(n=>Math.round(n)):Math.round(o)},mod:function(o,n){return Array.isArray(o)?o.map(e=>(e%n+n)%n):(o%n+n)%n},add:function(...o){if(o.length===0)return 0;let n=o[0];for(let e=1;e<o.length;e++){const r=o[e];Array.isArray(n)&&Array.isArray(r)?n=n.map((i,a)=>i+r[a]):Array.isArray(n)&&typeof r=="number"?n=n.map(i=>i+r):typeof n=="number"&&Array.isArray(r)?n=r.map(i=>i+n):n=n+r}return n},transpose:function(o){const n=o.length,e=o[0].length,r=new Array(e);for(let i=0;i<e;i++){r[i]=new Array(n);for(let a=0;a<n;a++)r[i][a]=o[a][i]}return r},dotMMsmall:function(o,n){const e=o.length,r=o[0].length,i=n[0].length,a=new Array(e);for(let t=0;t<e;t++){a[t]=new Array(i);for(let s=0;s<i;s++){let f=0;for(let h=0;h<r;h++)f+=o[t][h]*n[h][s];a[t][s]=f}}return a},inv:function(o){const n=o.length,e=new Array(n);for(let i=0;i<n;i++){e[i]=new Array(2*n);for(let a=0;a<n;a++)e[i][a]=o[i][a],e[i][a+n]=i===a?1:0}for(let i=0;i<n;i++){let a=i;for(let s=i+1;s<n;s++)Math.abs(e[s][i])>Math.abs(e[a][i])&&(a=s);if([e[i],e[a]]=[e[a],e[i]],Math.abs(e[i][i])<1e-10)throw new Error("Matrix is singular");const t=e[i][i];for(let s=0;s<2*n;s++)e[i][s]/=t;for(let s=0;s<n;s++)if(s!==i){const f=e[s][i];for(let h=0;h<2*n;h++)e[s][h]-=f*e[i][h]}}const r=new Array(n);for(let i=0;i<n;i++){r[i]=new Array(n);for(let a=0;a<n;a++)r[i][a]=e[i][a+n]}return r},identity:function(o){const n=new Array(o);for(let e=0;e<o;e++){n[e]=new Array(o);for(let r=0;r<o;r++)n[e][r]=e===r?1:0}return n},diag:function(o){const n=o.length,e=new Array(n);for(let r=0;r<n;r++){e[r]=new Array(n);for(let i=0;i<n;i++)e[r][i]=r===i?o[r]:0}return e},dot:function(o,n){if(!Array.isArray(o[0])&&!Array.isArray(n[0]))return numeric.dotVV(o,n);if(Array.isArray(o[0])&&!Array.isArray(n[0])){const t=o.length,s=o[0].length,f=new Array(t);for(let h=0;h<t;h++){let l=0;for(let v=0;v<s;v++)l+=o[h][v]*n[v];f[h]=l}return f}const e=o.length,r=o[0].length,i=n[0].length,a=new Array(e);for(let t=0;t<e;t++){a[t]=new Array(i);for(let s=0;s<i;s++){let f=0;for(let h=0;h<r;h++)f+=o[t][h]*n[h][s];a[t][s]=f}}return a}};function deg2rad(o){var n=[],e=Math.PI/180;for(let r=0;r<o.length;r++)o[0].length==3?n.push([o[r][0]*e,o[r][1]*e,o[r][2]]):o[0].length==2&&n.push([o[r][0]*e,o[r][1]*e]);return n}function rad2deg(o){var n=[],e=180/Math.PI;for(let r=0;r<o.length;r++)o[0].length==3?n.push([o[r][0]*e,o[r][1]*e,o[r][2]]):o[0].length==2&&n.push([o[r][0]*e,o[r][1]*e]);return n}function getColumn(o,n){return o.map(function(e){return e[n]})}function sampleCircle(o){for(var n=[],e=360/o,r=0,i=0;i<o;i++)n.push([r,0,1]),r+=e;return n}function getCircHarmonics(o,n){var e=o,r=2*e+1,i=n.length,a=new Array(r),t=new Array(i);n=numeric.mul(n,Math.PI/180),t.fill(1/Math.sqrt(2*Math.PI)),a[0]=t;for(var s=0;s<e;s++)a[2*s+1]=numeric.div(numeric.sin(numeric.mul(-(s+1),n)),Math.sqrt(Math.PI)),a[2*s+2]=numeric.div(numeric.cos(numeric.mul(s+1,n)),Math.sqrt(Math.PI));return a}function getAmbisonicDecMtx(o,n){var e=deg2rad(o),r=convertSph2Cart_1(e),i=convexhull(r),a=i.length,t=e.length,s=new Array(a);for(let d=0;d<a;d++){let y=new Array(3);for(let O=0;O<3;O++)y[O]=r[i[d][O]];let b=numeric.inv(y),E=[];for(let O=0;O<3;O++)for(let p=0;p<3;p++)E.push(b[p][O]);s[d]=E}var f=getTdesign(2*n),h=deg2rad(f),l=vbap3(h,i,s,t);l=numeric.transpose(l);var v=computeRealSH_1(n,h);v=numeric.transpose(v);var M=h.length,m=numeric.dotMMsmall(l,v);return m=numeric.mul(1/M,m),m}var vbap3=function(o,n,e,r){var i=o.length,a=r,t=n.length;function s(l){return Math.min.apply(null,l)}var f=new Array(i),h=convertSph2Cart_1(o);for(let l=0;l<i;l++){let v=h[l],M=new Array(a);M.fill(0);for(let y=0;y<t;y++){let b=[],E=[e[y][0],e[y][1],e[y][2]];if(b[0]=numeric.dotVV(E,v),E=[e[y][3],e[y][4],e[y][5]],b[1]=numeric.dotVV(E,v),E=[e[y][6],e[y][7],e[y][8]],b[2]=numeric.dotVV(E,v),s(b)>-.001){let O=Math.sqrt(numeric.sum(numeric.pow(b,2))),p=numeric.div(b,O);for(let g=0;g<3;g++)M[n[y][g]]=p[g];break}}let m=Math.sqrt(numeric.sum(numeric.pow(M,2))),d=numeric.div(M,m);f[l]=d}return f};function createNearestLookup(o,n){var e=o.length,r=convertSph2Cart_1(deg2rad(o)),i=Math.round(360/n[0])+1,a=Math.round(180/n[1])+1,t=new Array(i);t[0]=-180;for(let h=1;h<i;h++)t[h]=t[h-1]+n[0];var s=i*a,f=new Array(s);for(let h=0;h<s;h++){let l=[[h%i*n[0]-180,Math.floor(h/i)*n[1]-90]],v=convertSph2Cart_1(deg2rad(l)),M=1e3;for(let m=0;m<e;m++){let d=numeric.sum(numeric.pow(numeric.sub(v[0],r[m]),2));d<M&&(f[h]=m,M=d)}}return f}function findNearest(o,n,e){var r=o.length,i=[],a=[];for(let v=0;v<r;v++)i.push(o[v][0]+180),a.push(o[v][1]+90);var t=Math.round(360/e[0])+1,s=numeric.round(numeric.div(numeric.mod(i,360),e[0])),f=numeric.round(numeric.div(a,e[1])),h=numeric.add(numeric.mul(f,t),s,1),l=[];for(let v=0;v<r;v++)l.push(n[h[v]]);return l}function getTdesign(o){if(o>21)throw new Error("Designs of order greater than 21 are not implemented");if(o<1)throw new Error("Order should be at least 1");var n=[[[0,0,1],[180,0,1]],[[45,35.26,1],[-45,-35.26,1],[135,-35.26,1],[-135,35.26,1]],[[0,0,1],[180,0,1],[90,0,1],[-90,0,1],[0,90,1],[0,-90,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[-31.11,53.65,1],[110.82,30.5,1],[148.89,53.65,1],[32.21,-17.83,1],[69.18,-30.5,1],[-32.21,17.83,1],[-69.18,30.5,1],[-147.79,-17.83,1],[-110.82,-30.5,1],[147.79,17.83,1],[31.11,-53.65,1],[-148.89,-53.65,1],[-21.25,-47.78,1],[-108.2,38.78,1],[158.75,-47.78,1],[139.77,-14.09,1],[-71.8,-38.78,1],[-139.77,14.09,1],[71.8,38.78,1],[-40.23,-14.09,1],[108.2,-38.78,1],[40.23,14.09,1],[21.25,47.78,1],[-158.75,47.78,1],[106.65,-2.55,1],[-2.66,-16.63,1],[-73.35,-2.55,1],[-98.84,73.16,1],[-177.34,16.63,1],[98.84,-73.16,1],[177.34,-16.63,1],[81.16,73.16,1],[2.66,16.63,1],[-81.16,-73.16,1],[-106.65,2.55,1],[73.35,2.55,1]],[[20.75,-3.55,1],[-20.75,3.55,1],[-3.8,-20.7,1],[3.8,20.7,1],[159.25,3.55,1],[-159.25,-3.55,1],[-176.2,20.7,1],[176.2,-20.7,1],[93.8,20.7,1],[86.2,-20.7,1],[110.75,-3.55,1],[69.25,3.55,1],[-86.2,20.7,1],[-93.8,-20.7,1],[-69.25,-3.55,1],[-110.75,3.55,1],[-9.94,68.97,1],[170.06,68.97,1],[-99.94,68.97,1],[80.06,68.97,1],[9.94,-68.97,1],[-170.06,-68.97,1],[99.94,-68.97,1],[-80.06,-68.97,1],[42.15,17.57,1],[-42.15,-17.57,1],[23.12,-39.77,1],[-23.12,39.77,1],[137.85,-17.57,1],[-137.85,17.57,1],[156.88,39.77,1],[-156.88,-39.77,1],[66.88,39.77,1],[113.12,-39.77,1],[132.15,17.57,1],[47.85,-17.57,1],[-113.12,39.77,1],[-66.88,-39.77,1],[-47.85,17.57,1],[-132.15,-17.57,1],[25.26,44.98,1],[-154.74,44.98,1],[-64.74,44.98,1],[115.26,44.98,1],[-25.26,-44.98,1],[154.74,-44.98,1],[64.74,-44.98,1],[-115.26,-44.98,1]],[[144.09,-21.45,1],[-33.81,-48.92,1],[-35.91,-21.45,1],[-115.87,33.09,1],[-146.19,48.92,1],[115.87,-33.09,1],[146.19,-48.92,1],[64.13,33.09,1],[33.81,48.92,1],[-64.13,-33.09,1],[-144.09,21.45,1],[35.91,21.45,1],[-45.53,1.95,1],[177.26,44.44,1],[134.47,1.95,1],[87.21,-45.49,1],[2.74,-44.44,1],[-87.21,45.49,1],[-2.74,44.44,1],[-92.79,-45.49,1],[-177.26,-44.44,1],[92.79,45.49,1],[45.53,-1.95,1],[-134.47,-1.95,1],[15.59,-73.34,1],[-85.4,16.04,1],[-164.41,-73.34,1],[163.92,4.42,1],[-94.6,-16.04,1],[-163.92,-4.42,1],[94.6,16.04,1],[-16.08,4.42,1],[85.4,-16.04,1],[16.08,-4.42,1],[-15.59,73.34,1],[164.41,73.34,1],[-60.02,25.27,1],[151.41,26.86,1],[119.98,25.27,1],[46.63,-51.57,1],[28.59,-26.86,1],[-46.63,51.57,1],[-28.59,26.86,1],[-133.37,-51.57,1],[-151.41,-26.86,1],[133.37,51.57,1],[60.02,-25.27,1],[-119.98,-25.27,1],[-109.94,6.91,1],[172.65,-19.79,1],[70.06,6.91,1],[-70.44,-68.94,1],[7.35,19.79,1],[70.44,68.94,1],[-7.35,-19.79,1],[109.56,-68.94,1],[-172.65,19.79,1],[-109.56,68.94,1],[109.94,-6.91,1],[-70.06,-6.91,1]],[[132.93,7.69,1],[-83.93,-23.73,1],[8.47,23.51,1],[-113.34,70.42,1],[-103.27,-9.9,1],[-33.24,-70.75,1],[21.86,-26.46,1],[-156.54,47.78,1],[-64.26,-7.72,1],[165.78,44.53,1],[-25.2,26.39,1],[-97,-44.66,1],[27.85,9.77,1],[153.21,-47.71,1],[-155.06,7.45,1],[-11.84,-23.59,1],[80.54,23.72,1],[-42.06,70.44,1],[-31.22,-9.84,1],[38.84,-70.5,1],[93.76,-26.29,1],[-84.76,47.61,1],[7.76,-7.52,1],[-122.28,44.29,1],[46.8,26.64,1],[-24.77,-44.57,1],[99.89,9.91,1],[-134.78,-47.96,1],[-83.09,7.3,1],[60.13,-23.34,1],[152.64,23.64,1],[29.76,70.68,1],[40.78,-9.58,1],[110.18,-70.39,1],[165.65,-26.43,1],[-12.99,47.75,1],[79.74,-7.31,1],[-50.52,44.26,1],[118.92,26.71,1],[47.22,-44.31,1],[171.93,9.76,1],[-62.51,-48.04,1],[-11.12,7.44,1],[132.02,-23.33,1],[-135.36,23.39,1],[102.37,70.82,1],[112.74,-9.49,1],[-178.3,-70.58,1],[-122.32,-26.67,1],[59.08,48,1],[151.7,-7.38,1],[21.38,44.5,1],[-169.01,26.5,1],[118.98,-44.25,1],[-116.09,9.52,1],[9.65,-47.83,1],[60.89,7.68,1],[-156.02,-23.57,1],[-63.46,23.31,1],[174.93,70.66,1],[-175.29,-9.68,1],[-105.95,-70.8,1],[-50.19,-26.7,1],[131.36,48.01,1],[-136.3,-7.64,1],[93.56,44.67,1],[-97.08,26.3,1],[-169.16,-44.46,1],[-44.13,9.52,1],[81.48,-47.62,1]],[[-154.47,7.9,1],[162.15,-63.36,1],[25.53,7.9,1],[-81.26,-25.27,1],[17.85,63.36,1],[81.26,25.27,1],[-17.85,-63.36,1],[98.74,-25.27,1],[-162.15,63.36,1],[-98.74,25.27,1],[154.47,-7.9,1],[-25.53,-7.9,1],[1.3,-10.47,1],[-83.01,79.45,1],[-178.7,-10.47,1],[100.48,1.28,1],[-96.99,-79.45,1],[-100.48,-1.28,1],[96.99,79.45,1],[-79.52,1.28,1],[83.01,-79.45,1],[79.52,-1.28,1],[-1.3,10.47,1],[178.7,10.47,1],[157.24,13.15,1],[31.14,-63.89,1],[-22.76,13.15,1],[-75.78,22.13,1],[148.86,63.89,1],[75.78,-22.13,1],[-148.86,-63.89,1],[104.22,22.13,1],[-31.14,63.89,1],[-104.22,-22.13,1],[-157.24,-13.15,1],[22.76,-13.15,1],[110.44,-60.62,1],[-62.18,-9.87,1],[-69.56,-60.62,1],[-168.88,27.37,1],[-117.82,9.87,1],[168.88,-27.37,1],[117.82,-9.87,1],[11.12,27.37,1],[62.18,9.87,1],[-11.12,-27.37,1],[-110.44,60.62,1],[69.56,60.62,1],[-125.93,-47.4,1],[-126.67,-23.4,1],[54.07,-47.4,1],[-151.65,-33.24,1],[-53.33,23.4,1],[151.65,33.24,1],[53.33,-23.4,1],[28.35,-33.24,1],[126.67,23.4,1],[-28.35,33.24,1],[125.93,47.4,1],[-54.07,47.4,1],[61.41,37.54,1],[41.19,22.3,1],[-118.59,37.54,1],[31.92,44.13,1],[138.81,-22.3,1],[-31.92,-44.13,1],[-138.81,22.3,1],[-148.08,44.13,1],[-41.19,-22.3,1],[148.08,-44.13,1],[-61.41,-37.54,1],[118.59,-37.54,1],[132.92,4.73,1],[6.45,-42.74,1],[-47.08,4.73,1],[-83.07,46.87,1],[173.55,42.74,1],[83.07,-46.87,1],[-173.55,-42.74,1],[96.93,46.87,1],[-6.45,42.74,1],[-96.93,-46.87,1],[-132.92,-4.73,1],[47.08,-4.73,1]],[[-40.36,68.7,1],[61.12,65.68,1],[141.73,70.75,1],[-131.25,72.32,1],[-154.88,-12.62,1],[-66.2,-9.78,1],[26.36,-11.97,1],[114.95,-12.58,1],[37.02,51.13,1],[129.77,51.95,1],[-140.63,50.15,1],[-56.5,47.88,1],[-65.05,12.58,1],[25.12,12.62,1],[113.8,9.78,1],[-153.64,11.97,1],[-134.51,-9.73,1],[-46.23,-8.37,1],[47.91,-9.73,1],[141.51,-8.73,1],[-17.84,-44.1,1],[69.37,-43.27,1],[151.22,-42.67,1],[-106.78,-40.18,1],[-50.23,-51.95,1],[39.37,-50.15,1],[123.5,-47.88,1],[-142.98,-51.13,1],[-179.19,-60.75,1],[-84.57,-54.07,1],[5.39,-58.05,1],[89.5,-60.75,1],[-145.98,31.02,1],[-54.39,26.43,1],[28.92,32.51,1],[125.34,30.94,1],[168.71,-7.06,1],[-112.49,-10.38,1],[-21.96,-9.6,1],[73.11,-8.31,1],[95.68,.04,1],[-170.71,2.32,1],[-84.32,-.04,1],[9.29,-2.32,1],[9.19,-34.33,1],[98.21,-37.31,1],[-179.2,-40.48,1],[-77.81,-31.6,1],[-177.08,-21.74,1],[-93.77,-18.83,1],[-2.72,-19.8,1],[90.51,-20.91,1],[-106.89,8.31,1],[-11.29,7.06,1],[67.51,10.38,1],[158.04,9.6,1],[-118.88,-65.68,1],[-38.27,-70.75,1],[48.75,-72.32,1],[139.64,-68.7,1],[-54.66,-30.94,1],[34.02,-31.02,1],[125.61,-26.43,1],[-151.08,-32.51,1],[-170.81,34.33,1],[-81.79,37.31,1],[.8,40.48,1],[102.19,31.6,1],[-28.78,42.67,1],[73.22,40.18,1],[162.16,44.1,1],[-110.63,43.27,1],[-89.49,20.91,1],[2.92,21.74,1],[86.23,18.83,1],[177.28,19.8,1],[133.77,8.37,1],[-132.09,9.73,1],[-38.49,8.73,1],[45.49,9.73,1],[-25.6,24.04,1],[55.12,30.23,1],[149.3,28.05,1],[-118.71,26.06,1],[.81,60.75,1],[95.43,54.07,1],[-174.61,58.05,1],[-90.5,60.75,1],[-124.88,-30.23,1],[-30.7,-28.05,1],[61.29,-26.06,1],[154.4,-24.04,1],[-132.92,-85.6,1],[47.08,85.6,1]],[[-129.19,8.11,1],[169.58,-38.73,1],[50.81,8.12,1],[-77.27,-50.11,1],[10.42,38.73,1],[77.3,50.12,1],[-10.41,-38.72,1],[102.71,-50.11,1],[-169.57,38.72,1],[-102.71,50.11,1],[129.19,-8.11,1],[-50.8,-8.11,1],[-4.59,-56.01,1],[-93.1,33.85,1],[175.39,-56.03,1],[146.11,-2.57,1],[-86.89,-33.86,1],[-146.1,2.56,1],[86.91,33.86,1],[-33.89,-2.57,1],[93.1,-33.85,1],[33.9,2.58,1],[4.6,56.03,1],[-175.38,56.01,1],[106.57,26.1,1],[27.07,-14.82,1],[-73.44,26.09,1],[-30.2,59.41,1],[152.94,14.83,1],[30.2,-59.4,1],[-152.93,-14.84,1],[149.82,59.41,1],[-27.06,14.83,1],[-149.8,-59.42,1],[-106.55,-26.1,1],[73.44,-26.09,1],[-171.42,77.45,1],[91.9,-12.4,1],[8.54,77.46,1],[-12.4,-1.85,1],[88.11,12.41,1],[12.41,1.86,1],[-88.1,-12.41,1],[167.6,-1.86,1],[-91.89,12.4,1],[-167.59,1.84,1],[171.43,-77.46,1],[-8.52,-77.45,1],[-122.73,-10.44,1],[-167.65,-32.13,1],[57.27,-10.43,1],[-108.8,-55.83,1],[-12.35,32.13,1],[108.83,55.83,1],[12.36,-32.12,1],[71.19,-55.82,1],[167.66,32.12,1],[-71.19,55.82,1],[122.74,10.44,1],[-57.27,10.44,1],[-135.84,-23.05,1],[-148.58,-41.32,1],[44.16,-23.04,1],[-120.66,-39.88,1],[-31.41,41.31,1],[120.68,39.87,1],[31.42,-41.3,1],[59.33,-39.86,1],[148.6,41.31,1],[-59.33,39.87,1],[135.85,23.05,1],[-44.16,23.05,1],[-161.55,20.62,1],[130.04,-62.6,1],[18.45,20.64,1],[-68.35,-17.23,1],[49.96,62.61,1],[68.36,17.23,1],[-49.93,-62.6,1],[111.65,-17.22,1],[-130.05,62.59,1],[-111.64,17.22,1],[161.56,-20.63,1],[-18.44,-20.62,1],[-105.23,-3.38,1],[-176.5,-15.21,1],[74.77,-3.37,1],[-102.64,-74.41,1],[-3.5,15.21,1],[102.69,74.41,1],[3.51,-15.2,1],[77.33,-74.4,1],[176.51,15.2,1],[-77.36,74.4,1],[105.24,3.38,1],[-74.76,3.37,1],[-142.39,25.42,1],[142.08,-45.69,1],[37.61,25.43,1],[-59.02,-33.44,1],[37.92,45.69,1],[59.04,33.45,1],[-37.91,-45.68,1],[120.97,-33.44,1],[-142.07,45.68,1],[-120.96,33.44,1],[142.4,-25.43,1],[-37.6,-25.42,1]],[[-30.6,6.94,1],[166.56,58.69,1],[149.4,6.96,1],[81.95,-30.36,1],[13.48,-58.69,1],[-81.93,30.36,1],[-13.46,58.68,1],[-98.06,-30.37,1],[-166.54,-58.68,1],[98.07,30.37,1],[30.62,-6.95,1],[-149.38,-6.95,1],[106.69,-22.68,1],[-23.57,-15.36,1],[-73.31,-22.69,1],[-145.5,62.1,1],[-156.41,15.36,1],[145.53,-62.1,1],[156.43,-15.35,1],[34.47,62.11,1],[23.58,15.36,1],[-34.46,-62.11,1],[-106.67,22.68,1],[73.33,22.69,1],[166.82,1.39,1],[6.09,-76.74,1],[-13.19,1.38,1],[-88.57,13.18,1],[173.99,76.74,1],[88.59,-13.18,1],[-173.97,-76.73,1],[91.43,13.2,1],[-6.07,76.73,1],[-91.42,-13.2,1],[-166.8,-1.38,1],[13.2,-1.39,1],[-74.67,48.11,1],[130.86,10.16,1],[105.32,48.13,1],[13.34,-40.08,1],[49.16,-10.15,1],[-13.32,40.07,1],[-49.14,10.15,1],[-166.67,-40.08,1],[-130.84,-10.16,1],[166.69,40.08,1],[74.7,-48.11,1],[-105.31,-48.13,1],[-126.99,26.55,1],[147.96,-32.57,1],[53,26.56,1],[-50.28,-45.59,1],[32.05,32.58,1],[50.3,45.59,1],[-32.03,-32.58,1],[129.71,-45.58,1],[-147.94,32.57,1],[-129.69,45.58,1],[127.02,-26.55,1],[-52.98,-26.56,1],[-171.93,30.37,1],[103.47,-58.68,1],[8.07,30.36,1],[-59.38,-6.96,1],[76.54,58.69,1],[59.4,6.95,1],[-76.53,-58.69,1],[120.62,-6.94,1],[-103.44,58.68,1],[-120.6,6.95,1],[171.94,-30.36,1],[-8.05,-30.37,1],[40.86,10.16,1],[15.32,48.12,1],[-139.14,10.16,1],[76.68,40.09,1],[164.69,-48.12,1],[-76.67,-40.09,1],[-164.67,48.12,1],[-103.31,40.07,1],[-15.3,-48.13,1],[103.34,-40.07,1],[-40.84,-10.16,1],[139.16,-10.15,1],[103.2,-1.38,1],[-1.41,-13.19,1],[-76.8,-1.39,1],[-96.02,76.73,1],[-178.57,13.19,1],[96.07,-76.73,1],[178.58,-13.19,1],[83.94,76.74,1],[1.43,13.19,1],[-83.95,-76.74,1],[-103.18,1.38,1],[76.81,1.39,1],[37.02,-26.56,1],[-39.7,45.58,1],[-142.99,-26.56,1],[122.05,32.58,1],[-140.29,-45.59,1],[-122.04,-32.58,1],[140.31,45.59,1],[-57.95,32.57,1],[39.72,-45.58,1],[57.97,-32.57,1],[-37,26.55,1],[143,26.56,1],[163.33,22.69,1],[55.55,-62.1,1],[-16.67,22.68,1],[-66.41,15.35,1],[124.49,62.11,1],[66.43,-15.35,1],[-124.48,-62.11,1],[113.58,15.36,1],[-55.52,62.1,1],[-113.57,-15.36,1],[-163.31,-22.68,1],[16.69,-22.69,1]],[[-10.57,-17.35,1],[-120.42,69.76,1],[169.43,-17.35,1],[107.63,-10.08,1],[-59.57,-69.78,1],[-107.63,10.08,1],[59.57,69.78,1],[-72.37,-10.09,1],[120.42,-69.76,1],[72.37,10.09,1],[10.57,17.35,1],[-169.43,17.35,1],[-30.77,68.25,1],[101.53,18.57,1],[149.25,68.26,1],[18.92,-10.92,1],[78.47,-18.56,1],[-18.92,10.92,1],[-78.47,18.56,1],[-161.09,-10.92,1],[-101.53,-18.56,1],[161.09,10.92,1],[30.78,-68.26,1],[-149.26,-68.26,1],[56.46,41.26,1],[46.46,24.54,1],[-123.53,41.26,1],[32.19,38.8,1],[133.53,-24.53,1],[-32.19,-38.8,1],[-133.53,24.53,1],[-147.8,38.8,1],[-46.46,-24.54,1],[147.8,-38.8,1],[-56.46,-41.27,1],[123.53,-41.26,1],[84.74,27.31,1],[27.41,4.68,1],[-95.26,27.3,1],[10.06,62.23,1],[152.59,-4.67,1],[-10.06,-62.23,1],[-152.59,4.67,1],[-169.92,62.23,1],[-27.4,-4.68,1],[169.92,-62.22,1],[-84.74,-27.31,1],[95.26,-27.3,1],[136.27,-.73,1],[-1.05,-46.27,1],[-43.73,-.74,1],[-91.01,43.72,1],[-178.94,46.27,1],[91.01,-43.72,1],[178.94,-46.27,1],[88.99,43.73,1],[1.05,46.27,1],[-88.99,-43.73,1],[-136.27,.73,1],[43.73,.73,1],[55.23,10.82,1],[13.09,34.07,1],[-124.77,10.81,1],[71.48,53.8,1],[166.91,-34.06,1],[-71.48,-53.8,1],[-166.9,34.06,1],[-108.52,53.79,1],[-13.09,-34.06,1],[108.52,-53.79,1],[-55.23,-10.82,1],[124.77,-10.81,1],[-105.49,-68.13,1],[-111.15,-5.71,1],[74.52,-68.12,1],[-173.89,-21.04,1],[-68.85,5.7,1],[173.89,21.04,1],[68.85,-5.7,1],[6.12,-21.04,1],[111.15,5.71,1],[-6.12,21.04,1],[105.49,68.13,1],[-74.52,68.12,1],[35.28,-15.18,1],[-25.17,51.98,1],[-144.72,-15.19,1],[108.39,33.88,1],[-154.84,-51.99,1],[-108.39,-33.88,1],[154.84,51.99,1],[-71.61,33.87,1],[25.17,-51.98,1],[71.61,-33.87,1],[-35.28,15.18,1],[144.72,15.19,1],[-125.28,-28.56,1],[-146.32,-30.49,1],[54.72,-28.55,1],[-133.29,-45.82,1],[-33.69,30.48,1],[133.3,45.82,1],[33.68,-30.48,1],[46.71,-45.81,1],[146.32,30.49,1],[-46.71,45.81,1],[125.28,28.56,1],[-54.72,28.54,1],[-144.4,54.71,1],[112.38,-28.01,1],[35.58,54.72,1],[-29.92,-19.65,1],[67.62,28.02,1],[29.92,19.65,1],[-67.62,-28.02,1],[150.08,-19.64,1],[-112.38,28.01,1],[-150.08,19.64,1],[144.4,-54.71,1],[-35.58,-54.72,1],[68.53,-52.85,1],[-54.82,12.76,1],[-111.46,-52.87,1],[164.51,34.19,1],[-125.18,-12.77,1],[-164.51,-34.19,1],[125.18,12.77,1],[-15.5,34.19,1],[54.82,-12.76,1],[15.49,-34.19,1],[-68.53,52.85,1],[111.47,52.86,1],[91.48,-7.37,1],[-7.38,-1.47,1],[-88.52,-7.38,1],[-168.69,82.47,1],[-172.62,1.47,1],[168.69,-82.47,1],[172.62,-1.46,1],[11.22,82.48,1],[7.38,1.47,1],[-11.21,-82.48,1],[-91.48,7.37,1],[88.52,7.38,1]],[[-110.97,-81.34,1],[-98.09,-3.09,1],[69.03,-81.34,1],[-176.88,-8.08,1],[-81.91,3.09,1],[176.88,8.08,1],[81.91,-3.09,1],[3.12,-8.08,1],[98.09,3.09,1],[-3.12,8.08,1],[110.97,81.34,1],[-69.03,81.34,1],[145.76,30.52,1],[46.33,-45.41,1],[-34.24,30.52,1],[-54.51,28.99,1],[133.67,45.41,1],[54.51,-28.99,1],[-133.67,-45.41,1],[125.49,28.99,1],[-46.33,45.41,1],[-125.49,-28.99,1],[-145.76,-30.52,1],[34.24,-30.52,1],[159.58,41.4,1],[68.4,-44.67,1],[-20.42,41.4,1],[-46.75,15.18,1],[111.6,44.67,1],[46.75,-15.18,1],[-111.6,-44.67,1],[133.25,15.18,1],[-68.4,44.67,1],[-133.25,-15.18,1],[-159.58,-41.4,1],[20.42,-41.4,1],[85.43,-37.93,1],[-38.02,3.6,1],[-94.57,-37.93,1],[174.17,51.83,1],[-141.98,-3.6,1],[-174.17,-51.83,1],[141.98,3.6,1],[-5.83,51.83,1],[38.02,-3.6,1],[5.83,-51.83,1],[-85.43,37.93,1],[94.57,37.93,1],[21.18,27.17,1],[54.86,56.05,1],[-158.82,27.17,1],[61.17,18.75,1],[125.14,-56.05,1],[-61.17,-18.75,1],[-125.14,56.05,1],[-118.83,18.75,1],[-54.86,-56.05,1],[118.83,-18.75,1],[-21.18,-27.17,1],[158.82,-27.17,1],[104.66,-9.56,1],[-9.88,-14.45,1],[-75.34,-9.56,1],[-123.65,72.56,1],[-170.12,14.45,1],[123.65,-72.56,1],[170.12,-14.45,1],[56.35,72.56,1],[9.88,14.45,1],[-56.35,-72.56,1],[-104.66,9.56,1],[75.34,9.56,1],[25.94,-16.83,1],[-34.66,59.4,1],[-154.06,-16.83,1],[108.59,24.75,1],[-145.34,-59.41,1],[-108.59,-24.75,1],[145.34,59.41,1],[-71.41,24.75,1],[34.66,-59.41,1],[71.41,-24.75,1],[-25.94,16.83,1],[154.06,16.83,1],[-100.89,26.49,1],[153.1,-9.74,1],[79.11,26.49,1],[-20.77,-61.51,1],[26.9,9.74,1],[20.77,61.51,1],[-26.9,-9.74,1],[159.23,-61.51,1],[-153.1,9.74,1],[-159.23,61.51,1],[100.89,-26.49,1],[-79.11,-26.49,1],[44.31,12.28,1],[17.3,44.36,1],[-135.69,12.28,1],[73.08,43.05,1],[162.7,-44.36,1],[-73.08,-43.05,1],[-162.7,44.36,1],[-106.92,43.05,1],[-17.3,-44.36,1],[106.92,-43.05,1],[-44.31,-12.28,1],[135.69,-12.28,1],[-169.08,-24.53,1],[-112.54,-63.29,1],[10.92,-24.53,1],[-114.93,-9.92,1],[-67.46,63.28,1],[114.93,9.92,1],[67.46,-63.29,1],[65.07,-9.92,1],[112.54,63.29,1],[-65.07,9.92,1],[169.08,24.53,1],[-10.92,24.53,1],[93.2,-57.39,1],[-57.43,-1.73,1],[-86.8,-57.39,1],[-177.95,32.55,1],[-122.57,1.73,1],[177.95,-32.55,1],[122.57,-1.73,1],[2.05,32.55,1],[57.43,1.73,1],[-2.05,-32.55,1],[-93.2,57.39,1],[86.8,57.39,1],[-17.59,3.04,1],[170.04,72.16,1],[162.41,3.04,1],[86.81,-17.56,1],[9.96,-72.16,1],[-86.81,17.56,1],[-9.96,72.16,1],[-93.19,-17.56,1],[-170.04,-72.16,1],[93.19,17.56,1],[17.59,-3.04,1],[-162.41,-3.04,1],[39.38,44.26,1],[56.93,33.61,1],[-140.62,44.26,1],[38.42,27.03,1],[123.07,-33.61,1],[-38.42,-27.03,1],[-123.07,33.61,1],[-141.58,27.03,1],[-56.93,-33.61,1],[141.58,-27.03,1],[-39.38,-44.26,1],[140.62,-44.26,1]],[[165.52,26.52,1],[63.39,-60.04,1],[-14.48,26.52,1],[-62.74,12.93,1],[116.61,60.04,1],[62.74,-12.93,1],[-116.61,-60.04,1],[117.26,12.93,1],[-63.39,60.04,1],[-117.26,-12.93,1],[-165.52,-26.52,1],[14.48,-26.52,1],[-150.22,-21.62,1],[-141.41,-53.79,1],[29.78,-21.62,1],[-114.55,-27.5,1],[-38.59,53.79,1],[114.55,27.5,1],[38.59,-53.79,1],[65.45,-27.5,1],[141.41,53.79,1],[-65.45,27.5,1],[150.22,21.62,1],[-29.78,21.62,1],[-163.47,81.91,1],[92.31,-7.75,1],[16.53,81.91,1],[-7.76,-2.29,1],[87.69,7.75,1],[7.76,2.29,1],[-87.69,-7.75,1],[172.24,-2.29,1],[-92.31,7.75,1],[-172.24,2.29,1],[163.47,-81.91,1],[-16.53,-81.91,1],[-79.91,-73.49,1],[-106.27,2.85,1],[100.09,-73.49,1],[177.03,-16.24,1],[-73.73,-2.85,1],[-177.03,16.24,1],[73.73,2.85,1],[-2.97,-16.24,1],[106.27,-2.85,1],[2.97,16.24,1],[79.91,73.49,1],[-100.09,73.49,1],[-43.19,73.63,1],[101.37,11.86,1],[136.81,73.63,1],[12.09,-11.12,1],[78.63,-11.86,1],[-12.09,11.12,1],[-78.63,11.86,1],[-167.91,-11.12,1],[-101.37,-11.86,1],[167.91,11.12,1],[43.19,-73.63,1],[-136.81,-73.63,1],[109.86,-34.83,1],[-36.5,-16.19,1],[-70.14,-34.83,1],[-153.97,50.53,1],[-143.5,16.19,1],[153.97,-50.53,1],[143.5,-16.19,1],[26.03,50.53,1],[36.5,16.19,1],[-26.03,-50.53,1],[-109.86,34.83,1],[70.14,34.83,1],[-23.31,-6.54,1],[-163.84,65.83,1],[156.69,-6.54,1],[97.12,-23.15,1],[-16.16,-65.83,1],[-97.12,23.15,1],[16.16,65.83,1],[-82.88,-23.15,1],[163.84,-65.83,1],[82.88,23.15,1],[23.31,6.54,1],[-156.69,6.54,1],[-.87,-31.92,1],[-91.4,58.07,1],[179.13,-31.92,1],[121.93,-.74,1],[-88.6,-58.07,1],[-121.93,.74,1],[88.6,58.07,1],[-58.07,-.74,1],[91.4,-58.07,1],[58.07,.74,1],[.87,31.92,1],[-179.13,31.92,1],[163.12,43.35,1],[72.9,-44.1,1],[-16.88,43.35,1],[-45.39,12.19,1],[107.1,44.1,1],[45.39,-12.19,1],[-107.1,-44.1,1],[134.61,12.19,1],[-72.9,44.1,1],[-134.61,-12.19,1],[-163.12,-43.35,1],[16.88,-43.35,1],[-114.23,50.37,1],[127.06,-15.17,1],[65.77,50.37,1],[-18.77,-35.57,1],[52.94,15.17,1],[18.77,35.57,1],[-52.94,-15.17,1],[161.23,-35.57,1],[-127.06,15.17,1],[-161.23,35.57,1],[114.23,-50.37,1],[-65.77,-50.37,1],[54.17,30.16,1],[35.63,30.41,1],[-125.83,30.16,1],[45.21,44.51,1],[144.37,-30.41,1],[-45.21,-44.51,1],[-144.37,30.41,1],[-134.79,44.51,1],[-35.63,-30.41,1],[134.79,-44.51,1],[-54.17,-30.16,1],[125.83,-30.16,1],[126.2,41.73,1],[47.86,-26.15,1],[-53.8,41.73,1],[-33.51,37.03,1],[132.14,26.15,1],[33.51,-37.03,1],[-132.14,-26.15,1],[146.49,37.03,1],[-47.86,26.15,1],[-146.49,-37.03,1],[-126.2,-41.73,1],[53.8,-41.73,1],[-161.75,20.38,1],[130.12,-62.91,1],[18.25,20.38,1],[-68.63,-17.07,1],[49.88,62.91,1],[68.63,17.07,1],[-49.88,-62.91,1],[111.37,-17.07,1],[-130.12,62.91,1],[-111.37,17.07,1],[161.75,-20.38,1],[-18.25,-20.38,1],[2.71,48.49,1],[87.6,41.45,1],[-177.29,48.49,1],[41.48,1.8,1],[92.4,-41.45,1],[-41.48,-1.8,1],[-92.4,41.45,1],[-138.52,1.8,1],[-87.6,-41.45,1],[138.52,-1.8,1],[-2.71,-48.49,1],[177.29,-48.49,1],[-98.15,-27.54,1],[-152.22,-7.22,1],[81.85,-27.54,1],[-164.79,-61.37,1],[-27.78,7.22,1],[164.79,61.37,1],[27.78,-7.22,1],[15.21,-61.37,1],[152.22,7.22,1],[-15.21,61.37,1],[98.15,27.54,1],[-81.85,27.54,1]],[[-40.48,43.36,1],[124.51,33.58,1],[139.52,43.36,1],[38.85,-28.17,1],[55.49,-33.58,1],[-38.85,28.17,1],[-55.49,33.58,1],[-141.15,-28.17,1],[-124.51,-33.58,1],[141.15,28.17,1],[40.48,-43.36,1],[-139.52,-43.36,1],[56.01,17.18,1],[20.46,32.29,1],[-123.99,17.18,1],[61.05,52.38,1],[159.54,-32.29,1],[-61.05,-52.38,1],[-159.54,32.29,1],[-118.95,52.38,1],[-20.46,-32.29,1],[118.95,-52.38,1],[-56.01,-17.18,1],[123.99,-17.18,1],[-179.51,-8.95,1],[-93.08,-81.04,1],[.49,-8.95,1],[-98.95,-.48,1],[-86.92,81.04,1],[98.95,.48,1],[86.92,-81.04,1],[81.05,-.48,1],[93.08,81.04,1],[-81.05,.48,1],[179.51,8.95,1],[-.49,8.95,1],[12.04,-13.56,1],[-49.15,71.95,1],[-167.96,-13.56,1],[103.85,11.7,1],[-130.85,-71.95,1],[-103.85,-11.7,1],[130.85,71.95,1],[-76.15,11.7,1],[49.15,-71.95,1],[76.15,-11.7,1],[-12.04,13.56,1],[167.96,13.56,1],[-13.62,-58.2,1],[-98.3,30.8,1],[166.38,-58.2,1],[148.93,-7.13,1],[-81.7,-30.8,1],[-148.93,7.13,1],[81.7,30.8,1],[-31.07,-7.13,1],[98.3,-30.8,1],[31.07,7.13,1],[13.62,58.2,1],[-166.38,58.2,1],[65.26,-20.55,1],[-22.43,23.07,1],[-114.74,-20.55,1],[131.85,58.26,1],[-157.57,-23.07,1],[-131.85,-58.26,1],[157.57,23.07,1],[-48.15,58.26,1],[22.43,-23.07,1],[48.15,-58.26,1],[-65.26,20.55,1],[114.74,20.55,1],[-135.39,26.5,1],[144.63,-39.58,1],[44.61,26.5,1],[-55,-38.94,1],[35.37,39.58,1],[55,38.94,1],[-35.37,-39.58,1],[125,-38.94,1],[-144.63,39.58,1],[-125,38.94,1],[135.39,-26.5,1],[-44.61,-26.5,1],[114.95,-4.75,1],[-5.23,-24.86,1],[-65.05,-4.75,1],[-101.14,64.63,1],[-174.77,24.86,1],[101.14,-64.63,1],[174.77,-24.86,1],[78.86,64.63,1],[5.23,24.86,1],[-78.86,-64.63,1],[-114.95,4.75,1],[65.05,4.75,1],[35.85,52.64,1],[65.91,29.46,1],[-144.15,52.64,1],[31.75,20.82,1],[114.09,-29.46,1],[-31.75,-20.82,1],[-114.09,29.46,1],[-148.25,20.82,1],[-65.91,-29.46,1],[148.25,-20.82,1],[-35.85,-52.64,1],[144.15,-52.64,1],[86.45,11.52,1],[11.54,3.48,1],[-93.55,11.52,1],[16.9,77.95,1],[168.46,-3.48,1],[-16.9,-77.95,1],[-168.46,3.48,1],[-163.1,77.95,1],[-11.54,-3.48,1],[163.1,-77.95,1],[-86.45,-11.52,1],[93.55,-11.52,1],[135.24,4.02,1],[5.69,-45.1,1],[-44.76,4.02,1],[-84.35,44.62,1],[174.31,45.1,1],[84.35,-44.62,1],[-174.31,-45.1,1],[95.65,44.62,1],[-5.69,45.1,1],[-95.65,-44.62,1],[-135.24,-4.02,1],[44.76,-4.02,1],[-129.84,-18.16,1],[-156.86,-37.5,1],[50.16,-18.16,1],[-117.12,-46.85,1],[-23.14,37.5,1],[117.12,46.85,1],[23.14,-37.5,1],[62.88,-46.85,1],[156.86,37.5,1],[-62.88,46.85,1],[129.84,18.16,1],[-50.16,18.16,1],[-74.1,32.87,1],[146.1,13.3,1],[105.9,32.87,1],[22.97,-53.88,1],[33.9,-13.3,1],[-22.97,53.88,1],[-33.9,13.3,1],[-157.03,-53.88,1],[-146.1,-13.3,1],[157.03,53.88,1],[74.1,-32.87,1],[-105.9,-32.87,1],[-119.92,-5.64,1],[-173.5,-29.76,1],[60.08,-5.64,1],[-101.2,-59.6,1],[-6.5,29.76,1],[101.2,59.6,1],[6.5,-29.76,1],[78.8,-59.6,1],[173.5,29.76,1],[-78.8,59.6,1],[119.92,5.64,1],[-60.08,5.64,1],[73.14,16.13,1],[16.82,16.18,1],[-106.86,16.13,1],[45.09,66.83,1],[163.18,-16.18,1],[-45.09,-66.83,1],[-163.18,16.18,1],[-134.91,66.83,1],[-16.82,-16.18,1],[134.91,-66.83,1],[-73.14,-16.13,1],[106.86,-16.13,1],[-11.7,-43.38,1],[-102.11,45.38,1],[168.3,-43.38,1],[133.98,-8.47,1],[-77.89,-45.38,1],[-133.98,8.47,1],[77.89,45.38,1],[-46.02,-8.47,1],[102.11,-45.38,1],[46.02,8.47,1],[11.7,43.38,1],[-168.3,43.38,1],[-24.11,3.73,1],[170.94,65.63,1],[155.89,3.73,1],[85.92,-24.05,1],[9.06,-65.63,1],[-85.92,24.05,1],[-9.06,65.63,1],[-94.08,-24.05,1],[-170.94,-65.63,1],[94.08,24.05,1],[24.11,-3.73,1],[-155.89,-3.73,1]],[[104.6,-3.68,1],[-3.81,-14.57,1],[-75.4,-3.68,1],[-104.32,74.95,1],[-176.19,14.57,1],[104.32,-74.95,1],[176.19,-14.57,1],[75.68,74.95,1],[3.81,14.57,1],[-75.68,-74.95,1],[-104.6,3.68,1],[75.4,3.68,1],[153.77,-30.33,1],[-52.93,-50.74,1],[-26.23,-30.33,1],[-123.11,22.43,1],[-127.07,50.74,1],[123.11,-22.43,1],[127.07,-50.74,1],[56.89,22.43,1],[52.93,50.74,1],[-56.89,-22.43,1],[-153.77,30.33,1],[26.23,30.33,1],[35.99,-39.77,1],[-54.77,38.45,1],[-144.01,-39.77,1],[135.81,26.85,1],[-125.23,-38.45,1],[-135.81,-26.85,1],[125.23,38.45,1],[-44.19,26.85,1],[54.77,-38.45,1],[44.19,-26.85,1],[-35.99,39.77,1],[144.01,39.77,1],[71.82,-25.43,1],[-26.58,16.37,1],[-108.18,-25.43,1],[146.72,59.1,1],[-153.42,-16.37,1],[-146.72,-59.1,1],[153.42,16.37,1],[-33.28,59.1,1],[26.58,-16.37,1],[33.28,-59.1,1],[-71.82,25.43,1],[108.18,25.43,1],[-136.55,26.52,1],[144.03,-40.51,1],[43.45,26.52,1],[-55.5,-37.97,1],[35.97,40.51,1],[55.5,37.97,1],[-35.97,-40.51,1],[124.5,-37.97,1],[-144.03,40.51,1],[-124.5,37.97,1],[136.55,-26.52,1],[-43.45,-26.52,1],[-6.52,-1.08,1],[-170.58,83.4,1],[173.48,-1.08,1],[91.09,-6.52,1],[-9.42,-83.4,1],[-91.09,6.52,1],[9.42,83.4,1],[-88.91,-6.52,1],[170.58,-83.4,1],[88.91,6.52,1],[6.52,1.08,1],[-173.48,1.08,1],[-71.13,40.38,1],[138.05,14.26,1],[108.87,40.38,1],[20.82,-46.12,1],[41.95,-14.26,1],[-20.82,46.12,1],[-41.95,14.26,1],[-159.18,-46.12,1],[-138.05,-14.26,1],[159.18,46.12,1],[71.13,-40.38,1],[-108.87,-40.38,1],[-153.97,-27.97,1],[-129.57,-52.52,1],[26.03,-27.97,1],[-120.59,-22.81,1],[-50.43,52.52,1],[120.59,22.81,1],[50.43,-52.52,1],[59.41,-22.81,1],[129.57,52.52,1],[-59.41,22.81,1],[153.97,27.97,1],[-26.03,27.97,1],[-80.23,13.48,1],[166.33,9.49,1],[99.77,13.48,1],[35.29,-73.41,1],[13.67,-9.49,1],[-35.29,73.41,1],[-13.67,9.49,1],[-144.71,-73.41,1],[-166.33,-9.49,1],[144.71,73.41,1],[80.23,-13.48,1],[-99.77,-13.48,1],[55.43,-9,1],[-10.89,34.09,1],[-124.57,-9,1],[105.6,54.41,1],[-169.11,-34.09,1],[-105.6,-54.41,1],[169.11,34.09,1],[-74.4,54.41,1],[10.89,-34.09,1],[74.4,-54.41,1],[-55.43,9,1],[124.57,9,1],[68.32,-7.14,1],[-7.68,21.51,1],[-111.68,-7.14,1],[108.74,67.22,1],[-172.32,-21.51,1],[-108.74,-67.22,1],[172.32,21.51,1],[-71.26,67.22,1],[7.68,-21.51,1],[71.26,-67.22,1],[-68.32,7.14,1],[111.68,7.14,1],[-174.97,36.12,1],[96.85,-53.58,1],[5.03,36.12,1],[-53.77,-4.06,1],[83.15,53.58,1],[53.77,4.06,1],[-83.15,-53.58,1],[126.23,-4.06,1],[-96.85,53.58,1],[-126.23,4.06,1],[174.97,-36.12,1],[-5.03,-36.12,1],[-149.91,16.26,1],[149.81,-56.16,1],[30.09,16.26,1],[-71.37,-28.77,1],[30.19,56.16,1],[71.37,28.77,1],[-30.19,-56.16,1],[108.63,-28.77,1],[-149.81,56.16,1],[-108.63,28.77,1],[149.91,-16.26,1],[-30.09,-16.26,1],[2.52,-51.45,1],[-87.99,38.5,1],[-177.48,-51.45,1],[141.48,1.57,1],[-92.01,-38.5,1],[-141.48,-1.57,1],[92.01,38.5,1],[-38.52,1.57,1],[87.99,-38.5,1],[38.52,-1.57,1],[-2.52,51.45,1],[177.48,51.45,1],[161.12,-9.98,1],[-28.54,-68.73,1],[-18.88,-9.98,1],[-100.54,18.59,1],[-151.46,68.73,1],[100.54,-18.59,1],[151.46,-68.73,1],[79.46,18.59,1],[28.54,68.73,1],[-79.46,-18.59,1],[-161.12,9.98,1],[18.88,9.98,1],[12.84,24.97,1],[64.49,62.11,1],[-167.16,24.97,1],[64.47,11.62,1],[115.51,-62.11,1],[-64.47,-11.62,1],[-115.51,62.11,1],[-115.53,11.62,1],[-64.49,-62.11,1],[115.53,-11.62,1],[-12.84,-24.97,1],[167.16,-24.97,1],[74.13,41.65,1],[42.76,11.79,1],[-105.87,41.65,1],[17.09,45.95,1],[137.24,-11.79,1],[-17.09,-45.95,1],[-137.24,11.79,1],[-162.91,45.95,1],[-42.76,-11.79,1],[162.91,-45.95,1],[-74.13,-41.65,1],[105.87,-41.65,1],[154.04,1.27,1],[2.9,-64.01,1],[-25.96,1.27,1],[-88.59,25.96,1],[177.1,64.01,1],[88.59,-25.96,1],[-177.1,-64.01,1],[91.41,25.96,1],[-2.9,64.01,1],[-91.41,-25.96,1],[-154.04,-1.27,1],[25.96,-1.27,1]],[[24.8,-10.46,1],[-23.76,63.21,1],[-155.2,-10.46,1],[101.5,24.36,1],[-156.24,-63.21,1],[-101.5,-24.36,1],[156.24,63.21,1],[-78.5,24.36,1],[23.76,-63.21,1],[78.5,-24.36,1],[-24.8,10.46,1],[155.2,10.46,1],[-134.64,65.44,1],[108.01,-16.98,1],[45.36,65.44,1],[-17.8,-17.2,1],[71.99,16.98,1],[17.8,17.2,1],[-71.99,-16.98,1],[162.2,-17.2,1],[-108.01,16.98,1],[-162.2,17.2,1],[134.64,-65.44,1],[-45.36,-65.44,1],[177.6,54.85,1],[88.31,-35.12,1],[-2.4,54.85,1],[-35.13,1.38,1],[91.69,35.12,1],[35.13,-1.38,1],[-91.69,-35.12,1],[144.87,1.38,1],[-88.31,35.12,1],[-144.87,-1.38,1],[-177.6,-54.85,1],[2.4,-54.85,1],[157.93,82.01,1],[86.98,-7.4,1],[-22.07,82.01,1],[-7.41,2.99,1],[93.02,7.4,1],[7.41,-2.99,1],[-93.02,-7.4,1],[172.59,2.99,1],[-86.98,7.4,1],[-172.59,-2.99,1],[-157.93,-82.01,1],[22.07,-82.01,1],[42.48,-13.21,1],[-19.17,45.89,1],[-137.52,-13.21,1],[107.66,41.11,1],[-160.83,-45.89,1],[-107.66,-41.11,1],[160.83,45.89,1],[-72.34,41.11,1],[19.17,-45.89,1],[72.34,-41.11,1],[-42.48,13.21,1],[137.52,13.21,1],[28.48,10.9,1],[21.99,59.68,1],[-151.52,10.9,1],[77.65,27.92,1],[158.01,-59.68,1],[-77.65,-27.92,1],[-158.01,59.68,1],[-102.35,27.92,1],[-21.99,-59.68,1],[102.35,-27.92,1],[-28.48,-10.9,1],[151.52,-10.9,1],[-33.79,21.61,1],[144.53,50.59,1],[146.21,21.61,1],[64.51,-31.14,1],[35.47,-50.59,1],[-64.51,31.14,1],[-35.47,50.59,1],[-115.49,-31.14,1],[-144.53,-50.59,1],[115.49,31.14,1],[33.79,-21.61,1],[-146.21,-21.61,1],[-175.53,-31.74,1],[-97.19,-57.98,1],[4.47,-31.74,1],[-121.82,-3.8,1],[-82.81,57.98,1],[121.82,3.8,1],[82.81,-57.98,1],[58.18,-3.8,1],[97.19,57.98,1],[-58.18,3.8,1],[175.53,31.74,1],[-4.47,31.74,1],[89.4,19.43,1],[19.43,.56,1],[-90.6,19.43,1],[1.69,70.56,1],[160.57,-.56,1],[-1.69,-70.56,1],[-160.57,.56,1],[-178.31,70.56,1],[-19.43,-.56,1],[178.31,-70.56,1],[-89.4,-19.43,1],[90.6,-19.43,1],[-27.28,-27.88,1],[-130.91,51.78,1],[152.72,-27.88,1],[120.76,-23.9,1],[-49.09,-51.78,1],[-120.76,23.9,1],[49.09,51.78,1],[-59.24,-23.9,1],[130.91,-51.78,1],[59.24,23.9,1],[27.28,27.88,1],[-152.72,27.88,1],[139.9,-15.44,1],[-23.21,-47.5,1],[-40.1,-15.44,1],[-109.85,38.38,1],[-156.79,47.5,1],[109.85,-38.38,1],[156.79,-47.5,1],[70.15,38.38,1],[23.21,47.5,1],[-70.15,-38.38,1],[-139.9,15.44,1],[40.1,15.44,1],[-2.17,-43.33,1],[-92.29,46.62,1],[177.83,-43.33,1],[133.35,-1.58,1],[-87.71,-46.62,1],[-133.35,1.58,1],[87.71,46.62,1],[-46.65,-1.58,1],[92.29,-46.62,1],[46.65,1.58,1],[2.17,43.33,1],[-177.83,43.33,1],[41.12,27.96,1],[38.91,41.71,1],[-138.88,27.96,1],[54.83,35.51,1],[141.09,-41.71,1],[-54.83,-35.51,1],[-141.09,41.71,1],[-125.17,35.51,1],[-38.91,-41.71,1],[125.17,-35.51,1],[-41.12,-27.96,1],[138.88,-27.96,1],[-126.67,13.75,1],[163.04,-35.46,1],[53.33,13.75,1],[-67.73,-51.18,1],[16.96,35.46,1],[67.73,51.18,1],[-16.96,-35.46,1],[112.27,-51.18,1],[-163.04,35.46,1],[-112.27,51.18,1],[126.67,-13.75,1],[-53.33,-13.75,1],[6.02,-15.42,1],[-69.18,73.47,1],[-173.98,-15.42,1],[105.51,5.8,1],[-110.82,-73.47,1],[-105.51,-5.8,1],[110.82,73.47,1],[-74.49,5.8,1],[69.18,-73.47,1],[74.49,-5.8,1],[-6.02,15.42,1],[173.98,15.42,1],[160.08,33.45,1],[62.71,-51.67,1],[-19.92,33.45,1],[-54.9,16.52,1],[117.29,51.67,1],[54.9,-16.52,1],[-117.29,-51.67,1],[125.1,16.52,1],[-62.71,51.67,1],[-125.1,-16.52,1],[-160.08,-33.45,1],[19.92,-33.45,1],[80.34,6.51,1],[6.61,9.59,1],[-99.66,6.51,1],[55.76,78.37,1],[173.39,-9.59,1],[-55.76,-78.37,1],[-173.39,9.59,1],[-124.24,78.37,1],[-6.61,-9.59,1],[124.24,-78.37,1],[-80.34,-6.51,1],[99.66,-6.51,1],[6.25,24.64,1],[76.64,64.63,1],[-173.75,24.64,1],[65.23,5.68,1],[103.36,-64.63,1],[-65.23,-5.68,1],[-103.36,64.63,1],[-114.77,5.68,1],[-76.64,-64.63,1],[114.77,-5.68,1],[-6.25,-24.64,1],[173.75,-24.64,1],[51.41,-63.45,1],[-68.67,16.19,1],[-128.59,-63.45,1],[162.69,20.45,1],[-111.33,-16.19,1],[-162.69,-20.45,1],[111.33,16.19,1],[-17.31,20.45,1],[68.67,-16.19,1],[17.31,-20.45,1],[-51.41,63.45,1],[128.59,63.45,1],[-50.6,28.85,1],[144.51,33.77,1],[129.4,28.85,1],[49.04,-42.6,1],[35.49,-33.77,1],[-49.04,42.6,1],[-35.49,33.77,1],[-130.96,-42.6,1],[-144.51,-33.77,1],[130.96,42.6,1],[50.6,-28.85,1],[-129.4,-28.85,1]]],e=n[o-1];return e}module.exports.getAmbisonicDecMtx=getAmbisonicDecMtx,module.exports.getTdesign=getTdesign,module.exports.deg2rad=deg2rad,module.exports.rad2deg=rad2deg,module.exports.createNearestLookup=createNearestLookup,module.exports.findNearest=findNearest;const _utils=Object.freeze(Object.defineProperty({__proto__:null,createNearestLookup,deg2rad,findNearest,getAmbisonicDecMtx,getCircHarmonics,getColumn,getTdesign,numeric,rad2deg,sampleCircle},Symbol.toStringTag,{value:"Module"}));function computeEncodingCoefficients(o,n,e){const r=getAmbisonicChannelCount(e),i=degreesToRadians(o),a=degreesToRadians(n),t=computeRealSH_1(e,[[i,a]]),s=new Float32Array(r);for(let f=0;f<r;f++)s[f]=t[f][0];return s}function computeEncodingCoefficients2D(o,n){const e=getAmbisonicChannelCount2D(n),r=getCircHarmonics(n,[o]),i=new Float32Array(e);for(let a=0;a<e;a++)i[a]=r[a][0];return i}function encodeBuffer(o,n,e,r){const i=getAmbisonicChannelCount(r),a=o.length,t=computeEncodingCoefficients(n,e,r),s=new Array(i);for(let f=0;f<i;f++){s[f]=new Float32Array(a);const h=t[f];for(let l=0;l<a;l++)s[f][l]=o[l]*h}return s}function encodeBuffer2D(o,n,e){const r=getAmbisonicChannelCount2D(e),i=o.length,a=computeEncodingCoefficients2D(n,e),t=new Array(r);for(let s=0;s<r;s++){t[s]=new Float32Array(i);const f=a[s];for(let h=0;h<i;h++)t[s][h]=o[h]*f}return t}function encodeBufferFromDirection(o,n,e,r,i,a="ambisonics"){let t=n,s=e,f=r;a==="threejs"&&(t=r,s=-n,f=e);const[[h,l]]=convertCart2Sph_1([[t,s,f]],1),v=h*180/Math.PI,M=l*180/Math.PI;return encodeBuffer(o,v,M,i)}function encodeBuffer2DFromDirection(o,n,e,r,i,a="ambisonics"){let t=n,s=e;a==="threejs"&&(t=r,s=-n);const f=Math.atan2(s,t)*180/Math.PI;return encodeBuffer2D(o,f,i)}function encodeAndSumBuffers(o,n){if(o.length===0){const a=getAmbisonicChannelCount(n);return Array.from({length:a},()=>new Float32Array(0))}const e=Math.max(...o.map(a=>a.samples.length)),r=getAmbisonicChannelCount(n),i=Array.from({length:r},()=>new Float32Array(e));for(const a of o){const t=encodeBuffer(a.samples,a.azim,a.elev,n);for(let s=0;s<r;s++)for(let f=0;f<a.samples.length;f++)i[s][f]+=t[s][f]}return i}class monoEncoder{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.azim=0,this.elev=0,this.gains=new Array(this.nCh),this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(let r=0;r<this.nCh;r++)this.gainNodes[r]=this.ctx.createGain(),this.gainNodes[r].channelCountMode="explicit",this.gainNodes[r].channelCount=1;this.updateGains();for(let r=0;r<this.nCh;r++)this.in.connect(this.gainNodes[r]),this.gainNodes[r].connect(this.out,0,r);this.initialized=!0}updateGains(){const n=computeRealSH_1(this.order,[[degreesToRadians(this.azim),degreesToRadians(this.elev)]]);for(let e=0;e<this.nCh;e++)this.gains[e]=n[e][0],this.gainNodes[e].gain.value=this.gains[e]}setDirection(n,e,r,i="ambisonics"){let a=n,t=e,s=r;i==="threejs"&&(a=r,t=-n,s=e);const[[f,h]]=convertCart2Sph_1([[a,t,s]],1);this.azim=radiansToDegrees(f),this.elev=radiansToDegrees(h),this.updateGains()}getDirection(n="ambisonics"){const e=degreesToRadians(this.azim),r=degreesToRadians(this.elev),i=Math.cos(r),a=i*Math.cos(e),t=i*Math.sin(e),s=Math.sin(r);return n==="threejs"?[-t,s,a]:[a,t,s]}}class monoEncoder2D{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount2D(e),this.azim=0,this.elev=0,this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(let r=0;r<this.nCh;r++)this.gainNodes[r]=this.ctx.createGain(),this.gainNodes[r].channelCountMode="explicit",this.gainNodes[r].channelCount=1;this.updateGains();for(let r=0;r<this.nCh;r++)this.in.connect(this.gainNodes[r]),this.gainNodes[r].connect(this.out,0,r);this.initialized=!0}updateGains(){const n=getCircHarmonics(this.order,[this.azim]);for(let e=0;e<this.nCh;e++)this.gainNodes[e].gain.value=n[e][0]}setDirection(n,e,r,i="ambisonics"){let a=n,t=e;i==="threejs"&&(a=r,t=-n),this.azim=radiansToDegrees(Math.atan2(t,a)),this.elev=0,this.updateGains()}getDirection(n="ambisonics"){const e=degreesToRadians(this.azim),r=Math.cos(e),i=Math.sin(e);return n==="threejs"?[-i,0,r]:[r,i,0]}}class orderLimiter{get order(){return this.orderOut}get nCh(){return this.nChOut}constructor(n,e,r){this.ctx=n,this.orderIn=e,this.orderOut=r<e?r:e,this.nChIn=getAmbisonicChannelCount(this.orderIn),this.nChOut=getAmbisonicChannelCount(this.orderOut),this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(let i=0;i<this.nChOut;i++)this.in.connect(this.out,i,i)}updateOrder(n){if(!(n>this.orderIn)){this.orderOut=n,this.nChOut=getAmbisonicChannelCount(this.orderOut),this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(let e=0;e<this.nChOut;e++)this.in.connect(this.out,e,e)}}}class orderLimiter2D{get order(){return this.orderOut}get nCh(){return this.nChOut}constructor(n,e,r){this.ctx=n,this.orderIn=e,this.orderOut=r<e?r:e,this.nChIn=getAmbisonicChannelCount2D(this.orderIn),this.nChOut=getAmbisonicChannelCount2D(this.orderOut),this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(let i=0;i<this.nChOut;i++)this.in.connect(this.out,i,i)}updateOrder(n){if(!(n>this.orderIn)){this.orderOut=n,this.nChOut=getAmbisonicChannelCount2D(this.orderOut),this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(let e=0;e<this.nChOut;e++)this.in.connect(this.out,e,e)}}}class orderWeight{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh),this.orderGains=new Array(this.order+1),this.orderGains.fill(1);for(let r=0;r<this.nCh;r++)this.gains[r]=this.ctx.createGain(),this.in.connect(this.gains[r],r,0),this.gains[r].connect(this.out,0,r)}updateOrderGains(){for(let n=0;n<this.nCh;n++){const e=Math.floor(Math.sqrt(n));this.gains[n].gain.value=this.orderGains[e]}}computeMaxRECoeffs(){const n=this.order;this.orderGains[0]=1;let e=0,r=0;for(let i=1;i<=n;i++){const a=recurseLegendrePoly_1(i,[Math.cos(2.406809/(n+1.51))],e,r);this.orderGains[i]=a[0][0],r=e,e=a}}}class sceneRotator{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=numeric.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(let i=1;i<=this.order;i++){const a=new Array(2*i+1);for(let t=0;t<2*i+1;t++){a[t]=new Array(2*i+1);for(let s=0;s<2*i+1;s++)a[t][s]=this.ctx.createGain(),a[t][s].gain.value=t===s?1:0}this.rotMtxNodes[i-1]=a}this.in.connect(this.out,0,0);let r=1;for(let i=1;i<=this.order;i++){for(let a=0;a<2*i+1;a++)for(let t=0;t<2*i+1;t++)this.in.connect(this.rotMtxNodes[i-1][a][t],r+t,0),this.rotMtxNodes[i-1][a][t].connect(this.out,0,r+a);r=r+2*i+1}}updateRotMtx(){const n=degreesToRadians(this.yaw),e=degreesToRadians(this.pitch),r=degreesToRadians(this.roll);this.rotMtx=getSHrotMtx_1(yawPitchRoll2Rzyx_1(n,e,r),this.order);let i=1;for(let a=1;a<this.order+1;a++){for(let t=0;t<2*a+1;t++)for(let s=0;s<2*a+1;s++)this.rotMtxNodes[a-1][t][s].gain.value=this.rotMtx[i+t][i+s];i=i+2*a+1}}}class sceneRotator2D{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount2D(e),this.yaw=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.rotMtxNodes=new Array(2*this.order),this.in.connect(this.out,0,0);for(let r=0;r<2*this.order;r=r+2){const i=[this.ctx.createGain(),this.ctx.createGain()],a=[this.ctx.createGain(),this.ctx.createGain()];this.rotMtxNodes[r]=i,this.rotMtxNodes[r+1]=a,this.in.connect(this.rotMtxNodes[r][0],r+1,0),this.rotMtxNodes[r][0].connect(this.out,0,r+1),this.in.connect(this.rotMtxNodes[r][1],r+2,0),this.rotMtxNodes[r][1].connect(this.out,0,r+1),this.in.connect(this.rotMtxNodes[r+1][0],r+1,0),this.rotMtxNodes[r+1][0].connect(this.out,0,r+2),this.in.connect(this.rotMtxNodes[r+1][1],r+2,0),this.rotMtxNodes[r+1][1].connect(this.out,0,r+2)}this.updateRotMtx()}updateRotMtx(){const n=degreesToRadians(this.yaw);let e=1;for(let r=0;r<2*this.order;r=r+2)this.rotMtxNodes[r][0].gain.value=Math.cos(e*n),this.rotMtxNodes[r][1].gain.value=Math.sin(e*n),this.rotMtxNodes[r+1][0].gain.value=-Math.sin(e*n),this.rotMtxNodes[r+1][1].gain.value=Math.cos(e*n),e++}}class sceneMirror{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.mirrorPlane=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(let r=0;r<this.nCh;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1,this.in.connect(this.gains[r],r,0),this.gains[r].connect(this.out,0,r)}reset(){for(let n=0;n<this.nCh;n++)this.gains[n].gain.value=1}mirror(n){switch(n){case 0:this.mirrorPlane=0,this.reset();break;case 1:this.reset(),this.mirrorPlane=1;for(let e=0;e<=this.order;e++)for(let r=-e;r<=e;r++){const i=e*e+e+r;(r<0&&r%2===0||r>0&&r%2===1)&&(this.gains[i].gain.value=-1)}break;case 2:this.reset(),this.mirrorPlane=2;for(let e=0;e<=this.order;e++)for(let r=-e;r<=e;r++){const i=e*e+e+r;r<0&&(this.gains[i].gain.value=-1)}break;case 3:this.reset(),this.mirrorPlane=3;for(let e=0;e<=this.order;e++)for(let r=-e;r<=e;r++){const i=e*e+e+r;(r+e)%2===1&&(this.gains[i].gain.value=-1)}break;default:console.log("The mirroring planes can be either 1 (yz), 2 (xz), 3 (xy), or 0 (no mirroring). Value set to 0."),this.mirrorPlane=0,this.reset()}}}class sceneMirror2D{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount2D(e),this.mirrorPlane=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(let r=0;r<this.nCh;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1,this.in.connect(this.gains[r],r,0),this.gains[r].connect(this.out,0,r)}reset(){for(let n=0;n<this.nCh;n++)this.gains[n].gain.value=1}mirror(n){switch(n){case 0:this.mirrorPlane=0,this.reset();break;case 1:this.reset(),this.mirrorPlane=1;for(let e=2;e<this.nCh;e++)this.gains[e].gain.value=-1,e%2!==0&&(e=e+2);break;case 2:this.reset(),this.mirrorPlane=2;for(let e=0;e<this.nCh;e++)e%2!==0&&(this.gains[e].gain.value=-1);break;case 3:console.log("up-down mirroring in 2D mode not possible");break;default:console.log("The mirroring planes can be either 1 (yz), 2 (xz) or 0 (no mirroring). Value set to 0."),this.mirrorPlane=0,this.reset()}}}class binDecoder{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(let r=0;r<this.nCh;r++)this.decFilterNodes[r]=this.ctx.createConvolver(),this.decFilterNodes[r].normalize=!1;this.resetFilters();for(let r=0;r<this.nCh;r++){this.in.connect(this.decFilterNodes[r],r,0);const i=Math.floor(Math.sqrt(r));r-i*i-i>=0?this.decFilterNodes[r].connect(this.gainMid):this.decFilterNodes[r].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}updateFilters(n){for(let e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,n.length,n.sampleRate),this.decFilters[e].getChannelData(0).set(n.getChannelData(e)),this.decFilterNodes[e].buffer=this.decFilters[e]}resetFilters(){const n=new Array(this.nCh);n.fill(0),n[0]=.5,n[1]=.5/Math.sqrt(3);for(let e=0;e<this.nCh;e++){this.decFilters[e]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(let r=0;r<64;r++)this.decFilters[e].getChannelData(0)[r]=0;this.decFilters[e].getChannelData(0)[0]=n[e],this.decFilterNodes[e].buffer=this.decFilters[e]}}}class binDecoder2D{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount2D(e),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(let r=0;r<this.nCh;r++)this.decFilterNodes[r]=this.ctx.createConvolver(),this.decFilterNodes[r].normalize=!1;this.resetFilters();for(let r=0;r<this.nCh;r++)this.in.connect(this.decFilterNodes[r],r,0),r%2===0?this.decFilterNodes[r].connect(this.gainMid):this.decFilterNodes[r].connect(this.gainSide);this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}updateFilters(n){for(let e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,n.length,n.sampleRate),this.decFilters[e].getChannelData(0).set(n.getChannelData(e)),this.decFilterNodes[e].buffer=this.decFilters[e]}resetFilters(){const n=new Array(this.nCh);n.fill(0),n[0]=.5,n[1]=.5/Math.sqrt(3);for(let e=0;e<this.nCh;e++){this.decFilters[e]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(let r=0;r<64;r++)this.decFilters[e].getChannelData(0)[r]=0;this.decFilters[e].getChannelData(0)[0]=n[e],this.decFilterNodes[e].buffer=this.decFilters[e]}}}class decoder{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.nSpk=0,this._decodingMatrix=[],this._spkSphPosArray=[],this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(1),this._spkSphPosArray=this._getDefaultSpkConfig(this.order),this._updateDecodeMtx(this._spkSphPosArray)}set speakerPos(n){n===void 0&&(n=this._getDefaultSpkConfig(this.order)),this._spkSphPosArray=n,this.out.disconnect(),this._updateDecodeMtx(n)}get speakerPos(){return this._spkSphPosArray}_updateDecodeMtx(n){this.nSpk=n.length,this.out=this.ctx.createChannelMerger(this.nSpk),this._decodingMatrix=getAmbisonicDecMtx(n,this.order),this.mtxGain=new Array(this.nCh);for(let e=0;e<this.nCh;e++){this.mtxGain[e]=new Array(this.nSpk);for(let r=0;r<this.nSpk;r++){const i=this.ctx.createGain();i.gain.value=this._decodingMatrix[r][e],this.in.connect(i,e,0),i.connect(this.out,0,r),this.mtxGain[e][r]=i}}}_getDefaultSpkConfig(n){let e=[];switch(n){case 1:e=[[0,0,1],[90,0,1],[180,0,1],[270,0,1],[0,90,1],[0,-90,1]];break;case 2:e=[[180,-31.7161,.5878],[180,31.7161,.5878],[-121.7161,0,.5878],[121.7161,0,.5878],[-90,-58.2839,.5878],[-90,58.2839,.5878],[90,-58.2839,.5878],[90,58.2839,.5878],[-58.2839,0,.5878],[58.2839,0,.5878],[0,-31.7161,.5878],[0,31.7161,.5878]];break;case 3:e=[[-159.0931,0,.5352],[159.0931,0,.5352],[-135,-35.2644,.5352],[-135,35.2644,.5352],[135,-35.2644,.5352],[135,35.2644,.5352],[180,-69.0931,.5352],[180,69.0931,.5352],[-90,-20.9069,.5352],[-90,20.9069,.5352],[90,-20.9069,.5352],[90,20.9069,.5352],[0,-69.0931,.5352],[0,69.0931,.5352],[-45,-35.2644,.5352],[-45,35.2644,.5352],[45,-35.2644,.5352],[45,35.2644,.5352],[-20.9069,0,.5352],[20.9069,0,.5352]];break;default:console.error("unsupported default order:",n)}return e}}class convolver{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.encFilters=new Array(this.nCh),this.encFilterNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(let r=0;r<this.nCh;r++)this.encFilterNodes[r]=this.ctx.createConvolver(),this.encFilterNodes[r].normalize=!1;for(let r=0;r<this.nCh;r++)this.in.connect(this.encFilterNodes[r]),this.encFilterNodes[r].connect(this.out,0,r);this.initialized=!0}updateFilters(n){for(let e=0;e<this.nCh;e++)this.encFilters[e]=this.ctx.createBuffer(1,n.length,n.sampleRate),this.encFilters[e].getChannelData(0).set(n.getChannelData(e)),this.encFilterNodes[e].buffer=this.encFilters[e]}}class virtualMic{constructor(n,e){this.initialized=!1,this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.azim=0,this.elev=0,this.vmicGains=new Array(this.nCh),this.vmicGainNodes=new Array(this.nCh),this.vmicCoeffs=new Array(this.order+1),this.vmicPattern="hypercardioid",this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createGain();for(let r=0;r<this.nCh;r++)this.vmicGainNodes[r]=this.ctx.createGain();this.SHxyz=new Array(this.nCh),this.SHxyz.fill(0),this.updatePattern(),this.updateOrientation();for(let r=0;r<this.nCh;r++)this.in.connect(this.vmicGainNodes[r],r,0),this.vmicGainNodes[r].connect(this.out);this.initialized=!0}updatePattern(){switch(this.vmicPattern){case"cardioid":this.vmicCoeffs=this.computeCardioidCoeffs(this.order);break;case"supercardioid":this.vmicCoeffs=this.computeSupercardCoeffs(this.order);break;case"hypercardioid":this.vmicCoeffs=this.computeHypercardCoeffs(this.order);break;case"max_rE":this.vmicCoeffs=this.computeMaxRECoeffs(this.order);break;default:this.vmicPattern="hypercardioid",this.vmicCoeffs=this.computeHypercardCoeffs(this.order)}this.updateGains()}updateOrientation(){const n=degreesToRadians(this.azim),e=degreesToRadians(this.elev),r=computeRealSH_1(this.order,[[n,e]]);for(let i=0;i<this.nCh;i++)this.SHxyz[i]=r[i][0];this.updateGains()}updateGains(){for(let n=0;n<=this.order;n++)for(let e=-n;e<=n;e++){const r=n*n+n+e;this.vmicGains[r]=this.vmicCoeffs[n]*this.SHxyz[r]}for(let n=0;n<this.nCh;n++)this.vmicGainNodes[n].gain.value=this.vmicGains[n]}computeCardioidCoeffs(n){const e=new Array(n+1);for(let r=0;r<=n;r++)e[r]=factorial_1(n)*factorial_1(n)/(factorial_1(n+r+1)*factorial_1(n-r));return e}computeHypercardCoeffs(n){const e=new Array(n+1),r=(n+1)*(n+1);for(let i=0;i<=n;i++)e[i]=1/r;return e}computeSupercardCoeffs(n){switch(n){case 1:return[.366,.2113];case 2:return[.2362,.1562,.059];case 3:return[.1768,.1281,.0633,.0175];case 4:return[.1414,.1087,.0623,.0247,.0054];default:return console.error("Orders should be in the range of 1-4 at the moment."),[]}}computeMaxRECoeffs(n){const e=new Array(n+1);e[0]=1;let r=0,i=0;for(let t=1;t<n+1;t++){const s=recurseLegendrePoly_1(t,[Math.cos(2.406809/(n+1.51))],r,i);e[t]=s[0][0],i=r,r=s}let a=0;for(let t=0;t<=n;t++)a+=e[t]*(2*t+1);for(let t=0;t<=n;t++)e[t]=e[t]/a;return e}}if(commonjsGlobal.AnalyserNode&&!commonjsGlobal.AnalyserNode.prototype.getFloatTimeDomainData){var uint8=new Uint8Array(2048);commonjsGlobal.AnalyserNode.prototype.getFloatTimeDomainData=function(o){this.getByteTimeDomainData(uint8);for(var n=0,e=o.length;n<e;n++)o[n]=(uint8[n]-128)*.0078125}}class rmsAnalyser{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.fftSize=2048,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh);for(let r=0;r<this.nCh;r++)this.analysers[r]=this.ctx.createAnalyser(),this.analysers[r].fftSize=this.fftSize,this.analysers[r].smoothingTimeConstant=0,this.analBuffers[r]=new Float32Array(this.fftSize),this.in.connect(this.analysers[r],r,0),this.analysers[r].connect(this.out,0,r)}updateBuffers(){for(let n=0;n<this.nCh;n++)this.analysers[n].getFloatTimeDomainData(this.analBuffers[n])}computeRMS(){const n=new Array(this.nCh);n.fill(0);for(let e=0;e<this.nCh;e++){for(let r=0;r<this.fftSize;r++)n[e]=n[e]+this.analBuffers[e][r]*this.analBuffers[e][r];n[e]=Math.sqrt(n[e]/this.fftSize)}return n}}class powermapAnalyser{constructor(n,e,r){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.fftSize=2048,this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(let a=0;a<this.nCh;a++)this.analysers[a]=this.ctx.createAnalyser(),this.analysers[a].fftSize=this.fftSize,this.analysers[a].smoothingTimeConstant=0,this.analBuffers[a]=new Float32Array(this.fftSize);for(let a=0;a<this.nCh;a++)this.in.connect(this.out,a,a),this.in.connect(this.analysers[a],a,0);const i=getTdesign(4*e);this.td_dirs_rad=deg2rad(i),this.SHmtx=computeRealSH_1(this.order,this.td_dirs_rad),this.mode=r}updateBuffers(){for(let n=0;n<this.nCh;n++)this.analysers[n].getFloatTimeDomainData(this.analBuffers[n])}computePowermap(){const n=this.td_dirs_rad.length,e=numeric.dot(numeric.transpose(this.SHmtx),this.analBuffers),r=new Array(n);for(let i=0;i<n;i++){let a=0;for(let t=0;t<this.fftSize;t++)a=a+e[i][t]*e[i][t];a=a/this.fftSize,r[i]=[this.td_dirs_rad[i][0],this.td_dirs_rad[i][1],a]}return this.mode===0?r:forwardSHT_1(2*this.order,r,1,0)}}class intensityAnalyser{constructor(n){this.ctx=n,this.fftSize=2048,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(3);for(let e=0;e<3;e++)this.gains[e]=this.ctx.createGain(),this.gains[e].gain.value=1/Math.sqrt(3);this.analysers=new Array(4),this.analBuffers=new Array(4);for(let e=0;e<4;e++)this.analysers[e]=this.ctx.createAnalyser(),this.analysers[e].fftSize=this.fftSize,this.analysers[e].smoothingTimeConstant=0,this.analBuffers[e]=new Float32Array(this.fftSize);this.in.connect(this.out,0,0),this.in.connect(this.analysers[0],0,0),this.in.connect(this.gains[1],1,0),this.in.connect(this.gains[2],2,0),this.in.connect(this.gains[0],3,0);for(let e=0;e<3;e++)this.gains[e].connect(this.analysers[e+1],0,0),this.gains[e].connect(this.out,0,e+1)}updateBuffers(){for(let n=0;n<4;n++)this.analysers[n].getFloatTimeDomainData(this.analBuffers[n])}computeIntensity(){let n=0,e=0,r=0,i=0,a=0,t=0,s=0;for(let d=0;d<this.fftSize;d++)n=n+this.analBuffers[0][d]*this.analBuffers[1][d],e=e+this.analBuffers[0][d]*this.analBuffers[2][d],r=r+this.analBuffers[0][d]*this.analBuffers[3][d],i=i+this.analBuffers[0][d]*this.analBuffers[0][d],a=a+this.analBuffers[1][d]*this.analBuffers[1][d],t=t+this.analBuffers[2][d]*this.analBuffers[2][d],s=s+this.analBuffers[3][d]*this.analBuffers[3][d];const f=[n,e,r],h=Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]),l=(i+a+t+s)/2,v=1-h/(l+1e-7),M=radiansToDegrees(Math.atan2(e,n)),m=radiansToDegrees(Math.atan2(f[2],Math.sqrt(f[0]*f[0]+f[1]*f[1])));return[M,m,v,l]}}class intensityAnalyser2D{constructor(n){this.ctx=n,this.fftSize=2048,this.in=this.ctx.createChannelSplitter(3),this.out=this.ctx.createChannelMerger(3),this.gains=new Array(2);for(let e=0;e<2;e++)this.gains[e]=this.ctx.createGain(),this.gains[e].gain.value=1/Math.sqrt(3);this.analysers=new Array(3),this.analBuffers=new Array(3);for(let e=0;e<3;e++)this.analysers[e]=this.ctx.createAnalyser(),this.analysers[e].fftSize=this.fftSize,this.analysers[e].smoothingTimeConstant=0,this.analBuffers[e]=new Float32Array(this.fftSize);this.in.connect(this.out,0,0),this.in.connect(this.analysers[0],0,0),this.in.connect(this.gains[1],1,0),this.in.connect(this.gains[0],2,0);for(let e=0;e<2;e++)this.gains[e].connect(this.analysers[e+1],0,0),this.gains[e].connect(this.out,0,e+1)}updateBuffers(){for(let n=0;n<3;n++)this.analysers[n].getFloatTimeDomainData(this.analBuffers[n])}computeIntensity(){let n=0,e=0,r=0,i=0,a=0;for(let M=0;M<this.fftSize;M++)n=n+this.analBuffers[0][M]*this.analBuffers[1][M],e=e+this.analBuffers[0][M]*this.analBuffers[2][M],r=r+this.analBuffers[0][M]*this.analBuffers[0][M],i=i+this.analBuffers[1][M]*this.analBuffers[1][M],a=a+this.analBuffers[2][M]*this.analBuffers[2][M];const t=[n,e],s=Math.sqrt(t[0]*t[0]+t[1]*t[1]),f=(r+i+a)/2,h=1-s/(f+1e-7);return[-radiansToDegrees(Math.atan2(e,n)),0,h,f]}}function pad(o,n){return("000000000"+o).substr(-2)}class HOAloader{constructor(n,e,r,i){this.context=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.nChGroups=Math.ceil(this.nCh/8),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=i,this.urls=new Array(this.nChGroups),this.concatBuffer=null;const a=r.slice(r.length-3,r.length);this.fileExt=a;for(let t=0;t<this.nChGroups;t++)t===this.nChGroups-1?this.urls[t]=r.slice(0,r.length-4)+"_"+pad(t*8+1)+"-"+pad(this.nCh)+"ch."+a:this.urls[t]=r.slice(0,r.length-4)+"_"+pad(t*8+1)+"-"+pad(t*8+8)+"ch."+a}loadBuffers(n,e){const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer";const i=this;r.onload=function(){i.context.decodeAudioData(r.response,function(a){if(!a){alert("error decoding file data: "+n);return}i.buffers[e]=a,i.loadCount++,i.loadCount===i.nChGroups&&(i.loaded=!0,i.concatBuffers(),console.log("HOAloader: all buffers loaded and concatenated"),i.onLoad(i.concatBuffer))},function(a){alert("Browser cannot decode audio data:  "+n+`

Error: `+a+`

(If you re using Safari and get a null error, this is most likely due to Apple's shady plan going on to stop the .ogg format from easing web developer's life :)`)})},r.onerror=function(){alert("HOAloader: XHR error")},r.send()}load(){for(let n=0;n<this.nChGroups;++n)this.loadBuffers(this.urls[n],n)}concatBuffers(){if(!this.loaded)return;const n=this.nCh,e=this.nChGroups;let r=this.buffers[0].length;this.buffers.forEach(t=>{r=Math.max(r,t.length)});const i=this.buffers[0].sampleRate;let a=[1,2,3,4,5,6,7,8];this.fileExt.toLowerCase()==="ogg"&&(console.log("Loading of 8chan OGG files [Chrome/Firefox]: remap channels to correct order!"),a=[1,3,2,7,8,5,6,4]),this.concatBuffer=this.context.createBuffer(n,r,i);for(let t=0;t<e;t++)for(let s=0;s<this.buffers[t].numberOfChannels;s++)this.concatBuffer.getChannelData(t*8+s).set(this.buffers[t].getChannelData(a[s]-1))}}class HRIRloader_local{constructor(n,e,r){this.context=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.onLoad=r,this.vls_dirs_deg=getTdesign(2*this.order),this.nVLS=this.vls_dirs_deg.length,this.nearestLookupRes=[5,5],this.fs=0,this.nSamples=0,this.hrir_dirs_deg=[],this.hrirs=[],this.nearestLookup=[],this.nearest_dirs_deg=[],this.vls_hrirs=[],this.decodingMatrix=[],this.hoaBuffer=null}load(n){const e=this,r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="json",r.onload=function(){e.parseHrirFromJSON(r.response),e.nearestLookup=createNearestLookup(e.hrir_dirs_deg,e.nearestLookupRes);const i=findNearest(e.vls_dirs_deg,e.nearestLookup,e.nearestLookupRes);e.nearest_dirs_deg=e.getClosestDirs(i,e.hrir_dirs_deg),e.vls_hrirs=e.getClosestHrirFilters(i,e.hrirs),e.computeDecFilters()},r.send()}parseHrirFromJSON(n){const e=this;this.fs=n.leaves[6].data[0],this.nSamples=n.leaves[8].data[0][1].length,this.hrir_dirs_deg=[],n.leaves[4].data.forEach(function(r){e.hrir_dirs_deg.push([r[0],r[1]])}),this.hrirs=[],n.leaves[8].data.forEach(function(r){const i=new Float64Array(r[0]),a=new Float64Array(r[1]);e.hrirs.push([i,a])})}getClosestDirs(n,e){const r=n.length,i=[];for(let a=0;a<r;a++)i.push(e[n[a]]);return i}getClosestHrirFilters(n,e){const r=n.length,i=[];for(let a=0;a<r;a++)i.push(e[n[a]]);return i}computeDecFilters(){this.decodingMatrix=getAmbisonicDecMtx(this.nearest_dirs_deg,this.order),this.hoaBuffer=this.getHoaFilterFromHrirFilter(this.nCh,this.nSamples,this.fs,this.vls_hrirs,this.decodingMatrix),this.onLoad(this.hoaBuffer)}getHoaFilterFromHrirFilter(n,e,r,i,a){e>i[0][0].length&&(e=i[0][0].length);const t=this.context.createBuffer(n,e,r);for(let s=0;s<n;s++){const f=new Float32Array(e);for(let h=0;h<i.length;h++)for(let l=0;l<e;l++)f[l]+=a[h][s]*i[h][0][l];t.getChannelData(s).set(f)}return t}}class HRIRloader2D_local{constructor(n,e,r){this.context=n,this.order=e,this.nCh=getAmbisonicChannelCount2D(e),this.onLoad=r,this.vls_dirs_deg=sampleCircle(2*this.order+2),this.nVLS=this.vls_dirs_deg.length,this.nearestLookupRes=[5,5],this.fs=0,this.nSamples=0,this.hrir_dirs_deg=[],this.hrirs=[],this.nearestLookup=[],this.vls_hrirs=[],this.decodingMatrix=[],this.hoaBuffer=null}load(n){const e=this,r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="json",r.onload=function(){e.parseHrirFromJSON(r.response),e.nearestLookup=createNearestLookup(e.hrir_dirs_deg,e.nearestLookupRes);const i=findNearest(e.vls_dirs_deg,e.nearestLookup,e.nearestLookupRes);e.getClosestDirs(i,e.hrir_dirs_deg),e.vls_hrirs=e.getClosestHrirFilters(i,e.hrirs),e.computeDecFilters()},r.send()}parseHrirFromJSON(n){const e=this;this.fs=n.leaves[6].data[0],this.nSamples=n.leaves[8].data[0][1].length,this.hrir_dirs_deg=[],n.leaves[4].data.forEach(function(r){e.hrir_dirs_deg.push([r[0],r[1]])}),this.hrirs=[],n.leaves[8].data.forEach(function(r){const i=new Float64Array(r[0]),a=new Float64Array(r[1]);e.hrirs.push([i,a])})}getClosestDirs(n,e){const r=n.length,i=[];for(let a=0;a<r;a++)i.push(e[n[a]]);return i}getClosestHrirFilters(n,e){const r=n.length,i=[];for(let a=0;a<r;a++)i.push(e[n[a]]);return i}computeDecFilters(){const n=[];n.push(1);for(let r=1;r<this.order+1;r++)n.push(Math.cos(r*Math.PI/(2*this.order+2))),n.push(Math.cos(r*Math.PI/(2*this.order+2)));const e=numeric.diag(n);this.decodingMatrix=numeric.transpose(getCircHarmonics(this.order,getColumn(this.vls_dirs_deg,0))),this.decodingMatrix=numeric.dot(this.decodingMatrix,e),this.decodingMatrix=numeric.mul(2*Math.PI/this.vls_dirs_deg.length,this.decodingMatrix),this.hoaBuffer=this.getHoaFilterFromHrirFilter(this.nCh,this.nSamples,this.fs,this.vls_hrirs,this.decodingMatrix),this.onLoad(this.hoaBuffer)}getHoaFilterFromHrirFilter(n,e,r,i,a){e>i[0][0].length&&(e=i[0][0].length);const t=this.context.createBuffer(n,e,r);for(let s=0;s<n;s++){const f=new Float32Array(e);for(let h=0;h<i.length;h++)for(let l=0;l<e;l++)f[l]+=a[h][s]*i[h][0][l];t.getChannelData(s).set(f)}return t}}function commonjsRequire(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var serveSofaHrir={exports:{}};(function(o,n){(function(e){o.exports=e()})(function(){return function e(r,i,a){function t(h,l){if(!i[h]){if(!r[h]){var v=typeof commonjsRequire=="function"&&commonjsRequire;if(!l&&v)return v(h,!0);if(s)return s(h,!0);var M=new Error("Cannot find module '"+h+"'");throw M.code="MODULE_NOT_FOUND",M}var m=i[h]={exports:{}};r[h][0].call(m.exports,function(d){var y=r[h][1][d];return t(y||d)},m,m.exports,e,r,i,a)}return i[h].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,f=0;f<a.length;f++)t(a[f]);return t}({1:[function(e,r,i){r.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":4}],2:[function(e,r,i){i.default=function(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")},i.__esModule=!0},{}],3:[function(e,r,i){var a=e("babel-runtime/core-js/object/define-property").default;i.default=function(){function t(s,f){for(var h=0;h<f.length;h++){var l=f[h];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),a(s,l.key,l)}}return function(s,f,h){return f&&t(s.prototype,f),h&&t(s,h),s}}(),i.__esModule=!0},{"babel-runtime/core-js/object/define-property":1}],4:[function(e,r,i){var a=e("../../modules/$");r.exports=function(s,f,h){return a.setDesc(s,f,h)}},{"../../modules/$":5}],5:[function(e,r,i){var a=Object;r.exports={create:a.create,getProto:a.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:a.getOwnPropertyDescriptor,setDesc:a.defineProperty,setDescs:a.defineProperties,getKeys:a.keys,getNames:a.getOwnPropertyNames,getSymbols:a.getOwnPropertySymbols,each:[].forEach}},{}],6:[function(e,r,i){var a=e("babel-runtime/helpers/create-class").default,t=e("babel-runtime/helpers/class-call-check").default;Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function f(h,l){t(this,f),this.delayTime=0,this.posRead=0,this.posWrite=0,this.fracXi1=0,this.fracYi1=0,this.intDelay=0,this.fracDelay=0,this.a1=void 0,this.sampleRate=h,this.maxDelayTime=l||1,this.bufferSize=this.maxDelayTime*this.sampleRate,this.bufferSize%1!==0&&(this.bufferSize=parseInt(this.bufferSize)+1),this.buffer=new Float32Array(this.bufferSize)}return a(f,[{key:"setDelay",value:function(l){if(l<this.maxDelayTime){this.delayTime=l;var v=l*this.sampleRate;this.intDelay=parseInt(v),this.fracDelay=v-this.intDelay,this.resample(),this.fracDelay!==0&&this.updateThiranCoefficient()}else throw new Error("delayTime > maxDelayTime")}},{key:"getDelay",value:function(){return this.delayTime}},{key:"process",value:function(l){for(var v=new Float32Array(l.length),M=0;M<l.length;M=M+1)this.buffer[this.posWrite]=l[M],v[M]=this.buffer[this.posRead],this.updatePointers();return this.fracDelay===0||(v=new Float32Array(this.fractionalThiranProcess(v))),v}},{key:"updatePointers",value:function(){this.posWrite===this.buffer.length-1?this.posWrite=0:this.posWrite=this.posWrite+1,this.posRead===this.buffer.length-1?this.posRead=0:this.posRead=this.posRead+1}},{key:"updateThiranCoefficient",value:function(){this.a1=(1-this.fracDelay)/(1+this.fracDelay)}},{key:"resample",value:function(){if(this.posWrite-this.intDelay<0){var l=this.intDelay-this.posWrite;this.posRead=this.buffer.length-l}else this.posRead=this.posWrite-this.intDelay}},{key:"fractionalThiranProcess",value:function(l){for(var v=new Float32Array(l.length),M,m,d=this.fracXi1,y=this.fracYi1,b=0;b<l.length;b=b+1)M=l[b],m=this.a1*M+d-this.a1*y,d=M,y=m,v[b]=m;return this.fracXi1=d,this.fracYi1=y,v}}]),f}();i.default=s,r.exports=i.default},{"babel-runtime/helpers/class-call-check":2,"babel-runtime/helpers/create-class":3}],7:[function(e,r,i){r.exports=e("./dist/fractional-delay")},{"./dist/fractional-delay":6}],8:[function(e,r,i){(function(t,s){if(typeof i=="object"&&typeof r=="object")r.exports=s();else{var f=s();for(var h in f)(typeof i=="object"?i:t)[h]=f[h]}})(this,function(){return function(a){var t={};function s(f){if(t[f])return t[f].exports;var h=t[f]={i:f,l:!1,exports:{}};return a[f].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=a,s.c=t,s.d=function(f,h,l){s.o(f,h)||Object.defineProperty(f,h,{configurable:!1,enumerable:!0,get:l})},s.n=function(f){var h=f&&f.__esModule?function(){return f.default}:function(){return f};return s.d(h,"a",h),h},s.o=function(f,h){return Object.prototype.hasOwnProperty.call(f,h)},s.p="",s(s.s=4)}([function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=h,t.toRadian=v,t.equals=M;var f=t.EPSILON=1e-6;t.ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array,t.RANDOM=Math.random;function h(m){t.ARRAY_TYPE=m}var l=Math.PI/180;function v(m){return m*l}function M(m,d){return Math.abs(m-d)<=f*Math.max(1,Math.abs(m),Math.abs(d))}},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=v,t.fromMat4=M,t.clone=m,t.copy=d,t.fromValues=y,t.set=b,t.identity=E,t.transpose=O,t.invert=p,t.adjoint=g,t.determinant=F,t.multiply=R,t.translate=j,t.rotate=u,t.scale=x,t.fromTranslation=N,t.fromRotation=L,t.fromScaling=G,t.fromMat2d=$,t.fromQuat=ar,t.normalFromMat4=pr,t.projection=Mr,t.str=wr,t.frob=Y,t.add=D,t.subtract=I,t.multiplyScalar=tr,t.multiplyScalarAndAdd=ir,t.exactEquals=or,t.equals=gr;var f=s(0),h=l(f);function l(_){if(_&&_.__esModule)return _;var w={};if(_!=null)for(var q in _)Object.prototype.hasOwnProperty.call(_,q)&&(w[q]=_[q]);return w.default=_,w}function v(){var _=new h.ARRAY_TYPE(9);return _[0]=1,_[1]=0,_[2]=0,_[3]=0,_[4]=1,_[5]=0,_[6]=0,_[7]=0,_[8]=1,_}function M(_,w){return _[0]=w[0],_[1]=w[1],_[2]=w[2],_[3]=w[4],_[4]=w[5],_[5]=w[6],_[6]=w[8],_[7]=w[9],_[8]=w[10],_}function m(_){var w=new h.ARRAY_TYPE(9);return w[0]=_[0],w[1]=_[1],w[2]=_[2],w[3]=_[3],w[4]=_[4],w[5]=_[5],w[6]=_[6],w[7]=_[7],w[8]=_[8],w}function d(_,w){return _[0]=w[0],_[1]=w[1],_[2]=w[2],_[3]=w[3],_[4]=w[4],_[5]=w[5],_[6]=w[6],_[7]=w[7],_[8]=w[8],_}function y(_,w,q,K,H,Z,rr,hr,mr){var z=new h.ARRAY_TYPE(9);return z[0]=_,z[1]=w,z[2]=q,z[3]=K,z[4]=H,z[5]=Z,z[6]=rr,z[7]=hr,z[8]=mr,z}function b(_,w,q,K,H,Z,rr,hr,mr,z){return _[0]=w,_[1]=q,_[2]=K,_[3]=H,_[4]=Z,_[5]=rr,_[6]=hr,_[7]=mr,_[8]=z,_}function E(_){return _[0]=1,_[1]=0,_[2]=0,_[3]=0,_[4]=1,_[5]=0,_[6]=0,_[7]=0,_[8]=1,_}function O(_,w){if(_===w){var q=w[1],K=w[2],H=w[5];_[1]=w[3],_[2]=w[6],_[3]=q,_[5]=w[7],_[6]=K,_[7]=H}else _[0]=w[0],_[1]=w[3],_[2]=w[6],_[3]=w[1],_[4]=w[4],_[5]=w[7],_[6]=w[2],_[7]=w[5],_[8]=w[8];return _}function p(_,w){var q=w[0],K=w[1],H=w[2],Z=w[3],rr=w[4],hr=w[5],mr=w[6],z=w[7],J=w[8],nr=J*rr-hr*z,cr=-J*Z+hr*mr,ur=z*Z-rr*mr,c=q*nr+K*cr+H*ur;return c?(c=1/c,_[0]=nr*c,_[1]=(-J*K+H*z)*c,_[2]=(hr*K-H*rr)*c,_[3]=cr*c,_[4]=(J*q-H*mr)*c,_[5]=(-hr*q+H*Z)*c,_[6]=ur*c,_[7]=(-z*q+K*mr)*c,_[8]=(rr*q-K*Z)*c,_):null}function g(_,w){var q=w[0],K=w[1],H=w[2],Z=w[3],rr=w[4],hr=w[5],mr=w[6],z=w[7],J=w[8];return _[0]=rr*J-hr*z,_[1]=H*z-K*J,_[2]=K*hr-H*rr,_[3]=hr*mr-Z*J,_[4]=q*J-H*mr,_[5]=H*Z-q*hr,_[6]=Z*z-rr*mr,_[7]=K*mr-q*z,_[8]=q*rr-K*Z,_}function F(_){var w=_[0],q=_[1],K=_[2],H=_[3],Z=_[4],rr=_[5],hr=_[6],mr=_[7],z=_[8];return w*(z*Z-rr*mr)+q*(-z*H+rr*hr)+K*(mr*H-Z*hr)}function R(_,w,q){var K=w[0],H=w[1],Z=w[2],rr=w[3],hr=w[4],mr=w[5],z=w[6],J=w[7],nr=w[8],cr=q[0],ur=q[1],c=q[2],S=q[3],X=q[4],Q=q[5],er=q[6],sr=q[7],fr=q[8];return _[0]=cr*K+ur*rr+c*z,_[1]=cr*H+ur*hr+c*J,_[2]=cr*Z+ur*mr+c*nr,_[3]=S*K+X*rr+Q*z,_[4]=S*H+X*hr+Q*J,_[5]=S*Z+X*mr+Q*nr,_[6]=er*K+sr*rr+fr*z,_[7]=er*H+sr*hr+fr*J,_[8]=er*Z+sr*mr+fr*nr,_}function j(_,w,q){var K=w[0],H=w[1],Z=w[2],rr=w[3],hr=w[4],mr=w[5],z=w[6],J=w[7],nr=w[8],cr=q[0],ur=q[1];return _[0]=K,_[1]=H,_[2]=Z,_[3]=rr,_[4]=hr,_[5]=mr,_[6]=cr*K+ur*rr+z,_[7]=cr*H+ur*hr+J,_[8]=cr*Z+ur*mr+nr,_}function u(_,w,q){var K=w[0],H=w[1],Z=w[2],rr=w[3],hr=w[4],mr=w[5],z=w[6],J=w[7],nr=w[8],cr=Math.sin(q),ur=Math.cos(q);return _[0]=ur*K+cr*rr,_[1]=ur*H+cr*hr,_[2]=ur*Z+cr*mr,_[3]=ur*rr-cr*K,_[4]=ur*hr-cr*H,_[5]=ur*mr-cr*Z,_[6]=z,_[7]=J,_[8]=nr,_}function x(_,w,q){var K=q[0],H=q[1];return _[0]=K*w[0],_[1]=K*w[1],_[2]=K*w[2],_[3]=H*w[3],_[4]=H*w[4],_[5]=H*w[5],_[6]=w[6],_[7]=w[7],_[8]=w[8],_}function N(_,w){return _[0]=1,_[1]=0,_[2]=0,_[3]=0,_[4]=1,_[5]=0,_[6]=w[0],_[7]=w[1],_[8]=1,_}function L(_,w){var q=Math.sin(w),K=Math.cos(w);return _[0]=K,_[1]=q,_[2]=0,_[3]=-q,_[4]=K,_[5]=0,_[6]=0,_[7]=0,_[8]=1,_}function G(_,w){return _[0]=w[0],_[1]=0,_[2]=0,_[3]=0,_[4]=w[1],_[5]=0,_[6]=0,_[7]=0,_[8]=1,_}function $(_,w){return _[0]=w[0],_[1]=w[1],_[2]=0,_[3]=w[2],_[4]=w[3],_[5]=0,_[6]=w[4],_[7]=w[5],_[8]=1,_}function ar(_,w){var q=w[0],K=w[1],H=w[2],Z=w[3],rr=q+q,hr=K+K,mr=H+H,z=q*rr,J=K*rr,nr=K*hr,cr=H*rr,ur=H*hr,c=H*mr,S=Z*rr,X=Z*hr,Q=Z*mr;return _[0]=1-nr-c,_[3]=J-Q,_[6]=cr+X,_[1]=J+Q,_[4]=1-z-c,_[7]=ur-S,_[2]=cr-X,_[5]=ur+S,_[8]=1-z-nr,_}function pr(_,w){var q=w[0],K=w[1],H=w[2],Z=w[3],rr=w[4],hr=w[5],mr=w[6],z=w[7],J=w[8],nr=w[9],cr=w[10],ur=w[11],c=w[12],S=w[13],X=w[14],Q=w[15],er=q*hr-K*rr,sr=q*mr-H*rr,fr=q*z-Z*rr,lr=K*mr-H*hr,vr=K*z-Z*hr,dr=H*z-Z*mr,Cr=J*S-nr*c,Sr=J*X-cr*c,Ar=J*Q-ur*c,xr=nr*X-cr*S,_r=nr*Q-ur*S,Dr=cr*Q-ur*X,yr=er*Dr-sr*_r+fr*xr+lr*Ar-vr*Sr+dr*Cr;return yr?(yr=1/yr,_[0]=(hr*Dr-mr*_r+z*xr)*yr,_[1]=(mr*Ar-rr*Dr-z*Sr)*yr,_[2]=(rr*_r-hr*Ar+z*Cr)*yr,_[3]=(H*_r-K*Dr-Z*xr)*yr,_[4]=(q*Dr-H*Ar+Z*Sr)*yr,_[5]=(K*Ar-q*_r-Z*Cr)*yr,_[6]=(S*dr-X*vr+Q*lr)*yr,_[7]=(X*fr-c*dr-Q*sr)*yr,_[8]=(c*vr-S*fr+Q*er)*yr,_):null}function Mr(_,w,q){return _[0]=2/w,_[1]=0,_[2]=0,_[3]=0,_[4]=-2/q,_[5]=0,_[6]=-1,_[7]=1,_[8]=1,_}function wr(_){return"mat3("+_[0]+", "+_[1]+", "+_[2]+", "+_[3]+", "+_[4]+", "+_[5]+", "+_[6]+", "+_[7]+", "+_[8]+")"}function Y(_){return Math.sqrt(Math.pow(_[0],2)+Math.pow(_[1],2)+Math.pow(_[2],2)+Math.pow(_[3],2)+Math.pow(_[4],2)+Math.pow(_[5],2)+Math.pow(_[6],2)+Math.pow(_[7],2)+Math.pow(_[8],2))}function D(_,w,q){return _[0]=w[0]+q[0],_[1]=w[1]+q[1],_[2]=w[2]+q[2],_[3]=w[3]+q[3],_[4]=w[4]+q[4],_[5]=w[5]+q[5],_[6]=w[6]+q[6],_[7]=w[7]+q[7],_[8]=w[8]+q[8],_}function I(_,w,q){return _[0]=w[0]-q[0],_[1]=w[1]-q[1],_[2]=w[2]-q[2],_[3]=w[3]-q[3],_[4]=w[4]-q[4],_[5]=w[5]-q[5],_[6]=w[6]-q[6],_[7]=w[7]-q[7],_[8]=w[8]-q[8],_}function tr(_,w,q){return _[0]=w[0]*q,_[1]=w[1]*q,_[2]=w[2]*q,_[3]=w[3]*q,_[4]=w[4]*q,_[5]=w[5]*q,_[6]=w[6]*q,_[7]=w[7]*q,_[8]=w[8]*q,_}function ir(_,w,q,K){return _[0]=w[0]+q[0]*K,_[1]=w[1]+q[1]*K,_[2]=w[2]+q[2]*K,_[3]=w[3]+q[3]*K,_[4]=w[4]+q[4]*K,_[5]=w[5]+q[5]*K,_[6]=w[6]+q[6]*K,_[7]=w[7]+q[7]*K,_[8]=w[8]+q[8]*K,_}function or(_,w){return _[0]===w[0]&&_[1]===w[1]&&_[2]===w[2]&&_[3]===w[3]&&_[4]===w[4]&&_[5]===w[5]&&_[6]===w[6]&&_[7]===w[7]&&_[8]===w[8]}function gr(_,w){var q=_[0],K=_[1],H=_[2],Z=_[3],rr=_[4],hr=_[5],mr=_[6],z=_[7],J=_[8],nr=w[0],cr=w[1],ur=w[2],c=w[3],S=w[4],X=w[5],Q=w[6],er=w[7],sr=w[8];return Math.abs(q-nr)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(nr))&&Math.abs(K-cr)<=h.EPSILON*Math.max(1,Math.abs(K),Math.abs(cr))&&Math.abs(H-ur)<=h.EPSILON*Math.max(1,Math.abs(H),Math.abs(ur))&&Math.abs(Z-c)<=h.EPSILON*Math.max(1,Math.abs(Z),Math.abs(c))&&Math.abs(rr-S)<=h.EPSILON*Math.max(1,Math.abs(rr),Math.abs(S))&&Math.abs(hr-X)<=h.EPSILON*Math.max(1,Math.abs(hr),Math.abs(X))&&Math.abs(mr-Q)<=h.EPSILON*Math.max(1,Math.abs(mr),Math.abs(Q))&&Math.abs(z-er)<=h.EPSILON*Math.max(1,Math.abs(z),Math.abs(er))&&Math.abs(J-sr)<=h.EPSILON*Math.max(1,Math.abs(J),Math.abs(sr))}t.mul=R,t.sub=I},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=v,t.clone=M,t.length=m,t.fromValues=d,t.copy=y,t.set=b,t.add=E,t.subtract=O,t.multiply=p,t.divide=g,t.ceil=F,t.floor=R,t.min=j,t.max=u,t.round=x,t.scale=N,t.scaleAndAdd=L,t.distance=G,t.squaredDistance=$,t.squaredLength=ar,t.negate=pr,t.inverse=Mr,t.normalize=wr,t.dot=Y,t.cross=D,t.lerp=I,t.hermite=tr,t.bezier=ir,t.random=or,t.transformMat4=gr,t.transformMat3=_,t.transformQuat=w,t.rotateX=q,t.rotateY=K,t.rotateZ=H,t.angle=Z,t.str=rr,t.exactEquals=hr,t.equals=mr;var f=s(0),h=l(f);function l(z){if(z&&z.__esModule)return z;var J={};if(z!=null)for(var nr in z)Object.prototype.hasOwnProperty.call(z,nr)&&(J[nr]=z[nr]);return J.default=z,J}function v(){var z=new h.ARRAY_TYPE(3);return z[0]=0,z[1]=0,z[2]=0,z}function M(z){var J=new h.ARRAY_TYPE(3);return J[0]=z[0],J[1]=z[1],J[2]=z[2],J}function m(z){var J=z[0],nr=z[1],cr=z[2];return Math.sqrt(J*J+nr*nr+cr*cr)}function d(z,J,nr){var cr=new h.ARRAY_TYPE(3);return cr[0]=z,cr[1]=J,cr[2]=nr,cr}function y(z,J){return z[0]=J[0],z[1]=J[1],z[2]=J[2],z}function b(z,J,nr,cr){return z[0]=J,z[1]=nr,z[2]=cr,z}function E(z,J,nr){return z[0]=J[0]+nr[0],z[1]=J[1]+nr[1],z[2]=J[2]+nr[2],z}function O(z,J,nr){return z[0]=J[0]-nr[0],z[1]=J[1]-nr[1],z[2]=J[2]-nr[2],z}function p(z,J,nr){return z[0]=J[0]*nr[0],z[1]=J[1]*nr[1],z[2]=J[2]*nr[2],z}function g(z,J,nr){return z[0]=J[0]/nr[0],z[1]=J[1]/nr[1],z[2]=J[2]/nr[2],z}function F(z,J){return z[0]=Math.ceil(J[0]),z[1]=Math.ceil(J[1]),z[2]=Math.ceil(J[2]),z}function R(z,J){return z[0]=Math.floor(J[0]),z[1]=Math.floor(J[1]),z[2]=Math.floor(J[2]),z}function j(z,J,nr){return z[0]=Math.min(J[0],nr[0]),z[1]=Math.min(J[1],nr[1]),z[2]=Math.min(J[2],nr[2]),z}function u(z,J,nr){return z[0]=Math.max(J[0],nr[0]),z[1]=Math.max(J[1],nr[1]),z[2]=Math.max(J[2],nr[2]),z}function x(z,J){return z[0]=Math.round(J[0]),z[1]=Math.round(J[1]),z[2]=Math.round(J[2]),z}function N(z,J,nr){return z[0]=J[0]*nr,z[1]=J[1]*nr,z[2]=J[2]*nr,z}function L(z,J,nr,cr){return z[0]=J[0]+nr[0]*cr,z[1]=J[1]+nr[1]*cr,z[2]=J[2]+nr[2]*cr,z}function G(z,J){var nr=J[0]-z[0],cr=J[1]-z[1],ur=J[2]-z[2];return Math.sqrt(nr*nr+cr*cr+ur*ur)}function $(z,J){var nr=J[0]-z[0],cr=J[1]-z[1],ur=J[2]-z[2];return nr*nr+cr*cr+ur*ur}function ar(z){var J=z[0],nr=z[1],cr=z[2];return J*J+nr*nr+cr*cr}function pr(z,J){return z[0]=-J[0],z[1]=-J[1],z[2]=-J[2],z}function Mr(z,J){return z[0]=1/J[0],z[1]=1/J[1],z[2]=1/J[2],z}function wr(z,J){var nr=J[0],cr=J[1],ur=J[2],c=nr*nr+cr*cr+ur*ur;return c>0&&(c=1/Math.sqrt(c),z[0]=J[0]*c,z[1]=J[1]*c,z[2]=J[2]*c),z}function Y(z,J){return z[0]*J[0]+z[1]*J[1]+z[2]*J[2]}function D(z,J,nr){var cr=J[0],ur=J[1],c=J[2],S=nr[0],X=nr[1],Q=nr[2];return z[0]=ur*Q-c*X,z[1]=c*S-cr*Q,z[2]=cr*X-ur*S,z}function I(z,J,nr,cr){var ur=J[0],c=J[1],S=J[2];return z[0]=ur+cr*(nr[0]-ur),z[1]=c+cr*(nr[1]-c),z[2]=S+cr*(nr[2]-S),z}function tr(z,J,nr,cr,ur,c){var S=c*c,X=S*(2*c-3)+1,Q=S*(c-2)+c,er=S*(c-1),sr=S*(3-2*c);return z[0]=J[0]*X+nr[0]*Q+cr[0]*er+ur[0]*sr,z[1]=J[1]*X+nr[1]*Q+cr[1]*er+ur[1]*sr,z[2]=J[2]*X+nr[2]*Q+cr[2]*er+ur[2]*sr,z}function ir(z,J,nr,cr,ur,c){var S=1-c,X=S*S,Q=c*c,er=X*S,sr=3*c*X,fr=3*Q*S,lr=Q*c;return z[0]=J[0]*er+nr[0]*sr+cr[0]*fr+ur[0]*lr,z[1]=J[1]*er+nr[1]*sr+cr[1]*fr+ur[1]*lr,z[2]=J[2]*er+nr[2]*sr+cr[2]*fr+ur[2]*lr,z}function or(z,J){J=J||1;var nr=h.RANDOM()*2*Math.PI,cr=h.RANDOM()*2-1,ur=Math.sqrt(1-cr*cr)*J;return z[0]=Math.cos(nr)*ur,z[1]=Math.sin(nr)*ur,z[2]=cr*J,z}function gr(z,J,nr){var cr=J[0],ur=J[1],c=J[2],S=nr[3]*cr+nr[7]*ur+nr[11]*c+nr[15];return S=S||1,z[0]=(nr[0]*cr+nr[4]*ur+nr[8]*c+nr[12])/S,z[1]=(nr[1]*cr+nr[5]*ur+nr[9]*c+nr[13])/S,z[2]=(nr[2]*cr+nr[6]*ur+nr[10]*c+nr[14])/S,z}function _(z,J,nr){var cr=J[0],ur=J[1],c=J[2];return z[0]=cr*nr[0]+ur*nr[3]+c*nr[6],z[1]=cr*nr[1]+ur*nr[4]+c*nr[7],z[2]=cr*nr[2]+ur*nr[5]+c*nr[8],z}function w(z,J,nr){var cr=J[0],ur=J[1],c=J[2],S=nr[0],X=nr[1],Q=nr[2],er=nr[3],sr=er*cr+X*c-Q*ur,fr=er*ur+Q*cr-S*c,lr=er*c+S*ur-X*cr,vr=-S*cr-X*ur-Q*c;return z[0]=sr*er+vr*-S+fr*-Q-lr*-X,z[1]=fr*er+vr*-X+lr*-S-sr*-Q,z[2]=lr*er+vr*-Q+sr*-X-fr*-S,z}function q(z,J,nr,cr){var ur=[],c=[];return ur[0]=J[0]-nr[0],ur[1]=J[1]-nr[1],ur[2]=J[2]-nr[2],c[0]=ur[0],c[1]=ur[1]*Math.cos(cr)-ur[2]*Math.sin(cr),c[2]=ur[1]*Math.sin(cr)+ur[2]*Math.cos(cr),z[0]=c[0]+nr[0],z[1]=c[1]+nr[1],z[2]=c[2]+nr[2],z}function K(z,J,nr,cr){var ur=[],c=[];return ur[0]=J[0]-nr[0],ur[1]=J[1]-nr[1],ur[2]=J[2]-nr[2],c[0]=ur[2]*Math.sin(cr)+ur[0]*Math.cos(cr),c[1]=ur[1],c[2]=ur[2]*Math.cos(cr)-ur[0]*Math.sin(cr),z[0]=c[0]+nr[0],z[1]=c[1]+nr[1],z[2]=c[2]+nr[2],z}function H(z,J,nr,cr){var ur=[],c=[];return ur[0]=J[0]-nr[0],ur[1]=J[1]-nr[1],ur[2]=J[2]-nr[2],c[0]=ur[0]*Math.cos(cr)-ur[1]*Math.sin(cr),c[1]=ur[0]*Math.sin(cr)+ur[1]*Math.cos(cr),c[2]=ur[2],z[0]=c[0]+nr[0],z[1]=c[1]+nr[1],z[2]=c[2]+nr[2],z}function Z(z,J){var nr=d(z[0],z[1],z[2]),cr=d(J[0],J[1],J[2]);wr(nr,nr),wr(cr,cr);var ur=Y(nr,cr);return ur>1?0:ur<-1?Math.PI:Math.acos(ur)}function rr(z){return"vec3("+z[0]+", "+z[1]+", "+z[2]+")"}function hr(z,J){return z[0]===J[0]&&z[1]===J[1]&&z[2]===J[2]}function mr(z,J){var nr=z[0],cr=z[1],ur=z[2],c=J[0],S=J[1],X=J[2];return Math.abs(nr-c)<=h.EPSILON*Math.max(1,Math.abs(nr),Math.abs(c))&&Math.abs(cr-S)<=h.EPSILON*Math.max(1,Math.abs(cr),Math.abs(S))&&Math.abs(ur-X)<=h.EPSILON*Math.max(1,Math.abs(ur),Math.abs(X))}t.sub=O,t.mul=p,t.div=g,t.dist=G,t.sqrDist=$,t.len=m,t.sqrLen=ar,t.forEach=function(){var z=v();return function(J,nr,cr,ur,c,S){var X=void 0,Q=void 0;for(nr||(nr=3),cr||(cr=0),ur?Q=Math.min(ur*nr+cr,J.length):Q=J.length,X=cr;X<Q;X+=nr)z[0]=J[X],z[1]=J[X+1],z[2]=J[X+2],c(z,z,S),J[X]=z[0],J[X+1]=z[1],J[X+2]=z[2];return J}}()},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=v,t.clone=M,t.fromValues=m,t.copy=d,t.set=y,t.add=b,t.subtract=E,t.multiply=O,t.divide=p,t.ceil=g,t.floor=F,t.min=R,t.max=j,t.round=u,t.scale=x,t.scaleAndAdd=N,t.distance=L,t.squaredDistance=G,t.length=$,t.squaredLength=ar,t.negate=pr,t.inverse=Mr,t.normalize=wr,t.dot=Y,t.lerp=D,t.random=I,t.transformMat4=tr,t.transformQuat=ir,t.str=or,t.exactEquals=gr,t.equals=_;var f=s(0),h=l(f);function l(w){if(w&&w.__esModule)return w;var q={};if(w!=null)for(var K in w)Object.prototype.hasOwnProperty.call(w,K)&&(q[K]=w[K]);return q.default=w,q}function v(){var w=new h.ARRAY_TYPE(4);return w[0]=0,w[1]=0,w[2]=0,w[3]=0,w}function M(w){var q=new h.ARRAY_TYPE(4);return q[0]=w[0],q[1]=w[1],q[2]=w[2],q[3]=w[3],q}function m(w,q,K,H){var Z=new h.ARRAY_TYPE(4);return Z[0]=w,Z[1]=q,Z[2]=K,Z[3]=H,Z}function d(w,q){return w[0]=q[0],w[1]=q[1],w[2]=q[2],w[3]=q[3],w}function y(w,q,K,H,Z){return w[0]=q,w[1]=K,w[2]=H,w[3]=Z,w}function b(w,q,K){return w[0]=q[0]+K[0],w[1]=q[1]+K[1],w[2]=q[2]+K[2],w[3]=q[3]+K[3],w}function E(w,q,K){return w[0]=q[0]-K[0],w[1]=q[1]-K[1],w[2]=q[2]-K[2],w[3]=q[3]-K[3],w}function O(w,q,K){return w[0]=q[0]*K[0],w[1]=q[1]*K[1],w[2]=q[2]*K[2],w[3]=q[3]*K[3],w}function p(w,q,K){return w[0]=q[0]/K[0],w[1]=q[1]/K[1],w[2]=q[2]/K[2],w[3]=q[3]/K[3],w}function g(w,q){return w[0]=Math.ceil(q[0]),w[1]=Math.ceil(q[1]),w[2]=Math.ceil(q[2]),w[3]=Math.ceil(q[3]),w}function F(w,q){return w[0]=Math.floor(q[0]),w[1]=Math.floor(q[1]),w[2]=Math.floor(q[2]),w[3]=Math.floor(q[3]),w}function R(w,q,K){return w[0]=Math.min(q[0],K[0]),w[1]=Math.min(q[1],K[1]),w[2]=Math.min(q[2],K[2]),w[3]=Math.min(q[3],K[3]),w}function j(w,q,K){return w[0]=Math.max(q[0],K[0]),w[1]=Math.max(q[1],K[1]),w[2]=Math.max(q[2],K[2]),w[3]=Math.max(q[3],K[3]),w}function u(w,q){return w[0]=Math.round(q[0]),w[1]=Math.round(q[1]),w[2]=Math.round(q[2]),w[3]=Math.round(q[3]),w}function x(w,q,K){return w[0]=q[0]*K,w[1]=q[1]*K,w[2]=q[2]*K,w[3]=q[3]*K,w}function N(w,q,K,H){return w[0]=q[0]+K[0]*H,w[1]=q[1]+K[1]*H,w[2]=q[2]+K[2]*H,w[3]=q[3]+K[3]*H,w}function L(w,q){var K=q[0]-w[0],H=q[1]-w[1],Z=q[2]-w[2],rr=q[3]-w[3];return Math.sqrt(K*K+H*H+Z*Z+rr*rr)}function G(w,q){var K=q[0]-w[0],H=q[1]-w[1],Z=q[2]-w[2],rr=q[3]-w[3];return K*K+H*H+Z*Z+rr*rr}function $(w){var q=w[0],K=w[1],H=w[2],Z=w[3];return Math.sqrt(q*q+K*K+H*H+Z*Z)}function ar(w){var q=w[0],K=w[1],H=w[2],Z=w[3];return q*q+K*K+H*H+Z*Z}function pr(w,q){return w[0]=-q[0],w[1]=-q[1],w[2]=-q[2],w[3]=-q[3],w}function Mr(w,q){return w[0]=1/q[0],w[1]=1/q[1],w[2]=1/q[2],w[3]=1/q[3],w}function wr(w,q){var K=q[0],H=q[1],Z=q[2],rr=q[3],hr=K*K+H*H+Z*Z+rr*rr;return hr>0&&(hr=1/Math.sqrt(hr),w[0]=K*hr,w[1]=H*hr,w[2]=Z*hr,w[3]=rr*hr),w}function Y(w,q){return w[0]*q[0]+w[1]*q[1]+w[2]*q[2]+w[3]*q[3]}function D(w,q,K,H){var Z=q[0],rr=q[1],hr=q[2],mr=q[3];return w[0]=Z+H*(K[0]-Z),w[1]=rr+H*(K[1]-rr),w[2]=hr+H*(K[2]-hr),w[3]=mr+H*(K[3]-mr),w}function I(w,q){return q=q||1,w[0]=h.RANDOM(),w[1]=h.RANDOM(),w[2]=h.RANDOM(),w[3]=h.RANDOM(),wr(w,w),x(w,w,q),w}function tr(w,q,K){var H=q[0],Z=q[1],rr=q[2],hr=q[3];return w[0]=K[0]*H+K[4]*Z+K[8]*rr+K[12]*hr,w[1]=K[1]*H+K[5]*Z+K[9]*rr+K[13]*hr,w[2]=K[2]*H+K[6]*Z+K[10]*rr+K[14]*hr,w[3]=K[3]*H+K[7]*Z+K[11]*rr+K[15]*hr,w}function ir(w,q,K){var H=q[0],Z=q[1],rr=q[2],hr=K[0],mr=K[1],z=K[2],J=K[3],nr=J*H+mr*rr-z*Z,cr=J*Z+z*H-hr*rr,ur=J*rr+hr*Z-mr*H,c=-hr*H-mr*Z-z*rr;return w[0]=nr*J+c*-hr+cr*-z-ur*-mr,w[1]=cr*J+c*-mr+ur*-hr-nr*-z,w[2]=ur*J+c*-z+nr*-mr-cr*-hr,w[3]=q[3],w}function or(w){return"vec4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+")"}function gr(w,q){return w[0]===q[0]&&w[1]===q[1]&&w[2]===q[2]&&w[3]===q[3]}function _(w,q){var K=w[0],H=w[1],Z=w[2],rr=w[3],hr=q[0],mr=q[1],z=q[2],J=q[3];return Math.abs(K-hr)<=h.EPSILON*Math.max(1,Math.abs(K),Math.abs(hr))&&Math.abs(H-mr)<=h.EPSILON*Math.max(1,Math.abs(H),Math.abs(mr))&&Math.abs(Z-z)<=h.EPSILON*Math.max(1,Math.abs(Z),Math.abs(z))&&Math.abs(rr-J)<=h.EPSILON*Math.max(1,Math.abs(rr),Math.abs(J))}t.sub=E,t.mul=O,t.div=p,t.dist=L,t.sqrDist=G,t.len=$,t.sqrLen=ar,t.forEach=function(){var w=v();return function(q,K,H,Z,rr,hr){var mr=void 0,z=void 0;for(K||(K=4),H||(H=0),Z?z=Math.min(Z*K+H,q.length):z=q.length,mr=H;mr<z;mr+=K)w[0]=q[mr],w[1]=q[mr+1],w[2]=q[mr+2],w[3]=q[mr+3],rr(w,w,hr),q[mr]=w[0],q[mr+1]=w[1],q[mr+2]=w[2],q[mr+3]=w[3];return q}}()},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var f=s(0),h=N(f),l=s(5),v=N(l),M=s(6),m=N(M),d=s(1),y=N(d),b=s(7),E=N(b),O=s(8),p=N(O),g=s(9),F=N(g),R=s(2),j=N(R),u=s(3),x=N(u);function N(L){if(L&&L.__esModule)return L;var G={};if(L!=null)for(var $ in L)Object.prototype.hasOwnProperty.call(L,$)&&(G[$]=L[$]);return G.default=L,G}t.glMatrix=h,t.mat2=v,t.mat2d=m,t.mat3=y,t.mat4=E,t.quat=p,t.vec2=F,t.vec3=j,t.vec4=x},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=v,t.clone=M,t.copy=m,t.identity=d,t.fromValues=y,t.set=b,t.transpose=E,t.invert=O,t.adjoint=p,t.determinant=g,t.multiply=F,t.rotate=R,t.scale=j,t.fromRotation=u,t.fromScaling=x,t.str=N,t.frob=L,t.LDU=G,t.add=$,t.subtract=ar,t.exactEquals=pr,t.equals=Mr,t.multiplyScalar=wr,t.multiplyScalarAndAdd=Y;var f=s(0),h=l(f);function l(D){if(D&&D.__esModule)return D;var I={};if(D!=null)for(var tr in D)Object.prototype.hasOwnProperty.call(D,tr)&&(I[tr]=D[tr]);return I.default=D,I}function v(){var D=new h.ARRAY_TYPE(4);return D[0]=1,D[1]=0,D[2]=0,D[3]=1,D}function M(D){var I=new h.ARRAY_TYPE(4);return I[0]=D[0],I[1]=D[1],I[2]=D[2],I[3]=D[3],I}function m(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D}function d(D){return D[0]=1,D[1]=0,D[2]=0,D[3]=1,D}function y(D,I,tr,ir){var or=new h.ARRAY_TYPE(4);return or[0]=D,or[1]=I,or[2]=tr,or[3]=ir,or}function b(D,I,tr,ir,or){return D[0]=I,D[1]=tr,D[2]=ir,D[3]=or,D}function E(D,I){if(D===I){var tr=I[1];D[1]=I[2],D[2]=tr}else D[0]=I[0],D[1]=I[2],D[2]=I[1],D[3]=I[3];return D}function O(D,I){var tr=I[0],ir=I[1],or=I[2],gr=I[3],_=tr*gr-or*ir;return _?(_=1/_,D[0]=gr*_,D[1]=-ir*_,D[2]=-or*_,D[3]=tr*_,D):null}function p(D,I){var tr=I[0];return D[0]=I[3],D[1]=-I[1],D[2]=-I[2],D[3]=tr,D}function g(D){return D[0]*D[3]-D[2]*D[1]}function F(D,I,tr){var ir=I[0],or=I[1],gr=I[2],_=I[3],w=tr[0],q=tr[1],K=tr[2],H=tr[3];return D[0]=ir*w+gr*q,D[1]=or*w+_*q,D[2]=ir*K+gr*H,D[3]=or*K+_*H,D}function R(D,I,tr){var ir=I[0],or=I[1],gr=I[2],_=I[3],w=Math.sin(tr),q=Math.cos(tr);return D[0]=ir*q+gr*w,D[1]=or*q+_*w,D[2]=ir*-w+gr*q,D[3]=or*-w+_*q,D}function j(D,I,tr){var ir=I[0],or=I[1],gr=I[2],_=I[3],w=tr[0],q=tr[1];return D[0]=ir*w,D[1]=or*w,D[2]=gr*q,D[3]=_*q,D}function u(D,I){var tr=Math.sin(I),ir=Math.cos(I);return D[0]=ir,D[1]=tr,D[2]=-tr,D[3]=ir,D}function x(D,I){return D[0]=I[0],D[1]=0,D[2]=0,D[3]=I[1],D}function N(D){return"mat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+")"}function L(D){return Math.sqrt(Math.pow(D[0],2)+Math.pow(D[1],2)+Math.pow(D[2],2)+Math.pow(D[3],2))}function G(D,I,tr,ir){return D[2]=ir[2]/ir[0],tr[0]=ir[0],tr[1]=ir[1],tr[3]=ir[3]-D[2]*tr[1],[D,I,tr]}function $(D,I,tr){return D[0]=I[0]+tr[0],D[1]=I[1]+tr[1],D[2]=I[2]+tr[2],D[3]=I[3]+tr[3],D}function ar(D,I,tr){return D[0]=I[0]-tr[0],D[1]=I[1]-tr[1],D[2]=I[2]-tr[2],D[3]=I[3]-tr[3],D}function pr(D,I){return D[0]===I[0]&&D[1]===I[1]&&D[2]===I[2]&&D[3]===I[3]}function Mr(D,I){var tr=D[0],ir=D[1],or=D[2],gr=D[3],_=I[0],w=I[1],q=I[2],K=I[3];return Math.abs(tr-_)<=h.EPSILON*Math.max(1,Math.abs(tr),Math.abs(_))&&Math.abs(ir-w)<=h.EPSILON*Math.max(1,Math.abs(ir),Math.abs(w))&&Math.abs(or-q)<=h.EPSILON*Math.max(1,Math.abs(or),Math.abs(q))&&Math.abs(gr-K)<=h.EPSILON*Math.max(1,Math.abs(gr),Math.abs(K))}function wr(D,I,tr){return D[0]=I[0]*tr,D[1]=I[1]*tr,D[2]=I[2]*tr,D[3]=I[3]*tr,D}function Y(D,I,tr,ir){return D[0]=I[0]+tr[0]*ir,D[1]=I[1]+tr[1]*ir,D[2]=I[2]+tr[2]*ir,D[3]=I[3]+tr[3]*ir,D}t.mul=F,t.sub=ar},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=v,t.clone=M,t.copy=m,t.identity=d,t.fromValues=y,t.set=b,t.invert=E,t.determinant=O,t.multiply=p,t.rotate=g,t.scale=F,t.translate=R,t.fromRotation=j,t.fromScaling=u,t.fromTranslation=x,t.str=N,t.frob=L,t.add=G,t.subtract=$,t.multiplyScalar=ar,t.multiplyScalarAndAdd=pr,t.exactEquals=Mr,t.equals=wr;var f=s(0),h=l(f);function l(Y){if(Y&&Y.__esModule)return Y;var D={};if(Y!=null)for(var I in Y)Object.prototype.hasOwnProperty.call(Y,I)&&(D[I]=Y[I]);return D.default=Y,D}function v(){var Y=new h.ARRAY_TYPE(6);return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=1,Y[4]=0,Y[5]=0,Y}function M(Y){var D=new h.ARRAY_TYPE(6);return D[0]=Y[0],D[1]=Y[1],D[2]=Y[2],D[3]=Y[3],D[4]=Y[4],D[5]=Y[5],D}function m(Y,D){return Y[0]=D[0],Y[1]=D[1],Y[2]=D[2],Y[3]=D[3],Y[4]=D[4],Y[5]=D[5],Y}function d(Y){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=1,Y[4]=0,Y[5]=0,Y}function y(Y,D,I,tr,ir,or){var gr=new h.ARRAY_TYPE(6);return gr[0]=Y,gr[1]=D,gr[2]=I,gr[3]=tr,gr[4]=ir,gr[5]=or,gr}function b(Y,D,I,tr,ir,or,gr){return Y[0]=D,Y[1]=I,Y[2]=tr,Y[3]=ir,Y[4]=or,Y[5]=gr,Y}function E(Y,D){var I=D[0],tr=D[1],ir=D[2],or=D[3],gr=D[4],_=D[5],w=I*or-tr*ir;return w?(w=1/w,Y[0]=or*w,Y[1]=-tr*w,Y[2]=-ir*w,Y[3]=I*w,Y[4]=(ir*_-or*gr)*w,Y[5]=(tr*gr-I*_)*w,Y):null}function O(Y){return Y[0]*Y[3]-Y[1]*Y[2]}function p(Y,D,I){var tr=D[0],ir=D[1],or=D[2],gr=D[3],_=D[4],w=D[5],q=I[0],K=I[1],H=I[2],Z=I[3],rr=I[4],hr=I[5];return Y[0]=tr*q+or*K,Y[1]=ir*q+gr*K,Y[2]=tr*H+or*Z,Y[3]=ir*H+gr*Z,Y[4]=tr*rr+or*hr+_,Y[5]=ir*rr+gr*hr+w,Y}function g(Y,D,I){var tr=D[0],ir=D[1],or=D[2],gr=D[3],_=D[4],w=D[5],q=Math.sin(I),K=Math.cos(I);return Y[0]=tr*K+or*q,Y[1]=ir*K+gr*q,Y[2]=tr*-q+or*K,Y[3]=ir*-q+gr*K,Y[4]=_,Y[5]=w,Y}function F(Y,D,I){var tr=D[0],ir=D[1],or=D[2],gr=D[3],_=D[4],w=D[5],q=I[0],K=I[1];return Y[0]=tr*q,Y[1]=ir*q,Y[2]=or*K,Y[3]=gr*K,Y[4]=_,Y[5]=w,Y}function R(Y,D,I){var tr=D[0],ir=D[1],or=D[2],gr=D[3],_=D[4],w=D[5],q=I[0],K=I[1];return Y[0]=tr,Y[1]=ir,Y[2]=or,Y[3]=gr,Y[4]=tr*q+or*K+_,Y[5]=ir*q+gr*K+w,Y}function j(Y,D){var I=Math.sin(D),tr=Math.cos(D);return Y[0]=tr,Y[1]=I,Y[2]=-I,Y[3]=tr,Y[4]=0,Y[5]=0,Y}function u(Y,D){return Y[0]=D[0],Y[1]=0,Y[2]=0,Y[3]=D[1],Y[4]=0,Y[5]=0,Y}function x(Y,D){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=1,Y[4]=D[0],Y[5]=D[1],Y}function N(Y){return"mat2d("+Y[0]+", "+Y[1]+", "+Y[2]+", "+Y[3]+", "+Y[4]+", "+Y[5]+")"}function L(Y){return Math.sqrt(Math.pow(Y[0],2)+Math.pow(Y[1],2)+Math.pow(Y[2],2)+Math.pow(Y[3],2)+Math.pow(Y[4],2)+Math.pow(Y[5],2)+1)}function G(Y,D,I){return Y[0]=D[0]+I[0],Y[1]=D[1]+I[1],Y[2]=D[2]+I[2],Y[3]=D[3]+I[3],Y[4]=D[4]+I[4],Y[5]=D[5]+I[5],Y}function $(Y,D,I){return Y[0]=D[0]-I[0],Y[1]=D[1]-I[1],Y[2]=D[2]-I[2],Y[3]=D[3]-I[3],Y[4]=D[4]-I[4],Y[5]=D[5]-I[5],Y}function ar(Y,D,I){return Y[0]=D[0]*I,Y[1]=D[1]*I,Y[2]=D[2]*I,Y[3]=D[3]*I,Y[4]=D[4]*I,Y[5]=D[5]*I,Y}function pr(Y,D,I,tr){return Y[0]=D[0]+I[0]*tr,Y[1]=D[1]+I[1]*tr,Y[2]=D[2]+I[2]*tr,Y[3]=D[3]+I[3]*tr,Y[4]=D[4]+I[4]*tr,Y[5]=D[5]+I[5]*tr,Y}function Mr(Y,D){return Y[0]===D[0]&&Y[1]===D[1]&&Y[2]===D[2]&&Y[3]===D[3]&&Y[4]===D[4]&&Y[5]===D[5]}function wr(Y,D){var I=Y[0],tr=Y[1],ir=Y[2],or=Y[3],gr=Y[4],_=Y[5],w=D[0],q=D[1],K=D[2],H=D[3],Z=D[4],rr=D[5];return Math.abs(I-w)<=h.EPSILON*Math.max(1,Math.abs(I),Math.abs(w))&&Math.abs(tr-q)<=h.EPSILON*Math.max(1,Math.abs(tr),Math.abs(q))&&Math.abs(ir-K)<=h.EPSILON*Math.max(1,Math.abs(ir),Math.abs(K))&&Math.abs(or-H)<=h.EPSILON*Math.max(1,Math.abs(or),Math.abs(H))&&Math.abs(gr-Z)<=h.EPSILON*Math.max(1,Math.abs(gr),Math.abs(Z))&&Math.abs(_-rr)<=h.EPSILON*Math.max(1,Math.abs(_),Math.abs(rr))}t.mul=p,t.sub=$},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=v,t.clone=M,t.copy=m,t.fromValues=d,t.set=y,t.identity=b,t.transpose=E,t.invert=O,t.adjoint=p,t.determinant=g,t.multiply=F,t.translate=R,t.scale=j,t.rotate=u,t.rotateX=x,t.rotateY=N,t.rotateZ=L,t.fromTranslation=G,t.fromScaling=$,t.fromRotation=ar,t.fromXRotation=pr,t.fromYRotation=Mr,t.fromZRotation=wr,t.fromRotationTranslation=Y,t.getTranslation=D,t.getScaling=I,t.getRotation=tr,t.fromRotationTranslationScale=ir,t.fromRotationTranslationScaleOrigin=or,t.fromQuat=gr,t.frustum=_,t.perspective=w,t.perspectiveFromFieldOfView=q,t.ortho=K,t.lookAt=H,t.targetTo=Z,t.str=rr,t.frob=hr,t.add=mr,t.subtract=z,t.multiplyScalar=J,t.multiplyScalarAndAdd=nr,t.exactEquals=cr,t.equals=ur;var f=s(0),h=l(f);function l(c){if(c&&c.__esModule)return c;var S={};if(c!=null)for(var X in c)Object.prototype.hasOwnProperty.call(c,X)&&(S[X]=c[X]);return S.default=c,S}function v(){var c=new h.ARRAY_TYPE(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function M(c){var S=new h.ARRAY_TYPE(16);return S[0]=c[0],S[1]=c[1],S[2]=c[2],S[3]=c[3],S[4]=c[4],S[5]=c[5],S[6]=c[6],S[7]=c[7],S[8]=c[8],S[9]=c[9],S[10]=c[10],S[11]=c[11],S[12]=c[12],S[13]=c[13],S[14]=c[14],S[15]=c[15],S}function m(c,S){return c[0]=S[0],c[1]=S[1],c[2]=S[2],c[3]=S[3],c[4]=S[4],c[5]=S[5],c[6]=S[6],c[7]=S[7],c[8]=S[8],c[9]=S[9],c[10]=S[10],c[11]=S[11],c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15],c}function d(c,S,X,Q,er,sr,fr,lr,vr,dr,Cr,Sr,Ar,xr,_r,Dr){var yr=new h.ARRAY_TYPE(16);return yr[0]=c,yr[1]=S,yr[2]=X,yr[3]=Q,yr[4]=er,yr[5]=sr,yr[6]=fr,yr[7]=lr,yr[8]=vr,yr[9]=dr,yr[10]=Cr,yr[11]=Sr,yr[12]=Ar,yr[13]=xr,yr[14]=_r,yr[15]=Dr,yr}function y(c,S,X,Q,er,sr,fr,lr,vr,dr,Cr,Sr,Ar,xr,_r,Dr,yr){return c[0]=S,c[1]=X,c[2]=Q,c[3]=er,c[4]=sr,c[5]=fr,c[6]=lr,c[7]=vr,c[8]=dr,c[9]=Cr,c[10]=Sr,c[11]=Ar,c[12]=xr,c[13]=_r,c[14]=Dr,c[15]=yr,c}function b(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function E(c,S){if(c===S){var X=S[1],Q=S[2],er=S[3],sr=S[6],fr=S[7],lr=S[11];c[1]=S[4],c[2]=S[8],c[3]=S[12],c[4]=X,c[6]=S[9],c[7]=S[13],c[8]=Q,c[9]=sr,c[11]=S[14],c[12]=er,c[13]=fr,c[14]=lr}else c[0]=S[0],c[1]=S[4],c[2]=S[8],c[3]=S[12],c[4]=S[1],c[5]=S[5],c[6]=S[9],c[7]=S[13],c[8]=S[2],c[9]=S[6],c[10]=S[10],c[11]=S[14],c[12]=S[3],c[13]=S[7],c[14]=S[11],c[15]=S[15];return c}function O(c,S){var X=S[0],Q=S[1],er=S[2],sr=S[3],fr=S[4],lr=S[5],vr=S[6],dr=S[7],Cr=S[8],Sr=S[9],Ar=S[10],xr=S[11],_r=S[12],Dr=S[13],yr=S[14],br=S[15],Br=X*lr-Q*fr,Pr=X*vr-er*fr,Er=X*dr-sr*fr,Tr=Q*vr-er*lr,Fr=Q*dr-sr*lr,kr=er*dr-sr*vr,qr=Cr*Dr-Sr*_r,Lr=Cr*yr-Ar*_r,Or=Cr*br-xr*_r,Nr=Sr*yr-Ar*Dr,zr=Sr*br-xr*Dr,jr=Ar*br-xr*yr,Rr=Br*jr-Pr*zr+Er*Nr+Tr*Or-Fr*Lr+kr*qr;return Rr?(Rr=1/Rr,c[0]=(lr*jr-vr*zr+dr*Nr)*Rr,c[1]=(er*zr-Q*jr-sr*Nr)*Rr,c[2]=(Dr*kr-yr*Fr+br*Tr)*Rr,c[3]=(Ar*Fr-Sr*kr-xr*Tr)*Rr,c[4]=(vr*Or-fr*jr-dr*Lr)*Rr,c[5]=(X*jr-er*Or+sr*Lr)*Rr,c[6]=(yr*Er-_r*kr-br*Pr)*Rr,c[7]=(Cr*kr-Ar*Er+xr*Pr)*Rr,c[8]=(fr*zr-lr*Or+dr*qr)*Rr,c[9]=(Q*Or-X*zr-sr*qr)*Rr,c[10]=(_r*Fr-Dr*Er+br*Br)*Rr,c[11]=(Sr*Er-Cr*Fr-xr*Br)*Rr,c[12]=(lr*Lr-fr*Nr-vr*qr)*Rr,c[13]=(X*Nr-Q*Lr+er*qr)*Rr,c[14]=(Dr*Pr-_r*Tr-yr*Br)*Rr,c[15]=(Cr*Tr-Sr*Pr+Ar*Br)*Rr,c):null}function p(c,S){var X=S[0],Q=S[1],er=S[2],sr=S[3],fr=S[4],lr=S[5],vr=S[6],dr=S[7],Cr=S[8],Sr=S[9],Ar=S[10],xr=S[11],_r=S[12],Dr=S[13],yr=S[14],br=S[15];return c[0]=lr*(Ar*br-xr*yr)-Sr*(vr*br-dr*yr)+Dr*(vr*xr-dr*Ar),c[1]=-(Q*(Ar*br-xr*yr)-Sr*(er*br-sr*yr)+Dr*(er*xr-sr*Ar)),c[2]=Q*(vr*br-dr*yr)-lr*(er*br-sr*yr)+Dr*(er*dr-sr*vr),c[3]=-(Q*(vr*xr-dr*Ar)-lr*(er*xr-sr*Ar)+Sr*(er*dr-sr*vr)),c[4]=-(fr*(Ar*br-xr*yr)-Cr*(vr*br-dr*yr)+_r*(vr*xr-dr*Ar)),c[5]=X*(Ar*br-xr*yr)-Cr*(er*br-sr*yr)+_r*(er*xr-sr*Ar),c[6]=-(X*(vr*br-dr*yr)-fr*(er*br-sr*yr)+_r*(er*dr-sr*vr)),c[7]=X*(vr*xr-dr*Ar)-fr*(er*xr-sr*Ar)+Cr*(er*dr-sr*vr),c[8]=fr*(Sr*br-xr*Dr)-Cr*(lr*br-dr*Dr)+_r*(lr*xr-dr*Sr),c[9]=-(X*(Sr*br-xr*Dr)-Cr*(Q*br-sr*Dr)+_r*(Q*xr-sr*Sr)),c[10]=X*(lr*br-dr*Dr)-fr*(Q*br-sr*Dr)+_r*(Q*dr-sr*lr),c[11]=-(X*(lr*xr-dr*Sr)-fr*(Q*xr-sr*Sr)+Cr*(Q*dr-sr*lr)),c[12]=-(fr*(Sr*yr-Ar*Dr)-Cr*(lr*yr-vr*Dr)+_r*(lr*Ar-vr*Sr)),c[13]=X*(Sr*yr-Ar*Dr)-Cr*(Q*yr-er*Dr)+_r*(Q*Ar-er*Sr),c[14]=-(X*(lr*yr-vr*Dr)-fr*(Q*yr-er*Dr)+_r*(Q*vr-er*lr)),c[15]=X*(lr*Ar-vr*Sr)-fr*(Q*Ar-er*Sr)+Cr*(Q*vr-er*lr),c}function g(c){var S=c[0],X=c[1],Q=c[2],er=c[3],sr=c[4],fr=c[5],lr=c[6],vr=c[7],dr=c[8],Cr=c[9],Sr=c[10],Ar=c[11],xr=c[12],_r=c[13],Dr=c[14],yr=c[15],br=S*fr-X*sr,Br=S*lr-Q*sr,Pr=S*vr-er*sr,Er=X*lr-Q*fr,Tr=X*vr-er*fr,Fr=Q*vr-er*lr,kr=dr*_r-Cr*xr,qr=dr*Dr-Sr*xr,Lr=dr*yr-Ar*xr,Or=Cr*Dr-Sr*_r,Nr=Cr*yr-Ar*_r,zr=Sr*yr-Ar*Dr;return br*zr-Br*Nr+Pr*Or+Er*Lr-Tr*qr+Fr*kr}function F(c,S,X){var Q=S[0],er=S[1],sr=S[2],fr=S[3],lr=S[4],vr=S[5],dr=S[6],Cr=S[7],Sr=S[8],Ar=S[9],xr=S[10],_r=S[11],Dr=S[12],yr=S[13],br=S[14],Br=S[15],Pr=X[0],Er=X[1],Tr=X[2],Fr=X[3];return c[0]=Pr*Q+Er*lr+Tr*Sr+Fr*Dr,c[1]=Pr*er+Er*vr+Tr*Ar+Fr*yr,c[2]=Pr*sr+Er*dr+Tr*xr+Fr*br,c[3]=Pr*fr+Er*Cr+Tr*_r+Fr*Br,Pr=X[4],Er=X[5],Tr=X[6],Fr=X[7],c[4]=Pr*Q+Er*lr+Tr*Sr+Fr*Dr,c[5]=Pr*er+Er*vr+Tr*Ar+Fr*yr,c[6]=Pr*sr+Er*dr+Tr*xr+Fr*br,c[7]=Pr*fr+Er*Cr+Tr*_r+Fr*Br,Pr=X[8],Er=X[9],Tr=X[10],Fr=X[11],c[8]=Pr*Q+Er*lr+Tr*Sr+Fr*Dr,c[9]=Pr*er+Er*vr+Tr*Ar+Fr*yr,c[10]=Pr*sr+Er*dr+Tr*xr+Fr*br,c[11]=Pr*fr+Er*Cr+Tr*_r+Fr*Br,Pr=X[12],Er=X[13],Tr=X[14],Fr=X[15],c[12]=Pr*Q+Er*lr+Tr*Sr+Fr*Dr,c[13]=Pr*er+Er*vr+Tr*Ar+Fr*yr,c[14]=Pr*sr+Er*dr+Tr*xr+Fr*br,c[15]=Pr*fr+Er*Cr+Tr*_r+Fr*Br,c}function R(c,S,X){var Q=X[0],er=X[1],sr=X[2],fr=void 0,lr=void 0,vr=void 0,dr=void 0,Cr=void 0,Sr=void 0,Ar=void 0,xr=void 0,_r=void 0,Dr=void 0,yr=void 0,br=void 0;return S===c?(c[12]=S[0]*Q+S[4]*er+S[8]*sr+S[12],c[13]=S[1]*Q+S[5]*er+S[9]*sr+S[13],c[14]=S[2]*Q+S[6]*er+S[10]*sr+S[14],c[15]=S[3]*Q+S[7]*er+S[11]*sr+S[15]):(fr=S[0],lr=S[1],vr=S[2],dr=S[3],Cr=S[4],Sr=S[5],Ar=S[6],xr=S[7],_r=S[8],Dr=S[9],yr=S[10],br=S[11],c[0]=fr,c[1]=lr,c[2]=vr,c[3]=dr,c[4]=Cr,c[5]=Sr,c[6]=Ar,c[7]=xr,c[8]=_r,c[9]=Dr,c[10]=yr,c[11]=br,c[12]=fr*Q+Cr*er+_r*sr+S[12],c[13]=lr*Q+Sr*er+Dr*sr+S[13],c[14]=vr*Q+Ar*er+yr*sr+S[14],c[15]=dr*Q+xr*er+br*sr+S[15]),c}function j(c,S,X){var Q=X[0],er=X[1],sr=X[2];return c[0]=S[0]*Q,c[1]=S[1]*Q,c[2]=S[2]*Q,c[3]=S[3]*Q,c[4]=S[4]*er,c[5]=S[5]*er,c[6]=S[6]*er,c[7]=S[7]*er,c[8]=S[8]*sr,c[9]=S[9]*sr,c[10]=S[10]*sr,c[11]=S[11]*sr,c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15],c}function u(c,S,X,Q){var er=Q[0],sr=Q[1],fr=Q[2],lr=Math.sqrt(er*er+sr*sr+fr*fr),vr=void 0,dr=void 0,Cr=void 0,Sr=void 0,Ar=void 0,xr=void 0,_r=void 0,Dr=void 0,yr=void 0,br=void 0,Br=void 0,Pr=void 0,Er=void 0,Tr=void 0,Fr=void 0,kr=void 0,qr=void 0,Lr=void 0,Or=void 0,Nr=void 0,zr=void 0,jr=void 0,Rr=void 0,Ir=void 0;return Math.abs(lr)<h.EPSILON?null:(lr=1/lr,er*=lr,sr*=lr,fr*=lr,vr=Math.sin(X),dr=Math.cos(X),Cr=1-dr,Sr=S[0],Ar=S[1],xr=S[2],_r=S[3],Dr=S[4],yr=S[5],br=S[6],Br=S[7],Pr=S[8],Er=S[9],Tr=S[10],Fr=S[11],kr=er*er*Cr+dr,qr=sr*er*Cr+fr*vr,Lr=fr*er*Cr-sr*vr,Or=er*sr*Cr-fr*vr,Nr=sr*sr*Cr+dr,zr=fr*sr*Cr+er*vr,jr=er*fr*Cr+sr*vr,Rr=sr*fr*Cr-er*vr,Ir=fr*fr*Cr+dr,c[0]=Sr*kr+Dr*qr+Pr*Lr,c[1]=Ar*kr+yr*qr+Er*Lr,c[2]=xr*kr+br*qr+Tr*Lr,c[3]=_r*kr+Br*qr+Fr*Lr,c[4]=Sr*Or+Dr*Nr+Pr*zr,c[5]=Ar*Or+yr*Nr+Er*zr,c[6]=xr*Or+br*Nr+Tr*zr,c[7]=_r*Or+Br*Nr+Fr*zr,c[8]=Sr*jr+Dr*Rr+Pr*Ir,c[9]=Ar*jr+yr*Rr+Er*Ir,c[10]=xr*jr+br*Rr+Tr*Ir,c[11]=_r*jr+Br*Rr+Fr*Ir,S!==c&&(c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15]),c)}function x(c,S,X){var Q=Math.sin(X),er=Math.cos(X),sr=S[4],fr=S[5],lr=S[6],vr=S[7],dr=S[8],Cr=S[9],Sr=S[10],Ar=S[11];return S!==c&&(c[0]=S[0],c[1]=S[1],c[2]=S[2],c[3]=S[3],c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15]),c[4]=sr*er+dr*Q,c[5]=fr*er+Cr*Q,c[6]=lr*er+Sr*Q,c[7]=vr*er+Ar*Q,c[8]=dr*er-sr*Q,c[9]=Cr*er-fr*Q,c[10]=Sr*er-lr*Q,c[11]=Ar*er-vr*Q,c}function N(c,S,X){var Q=Math.sin(X),er=Math.cos(X),sr=S[0],fr=S[1],lr=S[2],vr=S[3],dr=S[8],Cr=S[9],Sr=S[10],Ar=S[11];return S!==c&&(c[4]=S[4],c[5]=S[5],c[6]=S[6],c[7]=S[7],c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15]),c[0]=sr*er-dr*Q,c[1]=fr*er-Cr*Q,c[2]=lr*er-Sr*Q,c[3]=vr*er-Ar*Q,c[8]=sr*Q+dr*er,c[9]=fr*Q+Cr*er,c[10]=lr*Q+Sr*er,c[11]=vr*Q+Ar*er,c}function L(c,S,X){var Q=Math.sin(X),er=Math.cos(X),sr=S[0],fr=S[1],lr=S[2],vr=S[3],dr=S[4],Cr=S[5],Sr=S[6],Ar=S[7];return S!==c&&(c[8]=S[8],c[9]=S[9],c[10]=S[10],c[11]=S[11],c[12]=S[12],c[13]=S[13],c[14]=S[14],c[15]=S[15]),c[0]=sr*er+dr*Q,c[1]=fr*er+Cr*Q,c[2]=lr*er+Sr*Q,c[3]=vr*er+Ar*Q,c[4]=dr*er-sr*Q,c[5]=Cr*er-fr*Q,c[6]=Sr*er-lr*Q,c[7]=Ar*er-vr*Q,c}function G(c,S){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=S[0],c[13]=S[1],c[14]=S[2],c[15]=1,c}function $(c,S){return c[0]=S[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=S[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=S[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function ar(c,S,X){var Q=X[0],er=X[1],sr=X[2],fr=Math.sqrt(Q*Q+er*er+sr*sr),lr=void 0,vr=void 0,dr=void 0;return Math.abs(fr)<h.EPSILON?null:(fr=1/fr,Q*=fr,er*=fr,sr*=fr,lr=Math.sin(S),vr=Math.cos(S),dr=1-vr,c[0]=Q*Q*dr+vr,c[1]=er*Q*dr+sr*lr,c[2]=sr*Q*dr-er*lr,c[3]=0,c[4]=Q*er*dr-sr*lr,c[5]=er*er*dr+vr,c[6]=sr*er*dr+Q*lr,c[7]=0,c[8]=Q*sr*dr+er*lr,c[9]=er*sr*dr-Q*lr,c[10]=sr*sr*dr+vr,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function pr(c,S){var X=Math.sin(S),Q=Math.cos(S);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=Q,c[6]=X,c[7]=0,c[8]=0,c[9]=-X,c[10]=Q,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Mr(c,S){var X=Math.sin(S),Q=Math.cos(S);return c[0]=Q,c[1]=0,c[2]=-X,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=X,c[9]=0,c[10]=Q,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function wr(c,S){var X=Math.sin(S),Q=Math.cos(S);return c[0]=Q,c[1]=X,c[2]=0,c[3]=0,c[4]=-X,c[5]=Q,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Y(c,S,X){var Q=S[0],er=S[1],sr=S[2],fr=S[3],lr=Q+Q,vr=er+er,dr=sr+sr,Cr=Q*lr,Sr=Q*vr,Ar=Q*dr,xr=er*vr,_r=er*dr,Dr=sr*dr,yr=fr*lr,br=fr*vr,Br=fr*dr;return c[0]=1-(xr+Dr),c[1]=Sr+Br,c[2]=Ar-br,c[3]=0,c[4]=Sr-Br,c[5]=1-(Cr+Dr),c[6]=_r+yr,c[7]=0,c[8]=Ar+br,c[9]=_r-yr,c[10]=1-(Cr+xr),c[11]=0,c[12]=X[0],c[13]=X[1],c[14]=X[2],c[15]=1,c}function D(c,S){return c[0]=S[12],c[1]=S[13],c[2]=S[14],c}function I(c,S){var X=S[0],Q=S[1],er=S[2],sr=S[4],fr=S[5],lr=S[6],vr=S[8],dr=S[9],Cr=S[10];return c[0]=Math.sqrt(X*X+Q*Q+er*er),c[1]=Math.sqrt(sr*sr+fr*fr+lr*lr),c[2]=Math.sqrt(vr*vr+dr*dr+Cr*Cr),c}function tr(c,S){var X=S[0]+S[5]+S[10],Q=0;return X>0?(Q=Math.sqrt(X+1)*2,c[3]=.25*Q,c[0]=(S[6]-S[9])/Q,c[1]=(S[8]-S[2])/Q,c[2]=(S[1]-S[4])/Q):S[0]>S[5]&S[0]>S[10]?(Q=Math.sqrt(1+S[0]-S[5]-S[10])*2,c[3]=(S[6]-S[9])/Q,c[0]=.25*Q,c[1]=(S[1]+S[4])/Q,c[2]=(S[8]+S[2])/Q):S[5]>S[10]?(Q=Math.sqrt(1+S[5]-S[0]-S[10])*2,c[3]=(S[8]-S[2])/Q,c[0]=(S[1]+S[4])/Q,c[1]=.25*Q,c[2]=(S[6]+S[9])/Q):(Q=Math.sqrt(1+S[10]-S[0]-S[5])*2,c[3]=(S[1]-S[4])/Q,c[0]=(S[8]+S[2])/Q,c[1]=(S[6]+S[9])/Q,c[2]=.25*Q),c}function ir(c,S,X,Q){var er=S[0],sr=S[1],fr=S[2],lr=S[3],vr=er+er,dr=sr+sr,Cr=fr+fr,Sr=er*vr,Ar=er*dr,xr=er*Cr,_r=sr*dr,Dr=sr*Cr,yr=fr*Cr,br=lr*vr,Br=lr*dr,Pr=lr*Cr,Er=Q[0],Tr=Q[1],Fr=Q[2];return c[0]=(1-(_r+yr))*Er,c[1]=(Ar+Pr)*Er,c[2]=(xr-Br)*Er,c[3]=0,c[4]=(Ar-Pr)*Tr,c[5]=(1-(Sr+yr))*Tr,c[6]=(Dr+br)*Tr,c[7]=0,c[8]=(xr+Br)*Fr,c[9]=(Dr-br)*Fr,c[10]=(1-(Sr+_r))*Fr,c[11]=0,c[12]=X[0],c[13]=X[1],c[14]=X[2],c[15]=1,c}function or(c,S,X,Q,er){var sr=S[0],fr=S[1],lr=S[2],vr=S[3],dr=sr+sr,Cr=fr+fr,Sr=lr+lr,Ar=sr*dr,xr=sr*Cr,_r=sr*Sr,Dr=fr*Cr,yr=fr*Sr,br=lr*Sr,Br=vr*dr,Pr=vr*Cr,Er=vr*Sr,Tr=Q[0],Fr=Q[1],kr=Q[2],qr=er[0],Lr=er[1],Or=er[2];return c[0]=(1-(Dr+br))*Tr,c[1]=(xr+Er)*Tr,c[2]=(_r-Pr)*Tr,c[3]=0,c[4]=(xr-Er)*Fr,c[5]=(1-(Ar+br))*Fr,c[6]=(yr+Br)*Fr,c[7]=0,c[8]=(_r+Pr)*kr,c[9]=(yr-Br)*kr,c[10]=(1-(Ar+Dr))*kr,c[11]=0,c[12]=X[0]+qr-(c[0]*qr+c[4]*Lr+c[8]*Or),c[13]=X[1]+Lr-(c[1]*qr+c[5]*Lr+c[9]*Or),c[14]=X[2]+Or-(c[2]*qr+c[6]*Lr+c[10]*Or),c[15]=1,c}function gr(c,S){var X=S[0],Q=S[1],er=S[2],sr=S[3],fr=X+X,lr=Q+Q,vr=er+er,dr=X*fr,Cr=Q*fr,Sr=Q*lr,Ar=er*fr,xr=er*lr,_r=er*vr,Dr=sr*fr,yr=sr*lr,br=sr*vr;return c[0]=1-Sr-_r,c[1]=Cr+br,c[2]=Ar-yr,c[3]=0,c[4]=Cr-br,c[5]=1-dr-_r,c[6]=xr+Dr,c[7]=0,c[8]=Ar+yr,c[9]=xr-Dr,c[10]=1-dr-Sr,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function _(c,S,X,Q,er,sr,fr){var lr=1/(X-S),vr=1/(er-Q),dr=1/(sr-fr);return c[0]=sr*2*lr,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=sr*2*vr,c[6]=0,c[7]=0,c[8]=(X+S)*lr,c[9]=(er+Q)*vr,c[10]=(fr+sr)*dr,c[11]=-1,c[12]=0,c[13]=0,c[14]=fr*sr*2*dr,c[15]=0,c}function w(c,S,X,Q,er){var sr=1/Math.tan(S/2),fr=1/(Q-er);return c[0]=sr/X,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=sr,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=(er+Q)*fr,c[11]=-1,c[12]=0,c[13]=0,c[14]=2*er*Q*fr,c[15]=0,c}function q(c,S,X,Q){var er=Math.tan(S.upDegrees*Math.PI/180),sr=Math.tan(S.downDegrees*Math.PI/180),fr=Math.tan(S.leftDegrees*Math.PI/180),lr=Math.tan(S.rightDegrees*Math.PI/180),vr=2/(fr+lr),dr=2/(er+sr);return c[0]=vr,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=dr,c[6]=0,c[7]=0,c[8]=-((fr-lr)*vr*.5),c[9]=(er-sr)*dr*.5,c[10]=Q/(X-Q),c[11]=-1,c[12]=0,c[13]=0,c[14]=Q*X/(X-Q),c[15]=0,c}function K(c,S,X,Q,er,sr,fr){var lr=1/(S-X),vr=1/(Q-er),dr=1/(sr-fr);return c[0]=-2*lr,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*vr,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*dr,c[11]=0,c[12]=(S+X)*lr,c[13]=(er+Q)*vr,c[14]=(fr+sr)*dr,c[15]=1,c}function H(c,S,X,Q){var er=void 0,sr=void 0,fr=void 0,lr=void 0,vr=void 0,dr=void 0,Cr=void 0,Sr=void 0,Ar=void 0,xr=void 0,_r=S[0],Dr=S[1],yr=S[2],br=Q[0],Br=Q[1],Pr=Q[2],Er=X[0],Tr=X[1],Fr=X[2];return Math.abs(_r-Er)<h.EPSILON&&Math.abs(Dr-Tr)<h.EPSILON&&Math.abs(yr-Fr)<h.EPSILON?mat4.identity(c):(Cr=_r-Er,Sr=Dr-Tr,Ar=yr-Fr,xr=1/Math.sqrt(Cr*Cr+Sr*Sr+Ar*Ar),Cr*=xr,Sr*=xr,Ar*=xr,er=Br*Ar-Pr*Sr,sr=Pr*Cr-br*Ar,fr=br*Sr-Br*Cr,xr=Math.sqrt(er*er+sr*sr+fr*fr),xr?(xr=1/xr,er*=xr,sr*=xr,fr*=xr):(er=0,sr=0,fr=0),lr=Sr*fr-Ar*sr,vr=Ar*er-Cr*fr,dr=Cr*sr-Sr*er,xr=Math.sqrt(lr*lr+vr*vr+dr*dr),xr?(xr=1/xr,lr*=xr,vr*=xr,dr*=xr):(lr=0,vr=0,dr=0),c[0]=er,c[1]=lr,c[2]=Cr,c[3]=0,c[4]=sr,c[5]=vr,c[6]=Sr,c[7]=0,c[8]=fr,c[9]=dr,c[10]=Ar,c[11]=0,c[12]=-(er*_r+sr*Dr+fr*yr),c[13]=-(lr*_r+vr*Dr+dr*yr),c[14]=-(Cr*_r+Sr*Dr+Ar*yr),c[15]=1,c)}function Z(c,S,X,Q){var er=S[0],sr=S[1],fr=S[2],lr=Q[0],vr=Q[1],dr=Q[2],Cr=er-X[0],Sr=sr-X[1],Ar=fr-X[2],xr=Cr*Cr+Sr*Sr+Ar*Ar;xr>0&&(xr=1/Math.sqrt(xr),Cr*=xr,Sr*=xr,Ar*=xr);var _r=vr*Ar-dr*Sr,Dr=dr*Cr-lr*Ar,yr=lr*Sr-vr*Cr;return c[0]=_r,c[1]=Dr,c[2]=yr,c[3]=0,c[4]=Sr*yr-Ar*Dr,c[5]=Ar*_r-Cr*yr,c[6]=Cr*Dr-Sr*_r,c[7]=0,c[8]=Cr,c[9]=Sr,c[10]=Ar,c[11]=0,c[12]=er,c[13]=sr,c[14]=fr,c[15]=1,c}function rr(c){return"mat4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+", "+c[14]+", "+c[15]+")"}function hr(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2)+Math.pow(c[9],2)+Math.pow(c[10],2)+Math.pow(c[11],2)+Math.pow(c[12],2)+Math.pow(c[13],2)+Math.pow(c[14],2)+Math.pow(c[15],2))}function mr(c,S,X){return c[0]=S[0]+X[0],c[1]=S[1]+X[1],c[2]=S[2]+X[2],c[3]=S[3]+X[3],c[4]=S[4]+X[4],c[5]=S[5]+X[5],c[6]=S[6]+X[6],c[7]=S[7]+X[7],c[8]=S[8]+X[8],c[9]=S[9]+X[9],c[10]=S[10]+X[10],c[11]=S[11]+X[11],c[12]=S[12]+X[12],c[13]=S[13]+X[13],c[14]=S[14]+X[14],c[15]=S[15]+X[15],c}function z(c,S,X){return c[0]=S[0]-X[0],c[1]=S[1]-X[1],c[2]=S[2]-X[2],c[3]=S[3]-X[3],c[4]=S[4]-X[4],c[5]=S[5]-X[5],c[6]=S[6]-X[6],c[7]=S[7]-X[7],c[8]=S[8]-X[8],c[9]=S[9]-X[9],c[10]=S[10]-X[10],c[11]=S[11]-X[11],c[12]=S[12]-X[12],c[13]=S[13]-X[13],c[14]=S[14]-X[14],c[15]=S[15]-X[15],c}function J(c,S,X){return c[0]=S[0]*X,c[1]=S[1]*X,c[2]=S[2]*X,c[3]=S[3]*X,c[4]=S[4]*X,c[5]=S[5]*X,c[6]=S[6]*X,c[7]=S[7]*X,c[8]=S[8]*X,c[9]=S[9]*X,c[10]=S[10]*X,c[11]=S[11]*X,c[12]=S[12]*X,c[13]=S[13]*X,c[14]=S[14]*X,c[15]=S[15]*X,c}function nr(c,S,X,Q){return c[0]=S[0]+X[0]*Q,c[1]=S[1]+X[1]*Q,c[2]=S[2]+X[2]*Q,c[3]=S[3]+X[3]*Q,c[4]=S[4]+X[4]*Q,c[5]=S[5]+X[5]*Q,c[6]=S[6]+X[6]*Q,c[7]=S[7]+X[7]*Q,c[8]=S[8]+X[8]*Q,c[9]=S[9]+X[9]*Q,c[10]=S[10]+X[10]*Q,c[11]=S[11]+X[11]*Q,c[12]=S[12]+X[12]*Q,c[13]=S[13]+X[13]*Q,c[14]=S[14]+X[14]*Q,c[15]=S[15]+X[15]*Q,c}function cr(c,S){return c[0]===S[0]&&c[1]===S[1]&&c[2]===S[2]&&c[3]===S[3]&&c[4]===S[4]&&c[5]===S[5]&&c[6]===S[6]&&c[7]===S[7]&&c[8]===S[8]&&c[9]===S[9]&&c[10]===S[10]&&c[11]===S[11]&&c[12]===S[12]&&c[13]===S[13]&&c[14]===S[14]&&c[15]===S[15]}function ur(c,S){var X=c[0],Q=c[1],er=c[2],sr=c[3],fr=c[4],lr=c[5],vr=c[6],dr=c[7],Cr=c[8],Sr=c[9],Ar=c[10],xr=c[11],_r=c[12],Dr=c[13],yr=c[14],br=c[15],Br=S[0],Pr=S[1],Er=S[2],Tr=S[3],Fr=S[4],kr=S[5],qr=S[6],Lr=S[7],Or=S[8],Nr=S[9],zr=S[10],jr=S[11],Rr=S[12],Ir=S[13],Vr=S[14],Gr=S[15];return Math.abs(X-Br)<=h.EPSILON*Math.max(1,Math.abs(X),Math.abs(Br))&&Math.abs(Q-Pr)<=h.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Pr))&&Math.abs(er-Er)<=h.EPSILON*Math.max(1,Math.abs(er),Math.abs(Er))&&Math.abs(sr-Tr)<=h.EPSILON*Math.max(1,Math.abs(sr),Math.abs(Tr))&&Math.abs(fr-Fr)<=h.EPSILON*Math.max(1,Math.abs(fr),Math.abs(Fr))&&Math.abs(lr-kr)<=h.EPSILON*Math.max(1,Math.abs(lr),Math.abs(kr))&&Math.abs(vr-qr)<=h.EPSILON*Math.max(1,Math.abs(vr),Math.abs(qr))&&Math.abs(dr-Lr)<=h.EPSILON*Math.max(1,Math.abs(dr),Math.abs(Lr))&&Math.abs(Cr-Or)<=h.EPSILON*Math.max(1,Math.abs(Cr),Math.abs(Or))&&Math.abs(Sr-Nr)<=h.EPSILON*Math.max(1,Math.abs(Sr),Math.abs(Nr))&&Math.abs(Ar-zr)<=h.EPSILON*Math.max(1,Math.abs(Ar),Math.abs(zr))&&Math.abs(xr-jr)<=h.EPSILON*Math.max(1,Math.abs(xr),Math.abs(jr))&&Math.abs(_r-Rr)<=h.EPSILON*Math.max(1,Math.abs(_r),Math.abs(Rr))&&Math.abs(Dr-Ir)<=h.EPSILON*Math.max(1,Math.abs(Dr),Math.abs(Ir))&&Math.abs(yr-Vr)<=h.EPSILON*Math.max(1,Math.abs(yr),Math.abs(Vr))&&Math.abs(br-Gr)<=h.EPSILON*Math.max(1,Math.abs(br),Math.abs(Gr))}t.mul=F,t.sub=z},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=E,t.identity=O,t.setAxisAngle=p,t.getAxisAngle=g,t.multiply=F,t.rotateX=R,t.rotateY=j,t.rotateZ=u,t.calculateW=x,t.slerp=N,t.invert=L,t.conjugate=G,t.fromMat3=$,t.fromEuler=ar,t.str=pr;var f=s(0),h=b(f),l=s(1),v=b(l),M=s(2),m=b(M),d=s(3),y=b(d);function b(D){if(D&&D.__esModule)return D;var I={};if(D!=null)for(var tr in D)Object.prototype.hasOwnProperty.call(D,tr)&&(I[tr]=D[tr]);return I.default=D,I}function E(){var D=new h.ARRAY_TYPE(4);return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D}function O(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D}function p(D,I,tr){tr=tr*.5;var ir=Math.sin(tr);return D[0]=ir*I[0],D[1]=ir*I[1],D[2]=ir*I[2],D[3]=Math.cos(tr),D}function g(D,I){var tr=Math.acos(I[3])*2,ir=Math.sin(tr/2);return ir!=0?(D[0]=I[0]/ir,D[1]=I[1]/ir,D[2]=I[2]/ir):(D[0]=1,D[1]=0,D[2]=0),tr}function F(D,I,tr){var ir=I[0],or=I[1],gr=I[2],_=I[3],w=tr[0],q=tr[1],K=tr[2],H=tr[3];return D[0]=ir*H+_*w+or*K-gr*q,D[1]=or*H+_*q+gr*w-ir*K,D[2]=gr*H+_*K+ir*q-or*w,D[3]=_*H-ir*w-or*q-gr*K,D}function R(D,I,tr){tr*=.5;var ir=I[0],or=I[1],gr=I[2],_=I[3],w=Math.sin(tr),q=Math.cos(tr);return D[0]=ir*q+_*w,D[1]=or*q+gr*w,D[2]=gr*q-or*w,D[3]=_*q-ir*w,D}function j(D,I,tr){tr*=.5;var ir=I[0],or=I[1],gr=I[2],_=I[3],w=Math.sin(tr),q=Math.cos(tr);return D[0]=ir*q-gr*w,D[1]=or*q+_*w,D[2]=gr*q+ir*w,D[3]=_*q-or*w,D}function u(D,I,tr){tr*=.5;var ir=I[0],or=I[1],gr=I[2],_=I[3],w=Math.sin(tr),q=Math.cos(tr);return D[0]=ir*q+or*w,D[1]=or*q-ir*w,D[2]=gr*q+_*w,D[3]=_*q-gr*w,D}function x(D,I){var tr=I[0],ir=I[1],or=I[2];return D[0]=tr,D[1]=ir,D[2]=or,D[3]=Math.sqrt(Math.abs(1-tr*tr-ir*ir-or*or)),D}function N(D,I,tr,ir){var or=I[0],gr=I[1],_=I[2],w=I[3],q=tr[0],K=tr[1],H=tr[2],Z=tr[3],rr=void 0,hr=void 0,mr=void 0,z=void 0,J=void 0;return hr=or*q+gr*K+_*H+w*Z,hr<0&&(hr=-hr,q=-q,K=-K,H=-H,Z=-Z),1-hr>1e-6?(rr=Math.acos(hr),mr=Math.sin(rr),z=Math.sin((1-ir)*rr)/mr,J=Math.sin(ir*rr)/mr):(z=1-ir,J=ir),D[0]=z*or+J*q,D[1]=z*gr+J*K,D[2]=z*_+J*H,D[3]=z*w+J*Z,D}function L(D,I){var tr=I[0],ir=I[1],or=I[2],gr=I[3],_=tr*tr+ir*ir+or*or+gr*gr,w=_?1/_:0;return D[0]=-tr*w,D[1]=-ir*w,D[2]=-or*w,D[3]=gr*w,D}function G(D,I){return D[0]=-I[0],D[1]=-I[1],D[2]=-I[2],D[3]=I[3],D}function $(D,I){var tr=I[0]+I[4]+I[8],ir=void 0;if(tr>0)ir=Math.sqrt(tr+1),D[3]=.5*ir,ir=.5/ir,D[0]=(I[5]-I[7])*ir,D[1]=(I[6]-I[2])*ir,D[2]=(I[1]-I[3])*ir;else{var or=0;I[4]>I[0]&&(or=1),I[8]>I[or*3+or]&&(or=2);var gr=(or+1)%3,_=(or+2)%3;ir=Math.sqrt(I[or*3+or]-I[gr*3+gr]-I[_*3+_]+1),D[or]=.5*ir,ir=.5/ir,D[3]=(I[gr*3+_]-I[_*3+gr])*ir,D[gr]=(I[gr*3+or]+I[or*3+gr])*ir,D[_]=(I[_*3+or]+I[or*3+_])*ir}return D}function ar(D,I,tr,ir){var or=.5*Math.PI/180;I*=or,tr*=or,ir*=or;var gr=Math.sin(I),_=Math.cos(I),w=Math.sin(tr),q=Math.cos(tr),K=Math.sin(ir),H=Math.cos(ir);return D[0]=gr*q*H-_*w*K,D[1]=_*w*H+gr*q*K,D[2]=_*q*K-gr*w*H,D[3]=_*q*H+gr*w*K,D}function pr(D){return"quat("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+")"}t.clone=y.clone,t.fromValues=y.fromValues,t.copy=y.copy,t.set=y.set,t.add=y.add,t.mul=F,t.scale=y.scale,t.dot=y.dot,t.lerp=y.lerp;var Mr=t.length=y.length;t.len=Mr;var wr=t.squaredLength=y.squaredLength;t.sqrLen=wr;var Y=t.normalize=y.normalize;t.exactEquals=y.exactEquals,t.equals=y.equals,t.rotationTo=function(){var D=m.create(),I=m.fromValues(1,0,0),tr=m.fromValues(0,1,0);return function(ir,or,gr){var _=m.dot(or,gr);return _<-.999999?(m.cross(D,I,or),m.len(D)<1e-6&&m.cross(D,tr,or),m.normalize(D,D),p(ir,D,Math.PI),ir):_>.999999?(ir[0]=0,ir[1]=0,ir[2]=0,ir[3]=1,ir):(m.cross(D,or,gr),ir[0]=D[0],ir[1]=D[1],ir[2]=D[2],ir[3]=1+_,Y(ir,ir))}}(),t.sqlerp=function(){var D=E(),I=E();return function(tr,ir,or,gr,_,w){return N(D,ir,_,w),N(I,or,gr,w),N(tr,D,I,2*w*(1-w)),tr}}(),t.setAxes=function(){var D=v.create();return function(I,tr,ir,or){return D[0]=ir[0],D[3]=ir[1],D[6]=ir[2],D[1]=or[0],D[4]=or[1],D[7]=or[2],D[2]=-tr[0],D[5]=-tr[1],D[8]=-tr[2],Y(I,$(I,D))}}()},function(a,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=v,t.clone=M,t.fromValues=m,t.copy=d,t.set=y,t.add=b,t.subtract=E,t.multiply=O,t.divide=p,t.ceil=g,t.floor=F,t.min=R,t.max=j,t.round=u,t.scale=x,t.scaleAndAdd=N,t.distance=L,t.squaredDistance=G,t.length=$,t.squaredLength=ar,t.negate=pr,t.inverse=Mr,t.normalize=wr,t.dot=Y,t.cross=D,t.lerp=I,t.random=tr,t.transformMat2=ir,t.transformMat2d=or,t.transformMat3=gr,t.transformMat4=_,t.str=w,t.exactEquals=q,t.equals=K;var f=s(0),h=l(f);function l(H){if(H&&H.__esModule)return H;var Z={};if(H!=null)for(var rr in H)Object.prototype.hasOwnProperty.call(H,rr)&&(Z[rr]=H[rr]);return Z.default=H,Z}function v(){var H=new h.ARRAY_TYPE(2);return H[0]=0,H[1]=0,H}function M(H){var Z=new h.ARRAY_TYPE(2);return Z[0]=H[0],Z[1]=H[1],Z}function m(H,Z){var rr=new h.ARRAY_TYPE(2);return rr[0]=H,rr[1]=Z,rr}function d(H,Z){return H[0]=Z[0],H[1]=Z[1],H}function y(H,Z,rr){return H[0]=Z,H[1]=rr,H}function b(H,Z,rr){return H[0]=Z[0]+rr[0],H[1]=Z[1]+rr[1],H}function E(H,Z,rr){return H[0]=Z[0]-rr[0],H[1]=Z[1]-rr[1],H}function O(H,Z,rr){return H[0]=Z[0]*rr[0],H[1]=Z[1]*rr[1],H}function p(H,Z,rr){return H[0]=Z[0]/rr[0],H[1]=Z[1]/rr[1],H}function g(H,Z){return H[0]=Math.ceil(Z[0]),H[1]=Math.ceil(Z[1]),H}function F(H,Z){return H[0]=Math.floor(Z[0]),H[1]=Math.floor(Z[1]),H}function R(H,Z,rr){return H[0]=Math.min(Z[0],rr[0]),H[1]=Math.min(Z[1],rr[1]),H}function j(H,Z,rr){return H[0]=Math.max(Z[0],rr[0]),H[1]=Math.max(Z[1],rr[1]),H}function u(H,Z){return H[0]=Math.round(Z[0]),H[1]=Math.round(Z[1]),H}function x(H,Z,rr){return H[0]=Z[0]*rr,H[1]=Z[1]*rr,H}function N(H,Z,rr,hr){return H[0]=Z[0]+rr[0]*hr,H[1]=Z[1]+rr[1]*hr,H}function L(H,Z){var rr=Z[0]-H[0],hr=Z[1]-H[1];return Math.sqrt(rr*rr+hr*hr)}function G(H,Z){var rr=Z[0]-H[0],hr=Z[1]-H[1];return rr*rr+hr*hr}function $(H){var Z=H[0],rr=H[1];return Math.sqrt(Z*Z+rr*rr)}function ar(H){var Z=H[0],rr=H[1];return Z*Z+rr*rr}function pr(H,Z){return H[0]=-Z[0],H[1]=-Z[1],H}function Mr(H,Z){return H[0]=1/Z[0],H[1]=1/Z[1],H}function wr(H,Z){var rr=Z[0],hr=Z[1],mr=rr*rr+hr*hr;return mr>0&&(mr=1/Math.sqrt(mr),H[0]=Z[0]*mr,H[1]=Z[1]*mr),H}function Y(H,Z){return H[0]*Z[0]+H[1]*Z[1]}function D(H,Z,rr){var hr=Z[0]*rr[1]-Z[1]*rr[0];return H[0]=H[1]=0,H[2]=hr,H}function I(H,Z,rr,hr){var mr=Z[0],z=Z[1];return H[0]=mr+hr*(rr[0]-mr),H[1]=z+hr*(rr[1]-z),H}function tr(H,Z){Z=Z||1;var rr=h.RANDOM()*2*Math.PI;return H[0]=Math.cos(rr)*Z,H[1]=Math.sin(rr)*Z,H}function ir(H,Z,rr){var hr=Z[0],mr=Z[1];return H[0]=rr[0]*hr+rr[2]*mr,H[1]=rr[1]*hr+rr[3]*mr,H}function or(H,Z,rr){var hr=Z[0],mr=Z[1];return H[0]=rr[0]*hr+rr[2]*mr+rr[4],H[1]=rr[1]*hr+rr[3]*mr+rr[5],H}function gr(H,Z,rr){var hr=Z[0],mr=Z[1];return H[0]=rr[0]*hr+rr[3]*mr+rr[6],H[1]=rr[1]*hr+rr[4]*mr+rr[7],H}function _(H,Z,rr){var hr=Z[0],mr=Z[1];return H[0]=rr[0]*hr+rr[4]*mr+rr[12],H[1]=rr[1]*hr+rr[5]*mr+rr[13],H}function w(H){return"vec2("+H[0]+", "+H[1]+")"}function q(H,Z){return H[0]===Z[0]&&H[1]===Z[1]}function K(H,Z){var rr=H[0],hr=H[1],mr=Z[0],z=Z[1];return Math.abs(rr-mr)<=h.EPSILON*Math.max(1,Math.abs(rr),Math.abs(mr))&&Math.abs(hr-z)<=h.EPSILON*Math.max(1,Math.abs(hr),Math.abs(z))}t.len=$,t.sub=E,t.mul=O,t.div=p,t.dist=L,t.sqrDist=G,t.sqrLen=ar,t.forEach=function(){var H=v();return function(Z,rr,hr,mr,z,J){var nr=void 0,cr=void 0;for(rr||(rr=2),hr||(hr=0),mr?cr=Math.min(mr*rr+hr,Z.length):cr=Z.length,nr=hr;nr<cr;nr+=rr)H[0]=Z[nr],H[1]=Z[nr+1],z(H,H,J),Z[nr]=H[0],Z[nr+1]=H[1];return Z}}()}])})},{}],9:[function(e,r,i){/**
 * AUTHOR OF INITIAL JS LIBRARY
 * k-d Tree JavaScript - V 1.0
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */function a(f,h,l){this.obj=f,this.left=null,this.right=null,this.parent=l,this.dimension=h}function t(f,h,l){var v=this;function M(m,d,y){var b=d%l.length,E,O;return m.length===0?null:m.length===1?new a(m[0],b,y):(m.sort(function(p,g){return p[l[b]]-g[l[b]]}),E=Math.floor(m.length/2),O=new a(m[E],b,y),O.left=M(m.slice(0,E),d+1,O),O.right=M(m.slice(E+1),d+1,O),O)}this.root=M(f,0,null),this.insert=function(m){function d(O,p){if(O===null)return p;var g=l[O.dimension];return m[g]<O.obj[g]?d(O.left,O):d(O.right,O)}var y=d(this.root,null),b,E;if(y===null){this.root=new a(m,0,null);return}b=new a(m,(y.dimension+1)%l.length,y),E=l[y.dimension],m[E]<y.obj[E]?y.left=b:y.right=b},this.remove=function(m){var d;function y(E){if(E===null)return null;if(E.obj===m)return E;var O=l[E.dimension];return m[O]<E.obj[O]?y(E.left):y(E.right)}function b(E){var O,p,g;function F(j,u){var x,N,L,G,$;return j===null?null:(x=l[u],j.dimension===u?j.right!==null?F(j.right,u):j:(N=j.obj[x],L=F(j.left,u),G=F(j.right,u),$=j,L!==null&&L.obj[x]>N&&($=L),G!==null&&G.obj[x]>$.obj[x]&&($=G),$))}function R(j,u){var x,N,L,G,$;return j===null?null:(x=l[u],j.dimension===u?j.left!==null?R(j.left,u):j:(N=j.obj[x],L=R(j.left,u),G=R(j.right,u),$=j,L!==null&&L.obj[x]<N&&($=L),G!==null&&G.obj[x]<$.obj[x]&&($=G),$))}if(E.left===null&&E.right===null){if(E.parent===null){v.root=null;return}g=l[E.parent.dimension],E.obj[g]<E.parent.obj[g]?E.parent.left=null:E.parent.right=null;return}E.left!==null?O=F(E.left,E.dimension):O=R(E.right,E.dimension),p=O.obj,b(O),E.obj=p}d=y(v.root),d!==null&&b(d)},this.nearest=function(m,d,y){var b,E,O;O=new s(function(g){return-g[1]});function p(g){if(!v.root)return[];var F,R=l[g.dimension],j=h(m,g.obj),u={},x,N,L;function G($,ar){O.push([$,ar]),O.size()>d&&O.pop()}for(L=0;L<l.length;L+=1)L===g.dimension?u[l[L]]=m[l[L]]:u[l[L]]=g.obj[l[L]];if(x=h(u,g.obj),g.right===null&&g.left===null){(O.size()<d||j<O.peek()[1])&&G(g,j);return}g.right===null?F=g.left:g.left===null?F=g.right:m[R]<g.obj[R]?F=g.left:F=g.right,p(F),(O.size()<d||j<O.peek()[1])&&G(g,j),(O.size()<d||Math.abs(x)<O.peek()[1])&&(F===g.left?N=g.right:N=g.left,N!==null&&p(N))}if(y)for(b=0;b<d;b+=1)O.push([null,y]);for(p(v.root),E=[],b=0;b<d&&b<O.content.length;b+=1)O.content[b][0]&&E.push([O.content[b][0].obj,O.content[b][1]]);return E},this.balanceFactor=function(){function m(y){return y===null?0:Math.max(m(y.left),m(y.right))+1}function d(y){return y===null?0:d(y.left)+d(y.right)+1}return m(v.root)/(Math.log(d(v.root))/Math.log(2))}}function s(f){this.content=[],this.scoreFunction=f}s.prototype={push:function(f){this.content.push(f),this.bubbleUp(this.content.length-1)},pop:function(){var f=this.content[0],h=this.content.pop();return this.content.length>0&&(this.content[0]=h,this.sinkDown(0)),f},peek:function(){return this.content[0]},remove:function(f){for(var h=this.content.length,l=0;l<h;l++)if(this.content[l]==f){var v=this.content.pop();l!=h-1&&(this.content[l]=v,this.scoreFunction(v)<this.scoreFunction(f)?this.bubbleUp(l):this.sinkDown(l));return}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(f){for(var h=this.content[f];f>0;){var l=Math.floor((f+1)/2)-1,v=this.content[l];if(this.scoreFunction(h)<this.scoreFunction(v))this.content[l]=h,this.content[f]=v,f=l;else break}},sinkDown:function(f){for(var h=this.content.length,l=this.content[f],v=this.scoreFunction(l);;){var M=(f+1)*2,m=M-1,d=null;if(m<h){var y=this.content[m],b=this.scoreFunction(y);b<v&&(d=m)}if(M<h){var E=this.content[M],O=this.scoreFunction(E);O<(d==null?v:b)&&(d=M)}if(d!=null)this.content[f]=this.content[d],this.content[d]=l,f=d;else break}}},r.exports={createKdTree:function(f,h,l){return new t(f,h,l)}}},{}],10:[function(e,r,i){r.exports={name:"serve-sofa-hrir",exports:"serveSofaHrir",version:"0.4.2",description:"Utility to fetch and shape sofa formated HRIR from server",main:"./dist/",standalone:"serveSofaHrir",scripts:{lint:"eslint ./src/ ./test/ && jscs --verbose ./src/ ./test/","lint-examples":"eslint -c examples/.eslintrc ./examples/*.html",compile:"rm -rf ./dist && babel ./src/ --out-dir ./dist/",browserify:"browserify ./src/index.js -t [ babelify ] --standalone serveSofaHrir > serveSofaHrir.js",bundle:"npm run lint && npm run test && npm run doc && npm run compile && npm run browserify",doc:"esdoc -c esdoc.json",test:"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | tape-run","test-browser":"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | testling -u","test-listen":"browserify test/*/*_listen.js -t [ babelify ] | tape-run","test-issues":"browserify test/*/*_issues.js -t [ babelify ] | tape-run",watch:"watch 'npm run browserify && echo $( date ): browserified' ./src/"},authors:["Jean-Philippe.Lambert@ircam.fr","Arnau Juli <arnau.julia@gmail.com>","Samuel.Goldszmidt@ircam.fr","David.Poirier-Quinot@ircam.fr"],license:"BSD-3-Clause",dependencies:{"fractional-delay":"git://github.com/Ircam-RnD/fractional-delay#gh-pages","gl-matrix":"^2.4.0","kd.tree":"akshaylive/node-kdt#39bc780704a324393bca68a17cf7bc71be8544c6"},repository:{type:"git",url:"https://github.com/Ircam-RnD/serveSofaHrir"},engines:{node:"0.12 || 4",npm:">=1.0.0 <3.0.0"},devDependencies:{"babel-cli":"^6.5.1","babel-eslint":"^4.1.8","babel-preset-es2015":"^6.5.0",babelify:"^7.2.0","blue-tape":"^0.1.11",browserify:"^12.0.2",esdoc:"^0.4.6",eslint:"^1.10.3","eslint-config-airbnb":"^1.0.2","eslint-plugin-html":"^1.4.0",jscs:"2.11.0","jscs-jsdoc":"^1.3.1",tape:"^4.4.0","tape-run":"^2.1.2",testling:"^1.7.1",watch:"^0.17.1"}}},{}],11:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.resampleFloat32Array=f;var a=e("fractional-delay"),t=s(a);function s(h){return h&&h.__esModule?h:{default:h}}function f(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=new Promise(function(v,M){var m=h.inputSamples,d=h.inputSampleRate,y=typeof h.inputDelay<"u"?h.inputDelay:0,b=typeof h.outputSampleRate<"u"?h.outputSampleRate:d;if(d===b&&y===0)v(new Float32Array(m));else try{var E=Math.ceil(m.length*b/d),O=new window.OfflineAudioContext(1,E,b),p=O.createBuffer(1,m.length,d),g=1,F=new t.default(d,g);F.setDelay(y/d),p.getChannelData(0).set(F.process(m));var R=O.createBufferSource();R.buffer=p,R.connect(O.destination),R.start(),O.oncomplete=function(j){var u=j.renderedBuffer.getChannelData(0);v(u)},O.startRendering()}catch(j){M(new Error("Unable to re-sample Float32Array. "+j.message))}});return l}/**
 * @fileOverview Audio utilities
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */i.default={resampleFloat32Array:f}},{"fractional-delay":7}],12:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.tree=void 0,i.distanceSquared=f,i.distance=h;var a=e("kd.tree"),t=s(a);function s(l){return l&&l.__esModule?l:{default:l}}i.tree=t.default;/**
 * @fileOverview Helpers for k-d tree.
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */function f(l,v){var M=v.x-l.x,m=v.y-l.y,d=v.z-l.z;return M*M+m*m+d*d}function h(l,v){return Math.sqrt(this.distanceSquared(l,v))}i.default={distance:h,distanceSquared:f,tree:t.default}},{"kd.tree":9}],13:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.sofaCartesianToGl=f,i.glToSofaCartesian=h,i.sofaCartesianToSofaSpherical=l,i.sofaSphericalToSofaCartesian=v,i.sofaSphericalToGl=M,i.glToSofaSpherical=m,i.sofaToSofaCartesian=d,i.spat4CartesianToGl=y,i.glToSpat4Cartesian=b,i.spat4CartesianToSpat4Spherical=E,i.spat4SphericalToSpat4Cartesian=O,i.spat4SphericalToGl=p,i.glToSpat4Spherical=g,i.systemType=F,i.systemToGl=R,i.glToSystem=j;var a=e("./degree"),t=s(a);function s(u){return u&&u.__esModule?u:{default:u}}function f(u,x){var N=x[0],L=x[1],G=x[2];return u[0]=0-L,u[1]=G,u[2]=0-N,u}/**
 * @fileOverview Coordinate systems conversions. openGL, SOFA, and Spat4 (Ircam).
 *
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */function h(u,x){var N=x[0],L=x[1],G=x[2];return u[0]=0-G,u[1]=0-N,u[2]=L,u}function l(u,x){var N=x[0],L=x[1],G=x[2],$=N*N+L*L;return u[0]=(t.default.atan2(L,N)+360)%360,u[1]=t.default.atan2(G,Math.sqrt($)),u[2]=Math.sqrt($+G*G),u}function v(u,x){var N=x[0],L=x[1],G=x[2],$=t.default.cos(L);return u[0]=G*$*t.default.cos(N),u[1]=G*$*t.default.sin(N),u[2]=G*t.default.sin(L),u}function M(u,x){var N=x[0],L=x[1],G=x[2],$=t.default.cos(L);return u[0]=0-G*$*t.default.sin(N),u[1]=G*t.default.sin(L),u[2]=0-G*$*t.default.cos(N),u}function m(u,x){var N=0-x[2],L=0-x[0],G=x[1],$=N*N+L*L;return u[0]=(t.default.atan2(L,N)+360)%360,u[1]=t.default.atan2(G,Math.sqrt($)),u[2]=Math.sqrt($+G*G),u}function d(u,x,N){switch(N){case"sofaCartesian":u[0]=x[0],u[1]=x[1],u[2]=x[2];break;case"sofaSpherical":v(u,x);break;default:throw new Error("Bad coordinate system")}return u}function y(u,x){var N=x[0],L=x[1],G=x[2];return u[0]=N,u[1]=G,u[2]=0-L,u}function b(u,x){var N=x[0],L=x[1],G=x[2];return u[0]=N,u[1]=0-G,u[2]=L,u}function E(u,x){var N=x[0],L=x[1],G=x[2],$=N*N+L*L;return u[0]=t.default.atan2(N,L),u[1]=t.default.atan2(G,Math.sqrt($)),u[2]=Math.sqrt($+G*G),u}function O(u,x){var N=x[0],L=x[1],G=x[2],$=t.default.cos(L);return u[0]=G*$*t.default.sin(N),u[1]=G*$*t.default.cos(N),u[2]=G*t.default.sin(L),u}function p(u,x){var N=x[0],L=x[1],G=x[2],$=t.default.cos(L);return u[0]=G*$*t.default.sin(N),u[1]=G*t.default.sin(L),u[2]=0-G*$*t.default.cos(N),u}function g(u,x){var N=x[0],L=0-x[2],G=x[1],$=N*N+L*L;return u[0]=t.default.atan2(N,L),u[1]=t.default.atan2(G,Math.sqrt($)),u[2]=Math.sqrt($+G*G),u}function F(u){var x=void 0;if(u==="sofaCartesian"||u==="spat4Cartesian"||u==="gl")x="cartesian";else if(u==="sofaSpherical"||u==="spat4Spherical")x="spherical";else throw new Error("Unknown coordinate system type "+u);return x}function R(u,x,N){switch(N){case"gl":u[0]=x[0],u[1]=x[1],u[2]=x[2];break;case"sofaCartesian":f(u,x);break;case"sofaSpherical":M(u,x);break;case"spat4Cartesian":y(u,x);break;case"spat4Spherical":p(u,x);break;default:throw new Error("Bad coordinate system")}return u}function j(u,x,N){switch(N){case"gl":u[0]=x[0],u[1]=x[1],u[2]=x[2];break;case"sofaCartesian":h(u,x);break;case"sofaSpherical":m(u,x);break;case"spat4Cartesian":b(u,x);break;case"spat4Spherical":g(u,x);break;default:throw new Error("Bad coordinate system")}return u}i.default={glToSofaCartesian:h,glToSofaSpherical:m,glToSpat4Cartesian:b,glToSpat4Spherical:g,glToSystem:j,sofaCartesianToGl:f,sofaCartesianToSofaSpherical:l,sofaSphericalToGl:M,sofaSphericalToSofaCartesian:v,sofaToSofaCartesian:d,spat4CartesianToGl:y,spat4CartesianToSpat4Spherical:E,spat4SphericalToGl:p,spat4SphericalToSpat4Cartesian:O,systemToGl:R,systemType:F}},{"./degree":14}],14:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.toRadian=s,i.fromRadian=f,i.cos=h,i.sin=l,i.atan2=v;/**
 * @fileOverview Convert to and from degree
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */var a=i.toRadianFactor=Math.PI/180,t=i.fromRadianFactor=1/a;function s(M){return M*a}function f(M){return M*t}function h(M){return Math.cos(M*a)}function l(M){return Math.sin(M*a)}function v(M,m){return Math.atan2(M,m)*t}i.default={atan2:v,cos:h,fromRadian:f,fromRadianFactor:t,sin:l,toRadian:s,toRadianFactor:a}},{}],15:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ServerDataBase=i.HrtfSet=void 0;var a=e("./sofa/HrtfSet"),t=h(a),s=e("./sofa/ServerDataBase"),f=h(s);function h(l){return l&&l.__esModule?l:{default:l}}i.HrtfSet=t.default,i.ServerDataBase=f.default,i.default={HrtfSet:t.default,ServerDataBase:f.default}},{"./sofa/HrtfSet":17,"./sofa/ServerDataBase":18}],16:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.version=i.name=i.license=i.description=void 0;var a=e("../package.json"),t=s(a);function s(M){return M&&M.__esModule?M:{default:M}}var f=t.default.description;/**
 * @fileOverview Information on the library, from the `package.json` file.
 *
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */i.description=f;var h=t.default.license;i.license=h;var l=t.default.name;i.name=l;var v=t.default.version;i.version=v,i.default={description:f,license:h,name:l,version:v}},{"../package.json":10}],17:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.HrtfSet=void 0;var a=function(){function R(j,u){for(var x=0;x<u.length;x++){var N=u[x];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(j,N.key,N)}}return function(j,u,x){return u&&R(j.prototype,u),x&&R(j,x),j}}();/**
 * @fileOverview Container for HRTF set: load a set from an URL and get
 * filters from corresponding positions.
 *
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */var t=e("gl-matrix"),s=O(t),f=e("../info"),h=E(f),l=e("./parseDataSet"),v=e("./parseSofa"),M=e("../geometry/coordinates"),m=E(M),d=e("../geometry/KdTree"),y=E(d),b=e("../audio/utilities");function E(R){return R&&R.__esModule?R:{default:R}}function O(R){if(R&&R.__esModule)return R;var j={};if(R!=null)for(var u in R)Object.prototype.hasOwnProperty.call(R,u)&&(j[u]=R[u]);return j.default=R,j}function p(R){if(Array.isArray(R)){for(var j=0,u=Array(R.length);j<R.length;j++)u[j]=R[j];return u}else return Array.from(R)}function g(R,j){if(!(R instanceof j))throw new TypeError("Cannot call a class as a function")}var F=i.HrtfSet=function(){function R(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(this,R),this._audioContext=j.audioContext,this._ready=!1,this.coordinateSystem=j.coordinateSystem,this.filterCoordinateSystem=j.filterCoordinateSystem,this.filterPositions=j.filterPositions,this.filterAfterLoad=j.filterAfterLoad}return a(R,[{key:"applyFilterPositions",value:function(){var u=this,x=this._filterPositions.map(function(N){return u._kdt.nearest({x:N[0],y:N[1],z:N[2]},1).pop()[0]});x=[].concat(p(new Set(x))),this._kdt=y.default.tree.createKdTree(x,y.default.distanceSquared,["x","y","z"])}},{key:"load",value:function(u){var x=this,N=u.split(".").pop(),L=N==="sofa"?u+".json":u,G=void 0,$=typeof this._filterPositions<"u"&&!this.filterAfterLoad&&N==="sofa";return $?G=Promise.all([this._loadMetaAndPositions(u),this._loadDataSet(u)]).then(function(ar){var pr=ar[0],Mr=ar[1];return x._loadSofaPartial(u,pr,Mr).then(function(){return x._ready=!0,x})}).catch(function(){return x._loadSofaFull(L).then(function(){return x.applyFilterPositions(),x._ready=!0,x})}):G=this._loadSofaFull(L).then(function(){return typeof x._filterPositions<"u"&&x.filterAfterLoad&&x.applyFilterPositions(),x._ready=!0,x}),G}},{key:"export",value:function(){var u=this,x=void 0,N=m.default.systemType(this.filterCoordinateSystem);switch(N){case"cartesian":x=this._sofaSourcePosition.map(function(G){return m.default.glToSofaCartesian([],G)});break;case"spherical":x=this._sofaSourcePosition.map(function(G){return m.default.glToSofaSpherical([],G)});break;default:throw new Error("Bad source position type "+N+" for export.")}var L=this._sofaSourcePosition.map(function(G){for(var $=u._kdt.nearest({x:G[0],y:G[1],z:G[2]},1).pop()[0].fir,ar=[],pr=0;pr<$.numberOfChannels;++pr)ar.push([].concat(p($.getChannelData(pr))));return ar});return(0,v.stringifySofa)({name:this._sofaName,metaData:this._sofaMetaData,ListenerPosition:[0,0,0],ListenerPositionType:"cartesian",ListenerUp:[0,0,1],ListenerUpType:"cartesian",ListenerView:[1,0,0],ListenerViewType:"cartesian",SourcePositionType:N,SourcePosition:x,DataSamplingRate:this._audioContext.sampleRate,DataDelay:this._sofaDelay,DataIR:L,RoomVolume:this._sofaRoomVolume})}},{key:"nearest",value:function(u){var x=m.default.systemToGl([],u,this.coordinateSystem),N=this._kdt.nearest({x:x[0],y:x[1],z:x[2]},1).pop(),L=N[0];return m.default.glToSystem(x,[L.x,L.y,L.z],this.coordinateSystem),{distance:N[1],fir:L.fir,index:L.index,position:x}}},{key:"nearestFir",value:function(u){return this.nearest(u).fir}},{key:"_createKdTree",value:function(u){var x=this,N=u.map(function(L){var G=L[2],$=x._audioContext.createBuffer(G.length,G[0].length,x._audioContext.sampleRate);return G.forEach(function(ar,pr){$.getChannelData(pr).set(ar)}),{index:L[0],x:L[1][0],y:L[1][1],z:L[1][2],fir:$}});return this._sofaSourcePosition=N.map(function(L){return[L.x,L.y,L.z]}),this._kdt=y.default.tree.createKdTree(N,y.default.distanceSquared,["x","y","z"]),this}},{key:"_generateIndicesPositionsFirs",value:function(u,x,N,L){var G=this,$=N.map(function(ar,pr){var Mr=ar.length;if(Mr!==2)throw new Error("Bad number of channels"+(" for IR index "+u[pr])+(" ("+Mr+" instead of 2)"));if(L[0].length!==2)throw new Error("Bad delay format"+(" for IR index "+u[pr])+(" (first element in Data.Delay is "+L[0])+" instead of [[delayL, delayR]] )");var wr=typeof L[pr]<"u"?L[pr]:L[0],Y=ar.map(function(D,I){if(wr[I]<0)throw new Error("Negative delay detected (not handled at the moment):"+(" delay index "+u[pr])+(" channel "+I));return(0,b.resampleFloat32Array)({inputSamples:D,inputDelay:wr[I],inputSampleRate:G._sofaSampleRate,outputSampleRate:G._audioContext.sampleRate})});return Promise.all(Y).then(function(D){return[u[pr],x[pr],D]}).catch(function(D){throw new Error("Unable to re-sample impulse response "+pr+". "+D.message)})});return Promise.all($)}},{key:"_loadDataSet",value:function(u){var x=new Promise(function(N,L){var G=u+".dds",$=new window.XMLHttpRequest;$.open("GET",G),$.onerror=function(){L(new Error("Unable to GET "+G+", status "+$.status+" "+(""+$.responseText)))},$.onload=function(){if($.status<200||$.status>=300){$.onerror();return}try{var ar=(0,l.parseDataSet)($.response);N(ar)}catch(pr){L(new Error("Unable to parse "+G+". "+pr.message))}},$.send()});return x}},{key:"_loadMetaAndPositions",value:function(u){var x=this,N=new Promise(function(L,G){var $=u+".json?ListenerPosition,ListenerUp,ListenerView,SourcePosition,Data.Delay,Data.SamplingRate,EmitterPosition,ReceiverPosition,RoomVolume",ar=new window.XMLHttpRequest;ar.open("GET",$),ar.onerror=function(){G(new Error("Unable to GET "+$+", status "+ar.status+" "+(""+ar.responseText)))},ar.onload=function(){if(ar.status<200||ar.status>=300){ar.onerror();return}try{var pr=(0,v.parseSofa)(ar.response);x._setMetaData(pr,u);var Mr=x._sourcePositionsToGl(pr),wr=Mr.map(function(I,tr){return{x:I[0],y:I[1],z:I[2],index:tr}}),Y=y.default.tree.createKdTree(wr,y.default.distanceSquared,["x","y","z"]),D=x._filterPositions.map(function(I){return Y.nearest({x:I[0],y:I[1],z:I[2]},1).pop()[0].index});D=[].concat(p(new Set(D))),x._sofaUrl=u,L(D)}catch(I){G(new Error("Unable to parse "+$+". "+I.message))}},ar.send()});return N}},{key:"_loadSofaFull",value:function(u){var x=this,N=new Promise(function(L,G){var $=new window.XMLHttpRequest;$.open("GET",u),$.onerror=function(){G(new Error("Unable to GET "+u+", status "+$.status+" "+(""+$.responseText)))},$.onload=function(){if($.status<200||$.status>=300){$.onerror();return}try{var ar=(0,v.parseSofa)($.response);x._setMetaData(ar,u);var pr=x._sourcePositionsToGl(ar);x._generateIndicesPositionsFirs(pr.map(function(Mr,wr){return wr}),pr,ar["Data.IR"].data,ar["Data.Delay"].data).then(function(Mr){x._createKdTree(Mr),x._sofaUrl=u,L(x)})}catch(Mr){G(new Error("Unable to parse "+u+". "+Mr.message))}},$.send()});return N}},{key:"_loadSofaPartial",value:function(u,x,N){var L=this,G=x.map(function($){var ar=new Promise(function(pr,Mr){var wr=u+".json?"+("SourcePosition["+$+"][0:1:"+(N.SourcePosition.C-1)+"],")+("Data.IR["+$+"][0:1:"+(N["Data.IR"].R-1)+"]")+("[0:1:"+(N["Data.IR"].N-1)+"]"),Y=new window.XMLHttpRequest;Y.open("GET",wr),Y.onerror=function(){Mr(new Error("Unable to GET "+wr+", status "+Y.status+" "+(""+Y.responseText)))},Y.onload=function(){(Y.status<200||Y.status>=300)&&Y.onerror();try{var D=(0,v.parseSofa)(Y.response),I=L._sourcePositionsToGl(D);L._generateIndicesPositionsFirs([$],I,D["Data.IR"].data,D["Data.Delay"].data).then(function(tr){pr(tr[0])})}catch(tr){Mr(new Error("Unable to parse "+wr+". "+tr.message))}},Y.send()});return ar});return Promise.all(G).then(function($){return L._createKdTree($),L})}},{key:"_setMetaData",value:function(u,x){if(typeof u.metaData.DataType<"u"&&u.metaData.DataType!=="FIR")throw new Error("According to meta-data, SOFA data type is not FIR");var N=new Date().toISOString();this._sofaName=typeof u.name<"u"?""+u.name:"HRTF.sofa",this._sofaMetaData=typeof u.metaData<"u"?u.metaData:{},typeof x<"u"&&(this._sofaMetaData.OriginalUrl=x),this._sofaMetaData.Converter="Ircam "+h.default.name+" "+h.default.version+" javascript API ",this._sofaMetaData.DateConverted=N,this._sofaSampleRate=typeof u["Data.SamplingRate"]<"u"?u["Data.SamplingRate"].data[0]:48e3,this._sofaSampleRate!==this._audioContext.sampleRate&&(this._sofaMetaData.OriginalSampleRate=this._sofaSampleRate),this._sofaDelay=typeof u["Data.Delay"]<"u"?u["Data.Delay"].data:[0,0],this._sofaRoomVolume=typeof u.RoomVolume<"u"?u.RoomVolume.data[0]:void 0;var L=m.default.sofaToSofaCartesian([],u.ListenerPosition.data[0],(0,v.conformSofaCoordinateSystem)(u.ListenerPosition.Type||"cartesian")),G=m.default.sofaToSofaCartesian([],u.ListenerView.data[0],(0,v.conformSofaCoordinateSystem)(u.ListenerView.Type||"cartesian")),$=m.default.sofaToSofaCartesian([],u.ListenerUp.data[0],(0,v.conformSofaCoordinateSystem)(u.ListenerUp.Type||"cartesian"));this._sofaToGl=s.mat4.lookAt([],L,G,$)}},{key:"_sourcePositionsToGl",value:function(u){var x=this,N=u.SourcePosition.data,L=typeof u.SourcePosition.Type<"u"?u.SourcePosition.Type:"spherical";switch(L){case"cartesian":N.forEach(function(G){s.vec3.transformMat4(G,G,x._sofaToGl)});break;case"spherical":N.forEach(function(G){m.default.sofaSphericalToSofaCartesian(G,G),s.vec3.transformMat4(G,G,x._sofaToGl)});break;default:throw new Error("Bad source position type")}return N}},{key:"coordinateSystem",set:function(u){this._coordinateSystem=typeof u<"u"?u:"gl"},get:function(){return this._coordinateSystem}},{key:"filterCoordinateSystem",set:function(u){this._filterCoordinateSystem=typeof u<"u"?u:this.coordinateSystem},get:function(){return this._filterCoordinateSystem}},{key:"filterPositions",set:function(u){if(typeof u>"u")this._filterPositions=void 0;else switch(this.filterCoordinateSystem){case"gl":this._filterPositions=u.map(function(x){return x.slice(0)});break;case"sofaCartesian":this._filterPositions=u.map(function(x){return m.default.sofaCartesianToGl([],x)});break;case"sofaSpherical":this._filterPositions=u.map(function(x){return m.default.sofaSphericalToGl([],x)});break;default:throw new Error("Bad filter coordinate system")}},get:function(){var u=void 0;if(typeof this._filterPositions<"u")switch(this.filterCoordinateSystem){case"gl":u=this._filterPositions.map(function(x){return x.slice(0)});break;case"sofaCartesian":u=this._filterPositions.map(function(x){return m.default.glToSofaCartesian([],x)});break;case"sofaSpherical":u=this._filterPositions.map(function(x){return m.default.glToSofaSpherical([],x)});break;default:throw new Error("Bad filter coordinate system")}return u}},{key:"filterAfterLoad",set:function(u){this._filterAfterLoad=typeof u<"u"?u:!1},get:function(){return this._filterAfterLoad}},{key:"isReady",get:function(){return this._ready}},{key:"sofaName",get:function(){return this._sofaName}},{key:"sofaUrl",get:function(){return this._sofaUrl}},{key:"sofaSampleRate",get:function(){return this._sofaSampleRate}},{key:"sofaMetaData",get:function(){return this._sofaMetaData}}]),R}();i.default=F},{"../audio/utilities":11,"../geometry/KdTree":12,"../geometry/coordinates":13,"../info":16,"./parseDataSet":19,"./parseSofa":20,"gl-matrix":8}],18:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ServerDataBase=void 0;var a=function(){function M(m,d){for(var y=0;y<d.length;y++){var b=d[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,b.key,b)}}return function(m,d,y){return d&&M(m.prototype,d),y&&M(m,y),m}}();/**
 * @fileOverview Access a remote catalogue from a SOFA server, and get URLs
 * with filtering.
 *
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */var t=e("./parseXml"),s=h(t),f=e("./parseDataSet");function h(M){return M&&M.__esModule?M:{default:M}}function l(M,m){if(!(M instanceof m))throw new TypeError("Cannot call a class as a function")}var v=i.ServerDataBase=function(){function M(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(l(this,M),this._server=m.serverUrl,typeof this._server>"u"){var d=window.location.protocol==="https:"?"https:":"http:";this._server=d+"//bili2.ircam.fr"}this._catalogue={},this._urls=[]}return a(M,[{key:"loadCatalogue",value:function(){var d=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._server+"/catalog.xml",b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._catalogue,E=new Promise(function(O,p){var g=new window.XMLHttpRequest;g.open("GET",y),g.onerror=function(){p(new Error("Unable to GET "+y+", status "+g.status+" "+(""+g.responseText)))},g.onload=function(){if(g.status<200||g.status>=300){g.onerror();return}var F=(0,s.default)(g.response),R=F.querySelector("dataset"),j=F.querySelectorAll("dataset > catalogRef");if(j.length===0){b.urls=[];for(var u=F.querySelectorAll("dataset > dataset"),x=0;x<u.length;++x){var N=d._server+R.getAttribute("name")+"/"+u[x].getAttribute("name");d._urls.push(N),b.urls.push(N)}O(y)}else{for(var L=[],G=0;G<j.length;++G){var $=j[G].getAttribute("name"),ar=d._server+R.getAttribute("name")+"/"+j[G].getAttribute("xlink:href");b[$]={},L.push(d.loadCatalogue(ar,b[$]))}Promise.all(L).then(function(){d._urls.sort(),O(y)}).catch(function(pr){p(pr)})}},g.send()});return E}},{key:"getUrls",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=[d.convention,d.dataBase,d.equalisation,d.sampleRate,d.sosOrder],b=typeof d.freePattern=="number"?d.freePattern.toString():d.freePattern,E=y.reduce(function(F,R){return F+"/"+(typeof R<"u"?"[^/]*(?:"+R+")[^/]*":"[^/]*")},""),O=new RegExp(E,"i"),p=this._urls.filter(function(F){return O.test(F)});if(typeof b<"u"){var g=b.split(/\s+/);g.forEach(function(F){O=new RegExp(F,"i"),p=p.filter(function(R){return O.test(R)})})}return p}},{key:"getDataSetDefinitions",value:function(d){var y=new Promise(function(b,E){var O=d+".dds",p=new window.XMLHttpRequest;p.open("GET",O),p.onerror=function(){E(new Error("Unable to GET "+O+", status "+p.status+" "+(""+p.responseText)))},p.onload=function(){if(p.status<200||p.status>=300){p.onerror();return}b((0,f.parseDataSet)(p.response))},p.send()});return y}},{key:"getSourcePositions",value:function(d){var y=new Promise(function(b,E){var O=d+".json?SourcePosition",p=new window.XMLHttpRequest;p.open("GET",O),p.onerror=function(){E(new Error("Unable to GET "+O+", status "+p.status+" "+(""+p.responseText)))},p.onload=function(){if(p.status<200||p.status>=300){p.onerror();return}try{var g=JSON.parse(p.response);if(g.leaves[0].name!=="SourcePosition")throw new Error("SourcePosition not found");b(g.leaves[0].data)}catch(F){E(new Error("Unable to parse response from "+O+". "+F.message))}},p.send()});return y}}]),M}();i.default=v},{"./parseDataSet":19,"./parseXml":21}],19:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i._parseDimension=m,i._parseDefinition=d,i.parseDataSet=y;/**
 * @fileOverview Parser for DDS files
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */var a="\\[\\s*(\\w+)\\s*=\\s*(\\d+)\\s*\\]",t=new RegExp(a,"g"),s=new RegExp(a),f="\\s*(\\w+)\\s*([\\w.]+)\\s*((?:\\[[^\\]]+\\]\\s*)+);\\s*",h=new RegExp(f,"g"),l=new RegExp(f),v="\\s*Dataset\\s*\\{\\s*((?:[^;]+;\\s*)*)\\s*\\}\\s*[\\w.]+\\s*;\\s*",M=new RegExp(v);function m(b){var E=[],O=b.match(t);return O!==null&&O.forEach(function(p){var g=s.exec(p);g!==null&&g.length>2&&E.push([g[1],Number(g[2])])}),E}function d(b){var E=[],O=b.match(h);return O!==null&&O.forEach(function(p){var g=l.exec(p);if(g!==null&&g.length>3){var F=[];F[0]=g[2],F[1]={},F[1].type=g[1],m(g[3]).forEach(function(R){F[1][R[0]]=R[1]}),E.push(F)}}),E}function y(b){var E={},O=M.exec(b);return O!==null&&O.length>1&&d(O[1]).forEach(function(p){E[p[0]]=p[1]}),E}i.default=y},{}],20:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.parseSofa=a,i.stringifySofa=t,i.conformSofaCoordinateSystem=s;/**
 * @fileOverview Parser functions for SOFA files
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015 IRCAM, Paris, France
 * @license BSD-3-Clause
 */function a(f){try{var h=JSON.parse(f),l={};if(l.name=h.name,typeof h.attributes<"u"){l.metaData={};var v=h.attributes.find(function(m){return m.name==="NC_GLOBAL"});typeof v<"u"&&v.attributes.forEach(function(m){l.metaData[m.name]=m.value[0]})}if(typeof h.leaves<"u"){var M=h.leaves;M.forEach(function(m){l[m.name]={},m.attributes.forEach(function(d){l[m.name][d.name]=d.value[0]}),l[m.name].shape=m.shape,l[m.name].data=m.data})}return l}catch(m){throw new Error("Unable to parse SOFA string. "+m.message)}}function t(f){var h={};if(typeof f.name<"u"&&(h.name=f.name),typeof f.metaData<"u"){h.attributes=[];var l={name:"NC_GLOBAL",attributes:[]};for(var v in f.metaData)f.metaData.hasOwnProperty(v)&&l.attributes.push({name:v,value:[f.metaData[v]]});h.attributes.push(l)}var M="Float64",m=void 0;if(h.leaves=[],[["ListenerPosition","ListenerPositionType"],["ListenerUp","ListenerUpType"],["ListenerView","ListenerViewType"]].forEach(function(d){var y=d[0],b=f[y],E=f[d[1]];if(typeof b<"u"){switch(E){case"cartesian":m=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":m=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+(E+" for "+b))}h.leaves.push({name:y,type:M,attributes:m,shape:[1,3],data:[b]})}}),typeof f.SourcePosition<"u"){switch(f.SourcePositionType){case"cartesian":m=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":m=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+(""+f.SourcePositionType))}h.leaves.push({name:"SourcePosition",type:M,attributes:m,shape:[f.SourcePosition.length,f.SourcePosition[0].length],data:f.SourcePosition})}if(typeof f.DataSamplingRate<"u")h.leaves.push({name:"Data.SamplingRate",type:M,attributes:[{name:"Unit",value:"hertz"}],shape:[1],data:[f.DataSamplingRate]});else throw new Error("No data sampling-rate");if(typeof f.DataDelay<"u"&&h.leaves.push({name:"Data.Delay",type:M,attributes:[],shape:[1,f.DataDelay.length],data:f.DataDelay}),typeof f.DataIR<"u")h.leaves.push({name:"Data.IR",type:M,attributes:[],shape:[f.DataIR.length,f.DataIR[0].length,f.DataIR[0][0].length],data:f.DataIR});else throw new Error("No data IR");return typeof f.RoomVolume<"u"&&h.leaves.push({name:"RoomVolume",type:M,attributes:[{name:"Units",value:["cubic metre"]}],shape:[1],data:[f.RoomVolume]}),h.nodes=[],JSON.stringify(h)}function s(f){var h=void 0;switch(f){case"cartesian":h="sofaCartesian";break;case"spherical":h="sofaSpherical";break;default:throw new Error("Bad SOFA type "+f)}return h}i.default={parseSofa:a,conformSofaCoordinateSystem:s}},{}],21:[function(e,r,i){Object.defineProperty(i,"__esModule",{value:!0});/**
 * @fileOverview Simple XML parser, as a DOM parser.
 * @author Jean-Philippe.Lambert@ircam.fr
 * @copyright 2015-2016 IRCAM, Paris, France
 * @license BSD-3-Clause
 */var a=i.parseXml=void 0;if(typeof window.DOMParser<"u")i.parseXml=a=function(s){return new window.DOMParser().parseFromString(s,"text/xml")};else if(typeof window.ActiveXObject<"u"&&new window.ActiveXObject("Microsoft.XMLDOM"))i.parseXml=a=function(s){var f=new window.ActiveXObject("Microsoft.XMLDOM");return f.async="false",f.loadXML(s),f};else throw new Error("No XML parser found");i.default=a},{}]},{},[15])(15)})})(serveSofaHrir);var serveSofaHrirExports=serveSofaHrir.exports;class HRIRloader_ircam{constructor(n,e,r){this.context=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.onLoad=r,this.hrtfSet=new serveSofaHrirExports.HrtfSet({audioContext:this.context,coordinateSystem:"sofaSpherical"}),this.wishedSpeakerPos=getTdesign(2*this.order),this.hrirBuffer=[],this.decodingMatrix=[],this.hoaBuffer=null}load(n){this.hrtfSet.load(n).then(()=>{const e=[];this.hrirBuffer=[];for(let i=0;i<this.wishedSpeakerPos.length;i++)e.push(this.hrtfSet.nearest(this.wishedSpeakerPos[i]).position),this.hrirBuffer.push(this.hrtfSet.nearest(this.wishedSpeakerPos[i]).fir);let r=0;for(let i=0;i<this.wishedSpeakerPos.length;i++)this.wishedSpeakerPos[i][0]<0&&(this.wishedSpeakerPos[i][0]+=360),r+=Math.sqrt(Math.pow(this.wishedSpeakerPos[i][0]-e[i][0],2)+Math.pow(this.wishedSpeakerPos[i][1]-e[i][1],2));console.log("summed / average angular dist between asked and present pos:",Math.round(r*100)/100,"deg /",Math.round(r/this.wishedSpeakerPos.length*100)/100,"deg"),this.decodingMatrix=getAmbisonicDecMtx(e,this.order),this.hoaBuffer=this.getHoaFilterFromHrirFilter(),this.onLoad(this.hoaBuffer)})}getHoaFilterFromHrirFilter(){const n=this.hrirBuffer[0].length,e=this.hrirBuffer[0].sampleRate,r=this.context.createBuffer(this.nCh,n,e);for(let i=0;i<this.nCh;i++){const a=new Float32Array(n);for(let t=0;t<this.hrirBuffer.length;t++)for(let s=0;s<n;s++)a[s]+=this.decodingMatrix[t][i]*this.hrirBuffer[t].getChannelData(0)[s];r.getChannelData(i).set(a)}return r}}class wxyz2acn{constructor(n){this.ctx=n,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(let e=0;e<4;e++)this.gains[e]=this.ctx.createGain(),e===0?this.gains[e].gain.value=Math.SQRT2:this.gains[e].gain.value=Math.sqrt(3),this.gains[e].connect(this.out,0,e);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[3],1,0),this.in.connect(this.gains[1],2,0),this.in.connect(this.gains[2],3,0)}}class acn2wxyz{constructor(n){this.ctx=n,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(let e=0;e<4;e++)this.gains[e]=this.ctx.createGain(),e===0?this.gains[e].gain.value=Math.SQRT1_2:this.gains[e].gain.value=1/Math.sqrt(3),this.gains[e].connect(this.out,0,e);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[2],1,0),this.in.connect(this.gains[3],2,0),this.in.connect(this.gains[1],3,0)}}class sn3d2n3d{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(let r=0;r<this.nCh;r++){const i=Math.floor(Math.sqrt(r));this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=Math.sqrt(2*i+1),this.in.connect(this.gains[r],r,0),this.gains[r].connect(this.out,0,r)}}}class n3d2sn3d{constructor(n,e){this.ctx=n,this.order=e,this.nCh=getAmbisonicChannelCount(e),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(let r=0;r<this.nCh;r++){const i=Math.floor(Math.sqrt(r));this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1/Math.sqrt(2*i+1),this.in.connect(this.gains[r],r,0),this.gains[r].connect(this.out,0,r)}}}class fuma2acn{constructor(n,e){let r=e;r>3&&(console.log("FuMa specifiction is supported up to 3rd order"),r=3);const i=[Math.sqrt(2),Math.sqrt(3),Math.sqrt(3),Math.sqrt(3),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(5),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(35/8),Math.sqrt(35)/3,Math.sqrt(224/45),Math.sqrt(7),Math.sqrt(224/45),Math.sqrt(35)/3,Math.sqrt(35/8)];if(this.ctx=n,this.order=r,this.nCh=getAmbisonicChannelCount(r),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=[],this.remapArray=[],this.remapArray.push(0,2,3,1),r>1){let a=0,t;for(let s=0;s<this.nCh;s++)if(t=[],s>=(a+1)*(a+1)){a+=1;for(let f=(a+1)*(a+1);f<(a+2)*(a+2);f++)(f+a%2)%2===0?t.push(f):t.unshift(f);this.remapArray=this.remapArray.concat(t)}}for(let a=0;a<this.nCh;a++)this.gains[a]=this.ctx.createGain(),this.gains[a].gain.value=i[a],this.in.connect(this.gains[a],this.remapArray[a],0),this.gains[a].connect(this.out,0,a)}}const _converters=Object.freeze(Object.defineProperty({__proto__:null,acn2wxyz,fuma2acn,n3d2sn3d,sn3d2n3d,wxyz2acn},Symbol.toStringTag,{value:"Module"})),converters=_converters,utils=_utils;exports.HOAloader=HOAloader,exports.HRIRloader2D_local=HRIRloader2D_local,exports.HRIRloader_ircam=HRIRloader_ircam,exports.HRIRloader_local=HRIRloader_local,exports.binDecoder=binDecoder,exports.binDecoder2D=binDecoder2D,exports.computeEncodingCoefficients=computeEncodingCoefficients,exports.computeEncodingCoefficients2D=computeEncodingCoefficients2D,exports.converters=converters,exports.convolver=convolver,exports.decoder=decoder,exports.degreesToRadians=degreesToRadians,exports.encodeAndSumBuffers=encodeAndSumBuffers,exports.encodeBuffer=encodeBuffer,exports.encodeBuffer2D=encodeBuffer2D,exports.encodeBuffer2DFromDirection=encodeBuffer2DFromDirection,exports.encodeBufferFromDirection=encodeBufferFromDirection,exports.getAmbisonicChannelCount=getAmbisonicChannelCount,exports.getAmbisonicChannelCount2D=getAmbisonicChannelCount2D,exports.intensityAnalyser=intensityAnalyser,exports.intensityAnalyser2D=intensityAnalyser2D,exports.monoEncoder=monoEncoder,exports.monoEncoder2D=monoEncoder2D,exports.orderLimiter=orderLimiter,exports.orderLimiter2D=orderLimiter2D,exports.orderWeight=orderWeight,exports.powermapAnalyser=powermapAnalyser,exports.radiansToDegrees=radiansToDegrees,exports.rmsAnalyser=rmsAnalyser,exports.sceneMirror=sceneMirror,exports.sceneMirror2D=sceneMirror2D,exports.sceneRotator=sceneRotator,exports.sceneRotator2D=sceneRotator2D,exports.utils=utils,exports.virtualMic=virtualMic,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=ambisonics.umd.min.js.map
